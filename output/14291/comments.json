[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423696829",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-423696829",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 423696829,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzY5NjgyOQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-21T23:33:54Z",
    "updated_at": "2018-09-22T00:04:53Z",
    "author_association": "MEMBER",
    "body": "After https://github.com/bitcoin/bitcoin/pull/11485#issuecomment-423683042 decided to push this.\r\n\r\nConsider the following:\r\n```\r\n$ find wallets\r\nwallets\r\nwallets/wallet.dat\r\nwallets/db.log\r\nwallets/x1\r\nwallets/x1/wallet.dat\r\nwallets/x1/db.log\r\nwallets/x1/.walletlock\r\nwallets/x2\r\nwallets/x2/wallet.dat\r\nwallets/x2/db.log\r\nwallets/x2/.walletlock\r\nwallets/.walletlock\r\nwallets/w\r\nwallets/w/x3\r\nwallets/w/x3/wallet.dat\r\nwallets/w/x3/db.log\r\nwallets/w/x3/.walletlock\r\n```\r\n`ListWalletDir()` gives\r\n```\r\nwallet.dat\r\nx1\r\nx2\r\nw/x3\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423696829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423714517",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-423714517",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 423714517,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzcxNDUxNw==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-22T03:59:02Z",
    "updated_at": "2018-10-10T01:05:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->Reviewers, this pull request conflicts with the following ones:\n\n* #13100 (gui: Add dynamic wallets support by promag)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423714517/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423743185",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-423743185",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 423743185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMzc0MzE4NQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-22T13:11:48Z",
    "updated_at": "2018-09-22T13:11:48Z",
    "author_association": "MEMBER",
    "body": "Thanks @ryanofsky, will update accordingly.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/423743185/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424061725",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-424061725",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 424061725,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNDA2MTcyNQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-24T17:41:27Z",
    "updated_at": "2018-09-24T17:41:27Z",
    "author_association": "MEMBER",
    "body": "@ryanofsky updated to used your suggested code with some minor details fixed. The result is still relative paths to `-walletdir`.\r\n\r\n@practicalswift will add test.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424061725/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424898567",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-424898567",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 424898567,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNDg5ODU2Nw==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-26T23:06:33Z",
    "updated_at": "2018-09-26T23:06:33Z",
    "author_association": "MEMBER",
    "body": "Squashed and added release notes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/424898567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425233400",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425233400",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425233400,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTIzMzQwMA==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-27T20:35:11Z",
    "updated_at": "2018-09-27T20:35:11Z",
    "author_association": "MEMBER",
    "body": "> the test node could dynamically create a wallet, and then try to find it. That way at least some developer will see that test fail on their machine if they compile with a future BDB version that's somehow different.\r\n\r\n@Sjors does the test change looks good to you?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425233400/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425328769",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425328769",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425328769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTMyODc2OQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-28T05:52:31Z",
    "updated_at": "2018-09-28T05:52:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--32850dd3fdea838b4049e64f46995ea2-->\n| Coverage  | Change ([pull 14291](https://drahtbot.github.io/reports/coverage/bitcoin/bitcoin/14291/total.coverage/index.html)) | Reference ([master](https://drahtbot.github.io/reports/coverage/bitcoin/bitcoin/master/total.coverage/index.html))   |\n|-----------|-------------------------|--------------------|\n| Lines     | -0.0043 %            | 87.0361 %        |\n| Functions | -0.0186 %            | 84.1130 %        |\n| Branches  | -0.0052 %            | 51.5451 %        |\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425328769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425399728",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425399728",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425399728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTM5OTcyOA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-28T10:55:20Z",
    "updated_at": "2018-09-28T10:55:20Z",
    "author_association": "MEMBER",
    "body": "@promag it covers the second part of my suggestion yes:  the wallets are generated by the test framework (using whatever version of BDB is on the dev machine), and then listed.\r\n\r\n> Can you add BDB4 and BDB5 wallet payloads to the test suite?\r\n\r\nThis isn't explicitly tested, but because some/most Travis machines use bdb4, it's covered regardless. We're not officially supporting BDB>4 wallets, so that's not important.\r\n\r\ntACK fc40216e1b0a3e0462b4119f6e4380ac368ed828 for macOS, modulo `wallet.dat` being shown as `\"\"` (though that can be fixed later).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425399728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425405356",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425405356",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425405356,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTQwNTM1Ng==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-28T11:22:20Z",
    "updated_at": "2018-09-28T11:22:20Z",
    "author_association": "MEMBER",
    "body": "> modulo wallet.dat being shown as \"\" (though that can be fixed later).\r\n\r\nThat's the name of the default wallet, so it doesn't needs fix. Try:\r\n```\r\nbitcoind -regtest &\r\nbitcoin-cli -regtest unloadwallet \"\"\r\n```\r\n\r\n> tACK fc40216 for macOS\r\n\r\nThanks @Sjors \ud83d\udc4d ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425405356/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425413546",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425413546",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425413546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTQxMzU0Ng==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-28T12:01:21Z",
    "updated_at": "2018-09-28T12:01:21Z",
    "author_association": "MEMBER",
    "body": "@promag that's weird, but unrelated to this change. When you do `listwallets` it shows up as `wallet.dat`. And can you load it with `loadwallet \"\"`?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425413546/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425415570",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425415570",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425415570,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTQxNTU3MA==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-28T12:10:15Z",
    "updated_at": "2018-09-28T12:10:15Z",
    "author_association": "MEMBER",
    "body": "@Sjors here I have:\r\n```\r\nbitcoind -regtest\r\nbitcoin-cli -regtest  listwallets\r\n[\r\n  \"\"\r\n]\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425415570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425421371",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-425421371",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 425421371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNTQyMTM3MQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-28T12:34:43Z",
    "updated_at": "2018-09-28T12:34:43Z",
    "author_association": "MEMBER",
    "body": "Try adding a second wallet to `bitcoin.conf`, then it shows up as `\"wallet.dat\"`. But in that case you can unload with `unloadwallet \"wallet.dat\"`. In case you don't have wallets in `bitcoin.conf`, there's never a need to load `wallet.dat`, so then it doesn't matter that it's called `\"\"`.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/425421371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427693823",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-427693823",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 427693823,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzY5MzgyMw==",
    "user": {
      "login": "etscrivner",
      "id": 69561,
      "node_id": "MDQ6VXNlcjY5NTYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/69561?u=142b51df1df3f92f6dab0b3058bb496dfb23e9f8&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/etscrivner",
      "html_url": "https://github.com/etscrivner",
      "followers_url": "https://api.github.com/users/etscrivner/followers",
      "following_url": "https://api.github.com/users/etscrivner/following{/other_user}",
      "gists_url": "https://api.github.com/users/etscrivner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/etscrivner/subscriptions",
      "organizations_url": "https://api.github.com/users/etscrivner/orgs",
      "repos_url": "https://api.github.com/users/etscrivner/repos",
      "events_url": "https://api.github.com/users/etscrivner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/etscrivner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-07T22:48:03Z",
    "updated_at": "2018-10-07T22:48:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "ACK fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/427693823/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/428025595",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-428025595",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 428025595,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyODAyNTU5NQ==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-09T01:02:15Z",
    "updated_at": "2018-10-09T01:02:15Z",
    "author_association": "MEMBER",
    "body": "utACK fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/428025595/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430823215",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-430823215",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 430823215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDgyMzIxNQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-17T23:24:11Z",
    "updated_at": "2018-10-17T23:24:11Z",
    "author_association": "MEMBER",
    "body": "Thanks, rebased to remove fixup.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430823215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430927131",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-430927131",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 430927131,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDkyNzEzMQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T08:46:19Z",
    "updated_at": "2018-10-18T08:46:19Z",
    "author_association": "MEMBER",
    "body": "utACK after nits ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430927131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431106014",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431106014",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 431106014,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTEwNjAxNA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T18:02:34Z",
    "updated_at": "2018-10-18T18:02:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK b791ef12c3605c185432e391e1571853b07a7441. Changes since last review were adding minimum file size check, switching to fs::ifstream, and no longer omitting big-endian btree files. It seems that berkeley supports loading databases with any byte order, with native byte order just being slightly more efficient: https://docs.oracle.com/cd/E17276_01/html/programmer_reference/general_am_conf.html#am_conf_byteorder",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431106014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431183954",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431183954",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 431183954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTE4Mzk1NA==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T22:21:43Z",
    "updated_at": "2018-10-18T22:21:43Z",
    "author_association": "MEMBER",
    "body": "re-utACK after squash",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431183954/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431187542",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431187542",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 431187542,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTE4NzU0Mg==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-18T22:38:42Z",
    "updated_at": "2018-10-18T22:39:14Z",
    "author_association": "MEMBER",
    "body": "utACK https://github.com/bitcoin/bitcoin/commit/d56a0689354fb814510c6c393f3e07ac9362dc1f\r\n\r\nLet's merge \ud83c\udf89",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431187542/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431733291",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#issuecomment-431733291",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14291",
    "id": 431733291,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTczMzI5MQ==",
    "user": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?u=8aa4d0fd79dff5cf64a98205c78bc1c96b0bf4b6&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-22T03:22:13Z",
    "updated_at": "2018-10-22T03:22:13Z",
    "author_association": "MEMBER",
    "body": "On Debian Jessie PowerPC (Big endian) system (endianness probably unrelated):\r\n```\r\nwallet/walletutil.cpp: In function \u2018std::vector<boost::filesystem::path> ListWalletDir()\u2019:\r\nwallet/walletutil.cpp:57:78: error: \u2018end\u2019 was not declared in this scope\r\n     for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\r\n                                                                              ^\r\nwallet/walletutil.cpp:57:78: note: suggested alternative:\r\nIn file included from /usr/include/c++/4.9/bits/basic_string.h:42:0,\r\n                 from /usr/include/c++/4.9/string:52,\r\n                 from ./fs.h:9,\r\n                 from ./wallet/walletutil.h:8,\r\n                 from wallet/walletutil.cpp:5:\r\n/usr/include/c++/4.9/initializer_list:99:5: note:   \u2018std::end\u2019\r\n     end(initializer_list<_Tp> __ils) noexcept\r\n     ^\r\nwallet/walletutil.cpp:60:32: error: \u2018relative\u2019 is not a member of \u2018fs\u2019\r\n             paths.emplace_back(fs::relative(it->path(), wallet_dir));\r\n                                ^\r\nwallet/walletutil.cpp:71:36: error: \u2018relative\u2019 is not a member of \u2018fs\u2019\r\n                 paths.emplace_back(fs::relative(it->path(), wallet_dir));\r\n                                    ^\r\nMakefile:6919: recipe for target 'wallet/libbitcoin_wallet_a-walletutil.o' failed\r\nmake[2]: *** [wallet/libbitcoin_wallet_a-walletutil.o] Error 1\r\nmake[2]: Leaving directory '/root/workspace/bitcoin/src'\r\nMakefile:10219: recipe for target 'all-recursive' failed\r\nmake[1]: *** [all-recursive] Error 1\r\nmake[1]: Leaving directory '/root/workspace/bitcoin/src'\r\nMakefile:697: recipe for target 'all-recursive' failed\r\nmake: *** [all-recursive] Error 1\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431733291/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219663917",
    "pull_request_review_id": 157901916,
    "id": 219663917,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2MzkxNw==",
    "diff_hunk": "@@ -218,6 +219,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;\n+    }",
    "path": "src/interfaces/node.cpp",
    "position": 24,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "How about moving these functions to `interfaces/wallet.cpp`. I think they don't belong here.",
    "created_at": "2018-09-22T07:18:01Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219663917",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219663917"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219663917"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219663917/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 234,
    "original_line": 234,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219664892",
    "pull_request_review_id": 157902949,
    "id": 219664892,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NDg5Mg==",
    "diff_hunk": "@@ -25,3 +25,32 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const unsigned char bdb_magic[4] = {0x62, 0x31, 0x05, 0x00}; // Berkeley DB Btree magic bytes",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should cite the source of this information (https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75) to give credit upstream and make this code easier to understand / debug / update in the future.",
    "created_at": "2018-09-22T08:05:22Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219664892",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219664892"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219664892"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219664892/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 31,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666816",
    "pull_request_review_id": 157902949,
    "id": 219666816,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NjgxNg==",
    "diff_hunk": "@@ -25,3 +25,32 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const unsigned char bdb_magic[4] = {0x62, 0x31, 0x05, 0x00}; // Berkeley DB Btree magic bytes",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Since this is declared as bytes, the `memcmp` below will only look for little-endian btree files, even on big endian platforms. It seems like it would make more sense to look for little endian files on little-endian platforms, and big endian files on big endian platforms. Changing this to `uint32_t bdb_magic = 0x00053162` and passing `&bdb_magic` to `memcmp` should accomplish this.",
    "created_at": "2018-09-22T09:44:44Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666816",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666816"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666816"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666816/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 31,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666958",
    "pull_request_review_id": 157902949,
    "id": 219666958,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2Njk1OA==",
    "diff_hunk": "@@ -25,3 +25,32 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const unsigned char bdb_magic[4] = {0x62, 0x31, 0x05, 0x00}; // Berkeley DB Btree magic bytes\n+\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+    std::set<fs::path> dbs;\n+\n+    for (auto& entry : fs::recursive_directory_iterator(wallet_dir)) {\n+        const fs::path& path = entry.path();\n+        const fs::path db = fs::is_regular_file(entry) ? path : path / \"wallet.dat\";\n+\n+        std::ifstream file(db.string(), std::ios::binary);\n+        if (!file.is_open()) continue;\n+\n+        file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+        unsigned char file_bytes[4] = {0};\n+        file.read((char*)file_bytes, sizeof(file_bytes)); // Read 4 bytes of file to compare against magic\n+        if (memcmp(file_bytes, bdb_magic, sizeof(bdb_magic)) != 0) continue;\n+\n+        // avoid duplicates due to the recursive iteration\n+        if (!dbs.insert(db).second) continue;\n+\n+        paths.push_back(fs::relative(path, wallet_dir));",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 28,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There are a number of problems with this implementation:\r\n\r\n1) Because this opens files recursively, it will return btree paths not in the top directory which CWallet::Verify will reject: https://github.com/bitcoin/bitcoin/blob/920c090f63f4990bf0f3b3d1a6d3d8a8bcd14ba0/src/wallet/wallet.cpp#L3824-L3829\r\n2) Because is_regular_file will return true for symlinks pointing to files, this will return symlink paths which CWallet::Verify will reject\r\n3) Because recursive_directory_iterator order is unspecified, on systems where it does postorder instead of preorder traversal, this will return `<wallet>/wallet.dat` instead of `<wallet>` paths, which CWallet::Verify will reject.\r\n4) Less serious, but this returns \"wallet.dat\" instead of \"\" as the path for the top level wallet. This is inconsistent with top level wallet path returned in current `listwallets` and `getwalletinfo` rpcs in the default bitcoin configuration.\r\n5) This is less efficient than it needs to be. Instead of only opening files called `wallet.dat` in subdirectories, it will read logs and other random files which bitcoin would never open as wallets. It also reads `wallet.dat` files in subdirectories twice and then uses a `std::set` to filter out the duplicates after they are read, which is unnecessary.\r\n\r\nFollowing alternate implementation is untested, but I think would avoid these problems:\r\n\r\n```c++\r\nstd::vector<fs::path> wallets;\r\nfor (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\r\n    if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\r\n        // Found a directory which contains wallet.dat btree file, add it as a wallet.\r\n        wallets.emplace_back(it->path());\r\n    } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {\r\n        if (it->path() == \"wallet.dat\") {\r\n            // Found top-level wallet.dat btree file, add top level directory \"\"\r\n            // as a wallet.\r\n            wallets.emplace_back();\r\n        } else {\r\n            // Found top-level btree file not called wallet.dat. Current bitcoin\r\n            // software will never create these files but will allow them to be\r\n            // opened in a shared database environment for backwards compatibility.\r\n            // Add it to the list of available wallets.\r\n            wallets.emplace_back(it->path());\r\n        }\r\n    }\r\n}\r\nreturn wallets;\r\n```",
    "created_at": "2018-09-22T09:51:55Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666958",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666958"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219666958"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219666958/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219667374",
    "pull_request_review_id": 157902949,
    "id": 219667374,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY2NzM3NA==",
    "diff_hunk": "@@ -218,6 +219,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;\n+    }",
    "path": "src/interfaces/node.cpp",
    "position": 24,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> How about moving these functions to interfaces/wallet.cpp. I think they don't belong here.\r\n\r\nThis is a reasonable place. These methods fit in with the existing `getWallets` and `handleLoadWallet` methods. The `Node` interface is somewhat monolithic and we could consider breaking it up in various ways. But the `Wallet` interface would be the wrong place to add these methods. `Wallet` methods operate on individual wallets, not collections of wallets. And these methods need to be available before any `Wallet` object is constructed.",
    "created_at": "2018-09-22T10:17:10Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219667374",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219667374"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219667374"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219667374/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 234,
    "original_line": 234,
    "side": "RIGHT",
    "in_reply_to_id": 219663917
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219671843",
    "pull_request_review_id": 157910115,
    "id": 219671843,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTY3MTg0Mw==",
    "diff_hunk": "@@ -11,4 +11,7 @@\n //! Get the path of the wallet directory.\n fs::path GetWalletDir();\n \n+//! Get wallets in wallet directory.\n+std::vector<fs::path> ListWalletDir();\n+",
    "path": "src/wallet/walletutil.h",
    "position": 15,
    "original_position": 6,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nit: Add some trivial test for `ListWalletDir` to make it technically in use.",
    "created_at": "2018-09-22T13:34:04Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219671843",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219671843"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r219671843"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219671843/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 17,
    "original_line": 17,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220147402",
    "pull_request_review_id": 158485225,
    "id": 220147402,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE0NzQwMg==",
    "diff_hunk": "@@ -11,4 +11,7 @@\n //! Get the path of the wallet directory.\n fs::path GetWalletDir();\n \n+//! Get wallets in wallet directory.\n+std::vector<fs::path> ListWalletDir();\n+",
    "path": "src/wallet/walletutil.h",
    "position": 15,
    "original_position": 6,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "e84e729fd0b8abbff53826bb97e01ad32f1c992f",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There is `listwaletdir` RPC, which has some tests.",
    "created_at": "2018-09-25T11:02:19Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220147402",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220147402"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220147402"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220147402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 17,
    "original_line": 17,
    "side": "RIGHT",
    "in_reply_to_id": 219671843
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220161367",
    "pull_request_review_id": 158502639,
    "id": 220161367,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2MTM2Nw==",
    "diff_hunk": "@@ -34,6 +34,16 @@ void DummyWalletInit::AddWalletOptions() const\n \n const WalletInitInterface& g_wallet_init_interface = DummyWalletInit();\n \n+fs::path GetWalletDir()\n+{\n+    throw std::logic_error(\"Wallet function called in non-wallet build.\");",
    "path": "src/dummywallet.cpp",
    "position": 6,
    "original_position": 6,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nit: `throwNotWalletBuild()`?",
    "created_at": "2018-09-25T11:56:15Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220161367",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220161367"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220161367"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220161367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 39,
    "original_line": 39,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220162889",
    "pull_request_review_id": 158502639,
    "id": 220162889,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2Mjg4OQ==",
    "diff_hunk": "@@ -173,6 +173,12 @@ class Node\n     //! Get unspent outputs associated with a transaction.\n     virtual bool getUnspentOutput(const COutPoint& output, Coin& coin) = 0;\n \n+    //! Return default wallet directory.\n+    virtual std::string getWalletDir() = 0;\n+\n+    //! Return available wallets in wallet directory.\n+    virtual std::vector<std::string> listWalletDir() = 0;",
    "path": "src/interfaces/node.h",
    "position": 8,
    "original_position": 8,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I find this function name confusing. How about `listWallets()`? A future version of this function could take a directory argument and the name would still make sense.",
    "created_at": "2018-09-25T12:01:34Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220162889",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220162889"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220162889"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220162889/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 180,
    "original_line": 180,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220165978",
    "pull_request_review_id": 158502639,
    "id": 220165978,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2NTk3OA==",
    "diff_hunk": "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ditto as above, but unfortunately it's too late to rename `listwallets` to `listloadedwallets`. Overloading `listwallets` doesn't seem like a good idea.\r\n\r\nWhat about `lswallets`, `listwalletfiles` or `findwallets`?  ",
    "created_at": "2018-09-25T12:12:13Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220165978",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220165978"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220165978"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220165978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2453,
    "original_line": 2453,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220167677",
    "pull_request_review_id": 158502639,
    "id": 220167677,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE2NzY3Nw==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sort alphabetically?",
    "created_at": "2018-09-25T12:17:28Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220167677",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220167677"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220167677"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220167677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220186712",
    "pull_request_review_id": 158534090,
    "id": 220186712,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE4NjcxMg==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think that's something for the UI to handle. It can sort by other attribute, like last modified, transaction count, balance, etc.",
    "created_at": "2018-09-25T13:15:33Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220186712",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220186712"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220186712"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220186712/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220187294",
    "pull_request_review_id": 158534882,
    "id": 220187294,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE4NzI5NA==",
    "diff_hunk": "@@ -173,6 +173,12 @@ class Node\n     //! Get unspent outputs associated with a transaction.\n     virtual bool getUnspentOutput(const COutPoint& output, Coin& coin) = 0;\n \n+    //! Return default wallet directory.\n+    virtual std::string getWalletDir() = 0;\n+\n+    //! Return available wallets in wallet directory.\n+    virtual std::vector<std::string> listWalletDir() = 0;",
    "path": "src/interfaces/node.h",
    "position": 8,
    "original_position": 8,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I like the pairing between `getWalletDir`, `listWalletDir` and `-walletdir`, but I don't have a strong preference. Let's see what others say.",
    "created_at": "2018-09-25T13:17:12Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220187294",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220187294"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220187294"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220187294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 180,
    "original_line": 180,
    "side": "RIGHT",
    "in_reply_to_id": 220162889
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220189697",
    "pull_request_review_id": 158537918,
    "id": 220189697,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE4OTY5Nw==",
    "diff_hunk": "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Agree in not overloading `listwallets`. There are more alternatives in #11485 discussion thread.",
    "created_at": "2018-09-25T13:23:17Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220189697",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220189697"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220189697"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220189697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2453,
    "original_line": 2453,
    "side": "RIGHT",
    "in_reply_to_id": 220165978
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220193984",
    "pull_request_review_id": 158543537,
    "id": 220193984,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE5Mzk4NA==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That's fine, as long as the RPC interface does it, that's also a User Interface :-)",
    "created_at": "2018-09-25T13:34:31Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220193984",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220193984"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220193984"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220193984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220195529",
    "pull_request_review_id": 158545603,
    "id": 220195529,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDE5NTUyOQ==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should we sort `listwallets` result too? ",
    "created_at": "2018-09-25T13:38:37Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220195529",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220195529"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220195529"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220195529/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220218050",
    "pull_request_review_id": 158574435,
    "id": 220218050,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDIxODA1MA==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That could be a nice improvement. Not necessarily in this PR, but perhaps there could be a common function to render the list of wallets in RPC, to make sure they're consistent.",
    "created_at": "2018-09-25T14:33:17Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220218050",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220218050"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220218050"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220218050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220438850",
    "pull_request_review_id": 158846389,
    "id": 220438850,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQzODg1MA==",
    "diff_hunk": "@@ -25,3 +25,47 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return memcmp(&data, &bdb_magic, sizeof(bdb_magic)) == 0;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        std::cout << it->path().string() << '-' << it.level() << std::endl;",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "90adb2cd6149af1869e624a2060ec8c4a543cf08",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"wallet: Add ListWalletDir utility\" (90adb2cd6149af1869e624a2060ec8c4a543cf08)\r\n\r\nProbably delete this line, it looks leftover from debugging.",
    "created_at": "2018-09-26T06:28:45Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220438850",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220438850"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220438850"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220438850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220441099",
    "pull_request_review_id": 158846389,
    "id": 220441099,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ0MTA5OQ==",
    "diff_hunk": "@@ -173,6 +173,12 @@ class Node\n     //! Get unspent outputs associated with a transaction.\n     virtual bool getUnspentOutput(const COutPoint& output, Coin& coin) = 0;\n \n+    //! Return default wallet directory.\n+    virtual std::string getWalletDir() = 0;\n+\n+    //! Return available wallets in wallet directory.\n+    virtual std::vector<std::string> listWalletDir() = 0;",
    "path": "src/interfaces/node.h",
    "position": 8,
    "original_position": 8,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think I agree with promag. `listWalletDir` describes more specifically what the function does than `listWallets` and it fits in with the other names cited. I don't imagine us adding a gui feature that would call for the gui asking the node to list wallets in a directory other than `-walletdir`, but even if we did and this method gained an optional argument,  `listWalletDir` would still seem like a sensible name.",
    "created_at": "2018-09-26T06:40:46Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220441099",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220441099"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220441099"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220441099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 180,
    "original_line": 180,
    "side": "RIGHT",
    "in_reply_to_id": 220162889
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446254",
    "pull_request_review_id": 158846389,
    "id": 220446254,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ0NjI1NA==",
    "diff_hunk": "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 0) {\n+        throw std::runtime_error(\n+            \"listwalletdir\\n\"\n+            \"Returns a list of wallets in the wallet directory.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[                         (json array of strings)\\n\"\n+            \"  \\\"walletname\\\"            (string) the wallet name\\n\"",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "963eb27e8598e2746966ee4056f177ed332f0279",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"rpc: Add listwalletdir RPC\" (963eb27e8598e2746966ee4056f177ed332f0279)\r\n\r\nI would consider avoiding a mistake we've made previously with other api's (listwallets, listaccounts) where we limited extensibility by returning lists of strings instead of list of json objects. Specifically, I think it'd be better to return\r\n\r\n```json\r\n[ {\"wallet\": \"\"}, {\"wallet\": \"foo\"}, {\"wallet\": \"bar\"} ]\r\n```\r\n\r\ninstead of:\r\n\r\n```json\r\n[ \"\", \"foo\", \"bar\" ]\r\n```\r\n\r\nBecause there's more metadata we could be returning about these wallets even without opening them, such as last modified times from the filesystem, status strings indicating whether wallets are presently loaded and locked, and path types indicating whether wallet paths refer to directories, symlinks, or legacy btree files.",
    "created_at": "2018-09-26T07:05:59Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446254",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446254"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446254"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2461,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446805",
    "pull_request_review_id": 158846389,
    "id": 220446805,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ0NjgwNQ==",
    "diff_hunk": "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't see a problem with `listwalletdir`. It describes the thing this RPC does, which is to list the contents of the `-walletdir` directory. (I do think it would have been clearer if that directory would have been called `-walletsdir` instead of `-walletdir`, but surprising to me as a native english speaker, other people seemed to think `-walletsdir` was clumsy and not grammatical in #12221).",
    "created_at": "2018-09-26T07:08:28Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446805",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446805"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220446805"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220446805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2453,
    "original_line": 2453,
    "side": "RIGHT",
    "in_reply_to_id": 220165978
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220453514",
    "pull_request_review_id": 158864119,
    "id": 220453514,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ1MzUxNA==",
    "diff_hunk": "@@ -25,3 +25,47 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return memcmp(&data, &bdb_magic, sizeof(bdb_magic)) == 0;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        std::cout << it->path().string() << '-' << it.level() << std::endl;",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "90adb2cd6149af1869e624a2060ec8c4a543cf08",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ops",
    "created_at": "2018-09-26T07:35:00Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220453514",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220453514"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220453514"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220453514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT",
    "in_reply_to_id": 220438850
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220471896",
    "pull_request_review_id": 158885891,
    "id": 220471896,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDQ3MTg5Ng==",
    "diff_hunk": "@@ -2450,6 +2450,32 @@ static UniValue getwalletinfo(const JSONRPCRequest& request)\n     return obj;\n }\n \n+static UniValue listwalletdir(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() != 0) {\n+        throw std::runtime_error(\n+            \"listwalletdir\\n\"\n+            \"Returns a list of wallets in the wallet directory.\\n\"\n+            \"\\nResult:\\n\"\n+            \"[                         (json array of strings)\\n\"\n+            \"  \\\"walletname\\\"            (string) the wallet name\\n\"",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "963eb27e8598e2746966ee4056f177ed332f0279",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Absolutely, my initial response was like:\r\n```json\r\n{\r\n    \"wallets\": [\r\n        { \"name\": \"\" }\r\n    ]\r\n}\r\n```\r\nwhich permits adding, for instance, `walletdir`, `count`, `offset`..",
    "created_at": "2018-09-26T08:36:49Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220471896",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220471896"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220471896"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220471896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2461,
    "side": "RIGHT",
    "in_reply_to_id": 220446254
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220522510",
    "pull_request_review_id": 158946677,
    "id": 220522510,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDUyMjUxMA==",
    "diff_hunk": "@@ -39,7 +39,7 @@ static bool IsBerkeleyBtree(const fs::path& path)\n     uint32_t data = 0;\n     file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n \n-    return memcmp(&data, &bdb_magic, sizeof(bdb_magic)) == 0;",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "5e3a14d42726f4a526b6e69bc2d12c561afe7e34",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@ryanofsky does this looks good to you?",
    "created_at": "2018-09-26T11:22:04Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220522510",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220522510"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220522510"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220522510/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 42,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220528757",
    "pull_request_review_id": 158955119,
    "id": 220528757,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDUyODc1Nw==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should it ignore case? Should have an option to support numeric/date prefixes?\r\n\r\nFrom the cli point of view, you can do stuff like `bitcoin-cli -regtest listwalletdir | jq -r '.wallets | map(.name) | join(\"\\n\")' | sort ...`.",
    "created_at": "2018-09-26T11:49:19Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220528757",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220528757"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220528757"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220528757/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220543207",
    "pull_request_review_id": 158973449,
    "id": 220543207,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDU0MzIwNw==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Don't most alphabetical sort functions ignore case (unless it's a tie) and put numbers before letters? I'm a fan of `jq`, but seems overkill for a simple list. It doesn't seem terribly complicated in C++11 even with [UTF-8](https://www.quora.com/How-do-I-sort-an-array-of-strings-in-alphabetical-order-in-C) (1st answer, 3rd example):\r\n\r\n```cpp\r\nstd::wstring a[] = {L\"\u0428\u043b\u0430\", L\"\u0421\u0430\u0448\u0430\", L\"\u043f\u043e\", L\"\u0448\u043e\u0441\u0441\u0435\", L\"\u0438\", L\"\u0441\u043e\u0441\u0430\u043b\u0430\", L\"\u0441\u0443\u0448\u043a\u0443\"};\r\nstd::sort(std::begin(a), std::end(a), std::locale(\"en_US.utf8\"));\r\nstd::wstring_convert<std::codecvt_utf8<wchar_t>> cvt;\r\nfor(auto& s: a) std::cout << cvt.to_bytes(s) << ' ';\r\n```",
    "created_at": "2018-09-26T12:39:51Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220543207",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220543207"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220543207"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220543207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220749366",
    "pull_request_review_id": 159230702,
    "id": 220749366,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMDc0OTM2Ng==",
    "diff_hunk": "@@ -218,6 +220,18 @@ class NodeImpl : public Node\n         LOCK(::cs_main);\n         return ::pcoinsTip->GetCoin(output, coin);\n     }\n+    std::string getWalletDir() override\n+    {\n+        return GetWalletDir().string();\n+    }\n+    std::vector<std::string> listWalletDir() override\n+    {\n+        std::vector<std::string> paths;\n+        for (auto& path : ListWalletDir()) {\n+            paths.push_back(path.string());\n+        }\n+        return paths;",
    "path": "src/interfaces/node.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "20db275b250189cfd2200df8e5535aa92afa594a",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If you don't mind I prefer to follow up that discussion and possible implementation in both RPC. In this PR I'm just following `listwallets` ordering and for now having the functionality is enough.",
    "created_at": "2018-09-26T23:02:17Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220749366",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220749366"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r220749366"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/220749366/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 233,
    "original_line": 233,
    "side": "RIGHT",
    "in_reply_to_id": 220167677
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223220733",
    "pull_request_review_id": 162297341,
    "id": 223220733,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyMzIyMDczMw==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic",
    "path": "src/wallet/walletutil.cpp",
    "position": 26,
    "original_position": 16,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "c3acd2b69069e4718f26d34241c8ea10b3cd96ea",
    "user": {
      "login": "etscrivner",
      "id": 69561,
      "node_id": "MDQ6VXNlcjY5NTYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/69561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/etscrivner",
      "html_url": "https://github.com/etscrivner",
      "followers_url": "https://api.github.com/users/etscrivner/followers",
      "following_url": "https://api.github.com/users/etscrivner/following{/other_user}",
      "gists_url": "https://api.github.com/users/etscrivner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/etscrivner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/etscrivner/subscriptions",
      "organizations_url": "https://api.github.com/users/etscrivner/orgs",
      "repos_url": "https://api.github.com/users/etscrivner/repos",
      "events_url": "https://api.github.com/users/etscrivner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/etscrivner/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Any concerns about the endianness of `data` as compared to `bdb_magic` here?",
    "created_at": "2018-10-07T17:06:50Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r223220733",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223220733"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r223220733"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/223220733/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 43,
    "original_line": 43,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225486459",
    "pull_request_review_id": 165093120,
    "id": 225486459,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTQ4NjQ1OQ==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "so if i get this right: in the legacy case where walletdir == datadir, this will scan **every** file in the data directory recursively, and check it for BDB version magic?\r\nthis includes LevelDB database files, block files, debug log files, authcookie files, lock files \u2026 can see tons of ways in which this can go wrong\r\nor this is somehow avoided?\r\n\r\nif not, I'd strongly suggest it should just fail in that case\u2014if the user wants to list non-default wallets, let them create a wallets directory",
    "created_at": "2018-10-16T10:38:08Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225486459",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225486459"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225486459"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225486459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225491304",
    "pull_request_review_id": 165099174,
    "id": 225491304,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTQ5MTMwNA==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No, it only recursively scans directories to try to open `wallet.dat` inside and then check magic bytes.\r\n\r\nIt checks magic bytes on all files in the walletdir (datadir in the legacy case) \u2014 not recursively.",
    "created_at": "2018-10-16T10:55:42Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225491304",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225491304"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225491304"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225491304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 225486459
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225531394",
    "pull_request_review_id": 165148976,
    "id": 225531394,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTUzMTM5NA==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic",
    "path": "src/wallet/walletutil.cpp",
    "position": 26,
    "original_position": 16,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "c3acd2b69069e4718f26d34241c8ea10b3cd96ea",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> Any concerns about the endianness of data as compared to bdb_magic here?\r\n\r\nCould add a comment here, but this checks for databases in the native format. On big endian systems, the magic bytes are `00 05 31 62`, and on little endian systems they are `62 31 05 00`.",
    "created_at": "2018-10-16T13:10:10Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225531394",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225531394"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225531394"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225531394/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 43,
    "original_line": 43,
    "side": "RIGHT",
    "in_reply_to_id": 223220733
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225534223",
    "pull_request_review_id": 165148976,
    "id": 225534223,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTUzNDIyMw==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It still might be good to prevent this from opening too many files if there happen to be a lot of stray files in the root directory, or a lot of directories in the tree. Maybe add `&& (++count)` before `&& IsBerkeleyBtree` checks, and `if (count > 1000) throw std::runtime_error(\"Can't list wallets, too many files in walletdir\")` and the end of the loop as a sanity check.",
    "created_at": "2018-10-16T13:17:13Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225534223",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225534223"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225534223"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225534223/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 225486459
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225544502",
    "pull_request_review_id": 165165458,
    "id": 225544502,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTU0NDUwMg==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@ryanofsky an alternative solution is to scan only if walletdir != datadir, WDYT?",
    "created_at": "2018-10-16T13:42:40Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225544502",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225544502"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225544502"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225544502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 225486459
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225613639",
    "pull_request_review_id": 165252150,
    "id": 225613639,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYxMzYzOQ==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> @ryanofsky an alternative solution is to scan only if walletdir != datadir, WDYT?\r\n\r\nThat seems like a worse solution. It doesn't provide protection if there's a looping directory structure or a lot of junk files in the wallet directory. It's less user friendly if users with old datadirs have to manually move database files around in order for this one rpc method to work. It also seems like it would be more complicated to test and explain.\r\n\r\nI think my suggestion is better because it would _just work_ in the all the normal cases, and provide a straightforward error message in the unusual case laanwj is concerned about.",
    "created_at": "2018-10-16T16:24:39Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225613639",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225613639"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225613639"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225613639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 225486459
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225624325",
    "pull_request_review_id": 165265151,
    "id": 225624325,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYyNDMyNQ==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> It doesn't provide protection if there's a looping directory structure\r\n\r\nFrom the [docs](https://www.boost.org/doc/libs/1_67_0/libs/filesystem/doc/reference.html#Class-recursive_directory_iterator):\r\n> By default, recursive_directory_iterator does not follow directory symlinks\r\n\r\nIIUC considering the above looping would't happen.\r\n\r\n",
    "created_at": "2018-10-16T16:55:28Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225624325",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225624325"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225624325"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225624325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 225486459
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225629987",
    "pull_request_review_id": 165271682,
    "id": 225629987,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYyOTk4Nw==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    return data == bdb_magic;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {",
    "path": "src/wallet/walletutil.cpp",
    "position": 44,
    "original_position": 30,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "fc40216e1b0a3e0462b4119f6e4380ac368ed828",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> By default, recursive_directory_iterator does not follow directory symlinks\r\n\r\nI know, I was thinking about more about FUSE mounts and such. Anyway, if you think it complicates code too much to deal with unexpected filesystem stuff and provide a nice error message, I don't personally think you need to add any error handling here. I was just trying to suggest a way to deal with laanwj's concern.\r\n\r\nBut since you asked WDYT, I think special casing datadir=walletdir is a bad user experience and confusing and ugly and hard to explain.",
    "created_at": "2018-10-16T17:11:32Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225629987",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225629987"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225629987"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225629987/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 225486459
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225632683",
    "pull_request_review_id": 165273667,
    "id": 225632683,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTYzMjY4Mw==",
    "diff_hunk": "@@ -25,3 +25,50 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    if (!fs::exists(path)) return false;\n+    if (fs::file_size(path) < 1024) return false;",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "47a229e920187dd90af7bba52cc0bfe4baab735c",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@ryanofsky @laanwj added these 2 checks to avoid opening unnecessary files.",
    "created_at": "2018-10-16T17:16:21Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225632683",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225632683"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225632683"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225632683/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 36,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225646785",
    "pull_request_review_id": 165291511,
    "id": 225646785,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY0Njc4NQ==",
    "diff_hunk": "@@ -25,3 +25,50 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    if (!fs::exists(path)) return false;\n+    if (fs::file_size(path) < 1024) return false;",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "47a229e920187dd90af7bba52cc0bfe4baab735c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not sure what purpose these checks serve. Are they supposed to be an optimization? Is the second check supposed to guard against opening lock files? I would suggest adding a comment here or dropping these. \r\n\r\nThe first check actually seems like the opposite of an optimization, since file_size/ifstream calls below inherently have to check that the file exists, so it seems like this just checks the same condition twice.",
    "created_at": "2018-10-16T17:57:51Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225646785",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225646785"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225646785"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225646785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 36,
    "side": "RIGHT",
    "in_reply_to_id": 225632683
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225653862",
    "pull_request_review_id": 165300757,
    "id": 225653862,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTY1Mzg2Mg==",
    "diff_hunk": "@@ -25,3 +25,50 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    if (!fs::exists(path)) return false;\n+    if (fs::file_size(path) < 1024) return false;",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "47a229e920187dd90af7bba52cc0bfe4baab735c",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The first check `fs::exists(path)` was there to prevent exceptions from the 2nd check `fs::file_size(path)`. Fixed and added comment.",
    "created_at": "2018-10-16T18:19:27Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225653862",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225653862"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r225653862"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225653862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 36,
    "side": "RIGHT",
    "in_reply_to_id": 225632683
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226188328",
    "pull_request_review_id": 165948727,
    "id": 226188328,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjE4ODMyOA==",
    "diff_hunk": "@@ -25,3 +25,46 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    std::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic",
    "path": "src/wallet/walletutil.cpp",
    "position": 26,
    "original_position": 16,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "c3acd2b69069e4718f26d34241c8ea10b3cd96ea",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "agree with regard to adding comment; at least I too had no idea that BerkeleyDB files generated on big-endian systems are incompatible!\r\n\r\nedit: another theory on IRC is that BerkeleyDB creates the file in native endian but accepts both (does byteswaps if needed)! if this is true, you need to check for both orderings here\r\n\r\nhere's Oracle's magic file for id'ing BDB files; https://docs.oracle.com/cd/E17275_01/html/programmer_reference/magic.txt\r\ntl;dr; check *both* ways around\r\n",
    "created_at": "2018-10-18T07:04:26Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226188328",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226188328"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226188328"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226188328/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 43,
    "original_line": 43,
    "side": "RIGHT",
    "in_reply_to_id": 223220733
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226215537",
    "pull_request_review_id": 165981169,
    "id": 226215537,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjIxNTUzNw==",
    "diff_hunk": "@@ -25,3 +25,52 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    const uint32_t bdb_magic = 0x00053162;\n+\n+    // A Berkeley DB Btree file has at least 4K.\n+    // This check also prevents opening lock files.\n+    boost::system::error_code ec;\n+    if (fs::file_size(path, ec) < 4096) return false;\n+\n+    std::ifstream file(path.string(), std::ios::binary);",
    "path": "src/wallet/walletutil.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "f27a767846997540cb459fc06a38348ded2cfbf2",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "switch to `fs::ifstream` post-#13878",
    "created_at": "2018-10-18T08:38:18Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226215537",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226215537"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226215537"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226215537/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 40,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226315105",
    "pull_request_review_id": 166106719,
    "id": 226315105,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjMxNTEwNQ==",
    "diff_hunk": "@@ -25,3 +27,51 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // A Berkeley DB Btree file has at least 4K.\n+    // This check also prevents opening lock files.\n+    boost::system::error_code ec;\n+    if (fs::file_size(path, ec) < 4096) return false;\n+\n+    fs::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    //  - big endian systems - 00 05 31 62\n+    //  - little endian systems - 62 31 05 00\n+    return data == 0x00053162 || data == 0x62310500;",
    "path": "src/wallet/walletutil.cpp",
    "position": 32,
    "original_position": 32,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "b791ef12c3605c185432e391e1571853b07a7441",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "LGTM now",
    "created_at": "2018-10-18T13:57:31Z",
    "updated_at": "2018-10-18T22:26:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226315105",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226315105"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226315105"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226315105/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 49,
    "original_line": 49,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226823679",
    "pull_request_review_id": 166746134,
    "id": 226823679,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjgyMzY3OQ==",
    "diff_hunk": "@@ -25,3 +27,51 @@ fs::path GetWalletDir()\n \n     return path;\n }\n+\n+static bool IsBerkeleyBtree(const fs::path& path)\n+{\n+    // A Berkeley DB Btree file has at least 4K.\n+    // This check also prevents opening lock files.\n+    boost::system::error_code ec;\n+    if (fs::file_size(path, ec) < 4096) return false;\n+\n+    fs::ifstream file(path.string(), std::ios::binary);\n+    if (!file.is_open()) return false;\n+\n+    file.seekg(12, std::ios::beg); // Magic bytes start at offset 12\n+    uint32_t data = 0;\n+    file.read((char*) &data, sizeof(data)); // Read 4 bytes of file to compare against magic\n+\n+    // Berkeley DB Btree magic bytes, from:\n+    //  https://github.com/file/file/blob/5824af38469ec1ca9ac3ffd251e7afe9dc11e227/magic/Magdir/database#L74-L75\n+    //  - big endian systems - 00 05 31 62\n+    //  - little endian systems - 62 31 05 00\n+    return data == 0x00053162 || data == 0x62310500;\n+}\n+\n+std::vector<fs::path> ListWalletDir()\n+{\n+    const fs::path wallet_dir = GetWalletDir();\n+    std::vector<fs::path> paths;\n+\n+    for (auto it = fs::recursive_directory_iterator(wallet_dir); it != end(it); ++it) {\n+        if (it->status().type() == fs::directory_file && IsBerkeleyBtree(it->path() / \"wallet.dat\")) {\n+            // Found a directory which contains wallet.dat btree file, add it as a wallet.\n+            paths.emplace_back(fs::relative(it->path(), wallet_dir));\n+        } else if (it.level() == 0 && it->symlink_status().type() == fs::regular_file && IsBerkeleyBtree(it->path())) {\n+            if (it->path().filename() == \"wallet.dat\") {\n+                // Found top-level wallet.dat btree file, add top level directory \"\"\n+                // as a wallet.\n+                paths.emplace_back();\n+            } else {\n+                // Found top-level btree file not called wallet.dat. Current bitcoin\n+                // software will never create these files but will allow them to be\n+                // opened in a shared database environment for backwards compatibility.\n+                // Add it to the list of available wallets.\n+                paths.emplace_back(fs::relative(it->path(), wallet_dir));",
    "path": "src/wallet/walletutil.cpp",
    "position": 54,
    "original_position": 54,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```\r\nwallet/walletutil.cpp:71:36: error: \u2018relative\u2019 is not a member of \u2018fs\u2019\r\n                 paths.emplace_back(fs::relative(it->path(), wallet_dir));\r\n                                    ^\r\n```\r\n\r\nSee: #14528 (travis: Compile once on xenial)",
    "created_at": "2018-10-20T10:57:40Z",
    "updated_at": "2018-10-20T10:57:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226823679",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226823679"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226823679"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226823679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 71,
    "original_line": 71,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226843422",
    "pull_request_review_id": 166765678,
    "id": 226843422,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjg0MzQyMg==",
    "diff_hunk": "@@ -68,6 +70,8 @@ def wallet_file(name):\n         wallet_names = ['w1', 'w2', 'w3', 'w', 'sub/w5', os.path.join(self.options.tmpdir, 'extern/w6'), 'w7_symlink', 'w8', '']\n         extra_args = ['-wallet={}'.format(n) for n in wallet_names]\n         self.start_node(0, extra_args)\n+        assert_equal(set(map(lambda w: w['name'], self.nodes[0].listwalletdir()['wallets'])), set(['', 'w3', 'w2', 'sub/w5', 'w7', 'w7', 'w1', 'w8', 'w']))",
    "path": "test/functional/wallet_multiwallet.py",
    "position": 13,
    "original_position": 13,
    "commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "original_commit_id": "d56a0689354fb814510c6c393f3e07ac9362dc1f",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is wrong, `fs::relative` resolves symlinks but we allow symlinks to be specified as wallet names. I guess `listwalletdir` should list both `w7` and `w7_symlink` but in runtime only one could be loaded (actually it's the same wallet but with different names). @ryanofsky @laanwj should I fix this in #14531 or fix in a separate PR?",
    "created_at": "2018-10-20T23:32:55Z",
    "updated_at": "2018-10-20T23:32:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226843422",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226843422"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14291#discussion_r226843422"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14291"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226843422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 73,
    "original_line": 73,
    "side": "RIGHT"
  }
]