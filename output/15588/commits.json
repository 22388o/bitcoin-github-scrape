[
  {
    "sha": "c88e87c3b2be3f97b712107e04285d06dfef3878",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjODhlODdjM2IyYmUzZjk3YjcxMjEwN2UwNDI4NWQwNmRmZWYzODc4",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-03-13T04:37:08Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-22T17:02:03Z"
      },
      "message": "Remove nFileVersion from CWalletScanState\n\nnFileVersion is not the actual file version and is not used except\nin one place. So it is removed from CWalletScanState and changed so\nthat it is just read at the place it is needed. Furthermore, the\n\"version\" record now only indicates the version of the highest\nversioned client that has opened a wallet file so the variable\nname is changed accordingly",
      "tree": {
        "sha": "5327195b799723aa86bd899ec7a83d8c04365206",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5327195b799723aa86bd899ec7a83d8c04365206"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c88e87c3b2be3f97b712107e04285d06dfef3878",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c88e87c3b2be3f97b712107e04285d06dfef3878",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c88e87c3b2be3f97b712107e04285d06dfef3878",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c88e87c3b2be3f97b712107e04285d06dfef3878/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c3b1cb958f7c57c5d87db663f2b1a83e3471d354",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c3b1cb958f7c57c5d87db663f2b1a83e3471d354",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c3b1cb958f7c57c5d87db663f2b1a83e3471d354"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 8,
      "deletions": 11
    },
    "files": [
      {
        "sha": "6499204c8f34ef1f50996194fd091952255e3328",
        "filename": "src/wallet/walletdb.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 11,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c88e87c3b2be3f97b712107e04285d06dfef3878/src/wallet/walletdb.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c88e87c3b2be3f97b712107e04285d06dfef3878/src/wallet/walletdb.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/walletdb.cpp?ref=c88e87c3b2be3f97b712107e04285d06dfef3878",
        "patch": "@@ -165,7 +165,6 @@ class CWalletScanState {\n     unsigned int m_unknown_records{0};\n     bool fIsEncrypted{false};\n     bool fAnyUnordered{false};\n-    int nFileVersion{0};\n     std::vector<uint256> vWalletUpgrade;\n \n     CWalletScanState() {\n@@ -376,12 +375,6 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n \n             pwallet->LoadKeyPool(nIndex, keypool);\n         }\n-        else if (strType == \"version\")\n-        {\n-            ssValue >> wss.nFileVersion;\n-            if (wss.nFileVersion == 10300)\n-                wss.nFileVersion = 300;\n-        }\n         else if (strType == \"cscript\")\n         {\n             uint160 hash;\n@@ -419,7 +412,7 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n                 return false;\n             }\n         } else if (strType != \"bestblock\" && strType != \"bestblock_nomerkle\" &&\n-                strType != \"minversion\" && strType != \"acentry\") {\n+                strType != \"minversion\" && strType != \"acentry\" && strType != \"version\") {\n             wss.m_unknown_records++;\n         }\n     } catch (...)\n@@ -512,7 +505,11 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     if (result != DBErrors::LOAD_OK)\n         return result;\n \n-    pwallet->WalletLogPrintf(\"nFileVersion = %d\\n\", wss.nFileVersion);\n+    // Last client version to open this wallet, was previously the file version number\n+    int last_client = CLIENT_VERSION;\n+    ReadVersion(last_client);\n+\n+    pwallet->WalletLogPrintf(\"nFileVersion = %d\\n\", last_client);\n \n     pwallet->WalletLogPrintf(\"Keys: %u plaintext, %u encrypted, %u w/ metadata, %u total. Unknown wallet records: %u\\n\",\n            wss.nKeys, wss.nCKeys, wss.nKeyMeta, wss.nKeys + wss.nCKeys, wss.m_unknown_records);\n@@ -525,10 +522,10 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n         WriteTx(pwallet->mapWallet.at(hash));\n \n     // Rewrite encrypted wallets of versions 0.4.0 and 0.5.0rc:\n-    if (wss.fIsEncrypted && (wss.nFileVersion == 40000 || wss.nFileVersion == 50000))\n+    if (wss.fIsEncrypted && (last_client == 40000 || last_client == 50000))\n         return DBErrors::NEED_REWRITE;\n \n-    if (wss.nFileVersion < CLIENT_VERSION) // Update\n+    if (last_client < CLIENT_VERSION) // Update\n         WriteVersion(CLIENT_VERSION);\n \n     if (wss.fAnyUnordered)"
      }
    ]
  },
  {
    "sha": "b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiM2Q0ZjZjOTYxOTE0Mjk0OGFiM2Q1MzU1MWI0ZjNjMGQ3ZDczYmRl",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-03-13T04:38:24Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-22T17:03:24Z"
      },
      "message": "Log the actual wallet file version\n\nThe actual wallet file version is the minversion record, not the\nversion record.",
      "tree": {
        "sha": "4ab1faa0dbbcf3a5915af6904c3c502bd05ee9ae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4ab1faa0dbbcf3a5915af6904c3c502bd05ee9ae"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c88e87c3b2be3f97b712107e04285d06dfef3878",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c88e87c3b2be3f97b712107e04285d06dfef3878",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c88e87c3b2be3f97b712107e04285d06dfef3878"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "2db18bec2bf34dd7ef6786bba95bb8769d4dd3d6",
        "filename": "src/wallet/walletdb.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde/src/wallet/walletdb.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde/src/wallet/walletdb.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/walletdb.cpp?ref=b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
        "patch": "@@ -509,7 +509,8 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n     int last_client = CLIENT_VERSION;\n     ReadVersion(last_client);\n \n-    pwallet->WalletLogPrintf(\"nFileVersion = %d\\n\", last_client);\n+    int wallet_version = pwallet->GetVersion();\n+    pwallet->WalletLogPrintf(\"Wallet File Version = %d\\n\", wallet_version > 0 ? wallet_version : last_client);\n \n     pwallet->WalletLogPrintf(\"Keys: %u plaintext, %u encrypted, %u w/ metadata, %u total. Unknown wallet records: %u\\n\",\n            wss.nKeys, wss.nCKeys, wss.nKeyMeta, wss.nKeys + wss.nCKeys, wss.m_unknown_records);"
      }
    ]
  },
  {
    "sha": "35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNWU2MGU3OTBmMmNkNjAyZDFiZGQwYmU4MzVkMjdmMGJhMzdlZmE5",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-03-13T04:44:52Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-22T17:03:28Z"
      },
      "message": "Remove ReadVersion and WriteVersion\n\nThe \"version\" record that these functions read and write are not\nused anywhere in the code except for one place. There is no reason\nto expose these functions publicly. Furthermore, this avoids potential\nconfusion as developers may mistake these functions for actually\nreading and writing the wallet version when they do not.",
      "tree": {
        "sha": "ead3478f25e1b738f3441a247f1f91053dc1696f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ead3478f25e1b738f3441a247f1f91053dc1696f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b3d4f6c9619142948ab3d53551b4f3c0d7d73bde"
      }
    ],
    "stats": {
      "total": 31,
      "additions": 3,
      "deletions": 28
    },
    "files": [
      {
        "sha": "41c157c5c0488100dbca5195c28bbf48bd3589c2",
        "filename": "src/wallet/db.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/db.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/db.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/db.cpp?ref=35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
        "patch": "@@ -587,7 +587,7 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const char* pszMode, bo\n             if (fCreate && !Exists(std::string(\"version\"))) {\n                 bool fTmp = fReadOnly;\n                 fReadOnly = false;\n-                WriteVersion(CLIENT_VERSION);\n+                Write(std::string(\"version\"), CLIENT_VERSION);\n                 fReadOnly = fTmp;\n             }\n         }"
      },
      {
        "sha": "671bb7e6c36ea9ad8369b666d2acd47345ede553",
        "filename": "src/wallet/db.h",
        "status": "modified",
        "additions": 0,
        "deletions": 11,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/db.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/db.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/db.h?ref=35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
        "patch": "@@ -396,17 +396,6 @@ class BerkeleyBatch\n         return (ret == 0);\n     }\n \n-    bool ReadVersion(int& nVersion)\n-    {\n-        nVersion = 0;\n-        return Read(std::string(\"version\"), nVersion);\n-    }\n-\n-    bool WriteVersion(int nVersion)\n-    {\n-        return Write(std::string(\"version\"), nVersion);\n-    }\n-\n     bool static Rewrite(BerkeleyDatabase& database, const char* pszSkip = nullptr);\n };\n "
      },
      {
        "sha": "9e992b266cdb48d0f23a6a396ee78926ce3e5a8b",
        "filename": "src/wallet/walletdb.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 12,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/walletdb.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/walletdb.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/walletdb.cpp?ref=35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
        "patch": "@@ -507,7 +507,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n \n     // Last client version to open this wallet, was previously the file version number\n     int last_client = CLIENT_VERSION;\n-    ReadVersion(last_client);\n+    m_batch.Read(std::string(\"version\"), last_client);\n \n     int wallet_version = pwallet->GetVersion();\n     pwallet->WalletLogPrintf(\"Wallet File Version = %d\\n\", wallet_version > 0 ? wallet_version : last_client);\n@@ -527,7 +527,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n         return DBErrors::NEED_REWRITE;\n \n     if (last_client < CLIENT_VERSION) // Update\n-        WriteVersion(CLIENT_VERSION);\n+        m_batch.Write(std::string(\"version\"), CLIENT_VERSION);\n \n     if (wss.fAnyUnordered)\n         result = pwallet->ReorderTransactions();\n@@ -770,13 +770,3 @@ bool WalletBatch::TxnAbort()\n {\n     return m_batch.TxnAbort();\n }\n-\n-bool WalletBatch::ReadVersion(int& nVersion)\n-{\n-    return m_batch.ReadVersion(nVersion);\n-}\n-\n-bool WalletBatch::WriteVersion(int nVersion)\n-{\n-    return m_batch.WriteVersion(nVersion);\n-}"
      },
      {
        "sha": "90163528af10d21e65e19d6daa068d8cc52e3a48",
        "filename": "src/wallet/walletdb.h",
        "status": "modified",
        "additions": 0,
        "deletions": 4,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/walletdb.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/35e60e790f2cd602d1bdd0be835d27f0ba37efa9/src/wallet/walletdb.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/walletdb.h?ref=35e60e790f2cd602d1bdd0be835d27f0ba37efa9",
        "patch": "@@ -241,10 +241,6 @@ class WalletBatch\n     bool TxnCommit();\n     //! Abort current transaction\n     bool TxnAbort();\n-    //! Read wallet version\n-    bool ReadVersion(int& nVersion);\n-    //! Write wallet version\n-    bool WriteVersion(int nVersion);\n private:\n     BerkeleyBatch m_batch;\n     WalletDatabase& m_database;"
      }
    ]
  }
]