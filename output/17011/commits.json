[
  {
    "sha": "ddddd8961b6209cba1bcabad73916051a99f2025",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZGRkZDg5NjFiNjIwOWNiYTFiY2FiYWQ3MzkxNjA1MWE5OWYyMDI1",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-09-30T21:26:22Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-10-02T14:01:04Z"
      },
      "message": "ci: Use busybox utils for one build",
      "tree": {
        "sha": "dead4d1224f46a530d355850f803cc2d3d7b201e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dead4d1224f46a530d355850f803cc2d3d7b201e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ddddd8961b6209cba1bcabad73916051a99f2025",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhCzwwAyJhIghr7xoQusHVbuU8p7vqp0IMZfX09FYPdcCpEeFza5+aHuWiolEnB\nfKalzj4PN2zTs7xeOXJJk5CxLU2bkGZldd2h3UzIyYJ+h4lbNhvvneX3mLMShcCk\ngMG23Rqlipr2rkdQfm16f5Da4arFsxagr7DI9nudktjX+gtdT4Q8T5x5xHI8plgJ\nr2JkaZgxeQGiwp+FOnTjwg0jfgpkgPdU1yP8i2SiyZPlHhKzNPhJxD/wUERfxi2O\n/0AWpotfJonY5gCnSGe9D5CvUztLB9hPJY2muajSlf2OZKvA0wAaY5hvbefJE5dy\n5kKOs8J9pNfO4fZtNDFu7ZWWtrYU4dpt4BPBrpcvCRym+ggjlVlOwtbDKFNri0IF\nYXADyC7RQ41nAENU5sg7u1gSs51IqjXW5hZ7gFJqnCL4dFW1XclVvW7EJ1C1NWnL\nOGzP+nSZn2XMbXyJgiU7I+jzv1+/e8XwIp2n1/ecmOjZWQtexBytwILgbjPXKV9W\nGCBDNeM3\n=C6M2\n-----END PGP SIGNATURE-----",
        "payload": "tree dead4d1224f46a530d355850f803cc2d3d7b201e\nparent bb83d23ad8162b1bd31aae53fab1c1dee4523838\nauthor MarcoFalke <falke.marco@gmail.com> 1569878782 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1570024864 -0400\n\nci: Use busybox utils for one build\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ddddd8961b6209cba1bcabad73916051a99f2025",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ddddd8961b6209cba1bcabad73916051a99f2025",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ddddd8961b6209cba1bcabad73916051a99f2025/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bb83d23ad8162b1bd31aae53fab1c1dee4523838",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bb83d23ad8162b1bd31aae53fab1c1dee4523838",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bb83d23ad8162b1bd31aae53fab1c1dee4523838"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 18,
      "deletions": 4
    },
    "files": [
      {
        "sha": "8bc50da2c3d3981292416022696081eb37332d59",
        "filename": "ci/test/00_setup_env.sh",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ddddd8961b6209cba1bcabad73916051a99f2025/ci/test/00_setup_env.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ddddd8961b6209cba1bcabad73916051a99f2025/ci/test/00_setup_env.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/00_setup_env.sh?ref=ddddd8961b6209cba1bcabad73916051a99f2025",
        "patch": "@@ -22,6 +22,8 @@ export MAKEJOBS=${MAKEJOBS:--j4}\n # A folder for the ci system to put temporary files (ccache, datadirs for tests, ...)\n export BASE_SCRATCH_DIR=${BASE_SCRATCH_DIR:-$BASE_ROOT_DIR/ci/scratch/}\n export HOST=${HOST:-x86_64-unknown-linux-gnu}\n+# Whether to prefer BusyBox over GNU utilities\n+export USE_BUSY_BOX=${USE_BUSY_BOX:-false}\n export RUN_UNIT_TESTS=${RUN_UNIT_TESTS:-true}\n export RUN_FUNCTIONAL_TESTS=${RUN_FUNCTIONAL_TESTS:-true}\n export RUN_FUZZ_TESTS=${RUN_FUZZ_TESTS:-false}"
      },
      {
        "sha": "db640015b12c44c3685d9c82d2353aa4148f7aeb",
        "filename": "ci/test/00_setup_env_arm.sh",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ddddd8961b6209cba1bcabad73916051a99f2025/ci/test/00_setup_env_arm.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ddddd8961b6209cba1bcabad73916051a99f2025/ci/test/00_setup_env_arm.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/00_setup_env_arm.sh?ref=ddddd8961b6209cba1bcabad73916051a99f2025",
        "patch": "@@ -7,7 +7,8 @@\n export LC_ALL=C.UTF-8\n \n export HOST=arm-linux-gnueabihf\n-export PACKAGES=\"python3 g++-arm-linux-gnueabihf\"\n+export PACKAGES=\"python3 g++-arm-linux-gnueabihf busybox\"\n+export USE_BUSY_BOX=true\n export RUN_UNIT_TESTS=false\n export RUN_FUNCTIONAL_TESTS=false\n export GOAL=\"install\""
      },
      {
        "sha": "40a6d582ecec4a4eb4f57587d625fdc89ceb5c7e",
        "filename": "ci/test/04_install.sh",
        "status": "modified",
        "additions": 14,
        "deletions": 3,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ddddd8961b6209cba1bcabad73916051a99f2025/ci/test/04_install.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ddddd8961b6209cba1bcabad73916051a99f2025/ci/test/04_install.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/04_install.sh?ref=ddddd8961b6209cba1bcabad73916051a99f2025",
        "patch": "@@ -33,18 +33,29 @@ if [ -z \"$RUN_CI_ON_HOST\" ]; then\n   DOCKER_ID=$(docker run $DOCKER_ADMIN -idt --mount type=bind,src=$BASE_BUILD_DIR,dst=$BASE_BUILD_DIR --mount type=bind,src=$CCACHE_DIR,dst=$CCACHE_DIR -w $BASE_BUILD_DIR --env-file /tmp/env $DOCKER_NAME_TAG)\n \n   DOCKER_EXEC () {\n-    docker exec $DOCKER_ID bash -c \"cd $PWD && $*\"\n+    docker exec $DOCKER_ID bash -c \"export PATH=$BASE_SCRATCH_DIR/bins/:\\$PATH && cd $PWD && $*\"\n   }\n else\n   echo \"Running on host system without docker wrapper\"\n   DOCKER_EXEC () {\n-    bash -c \"cd $PWD && $*\"\n+    bash -c \"export PATH=$BASE_SCRATCH_DIR/bins/:\\$PATH && cd $PWD && $*\"\n   }\n fi\n \n DOCKER_EXEC free -m -h\n-DOCKER_EXEC echo \"Number of CPUs \\(nproc\\): $(nproc)\"\n+DOCKER_EXEC echo \"Number of CPUs \\(nproc\\):\" \\$\\(nproc\\)\n \n ${CI_RETRY_EXE} DOCKER_EXEC apt-get update\n ${CI_RETRY_EXE} DOCKER_EXEC apt-get install --no-install-recommends --no-upgrade -qq $PACKAGES $DOCKER_PACKAGES\n \n+if [ \"$USE_BUSY_BOX\" = \"true\" ]; then\n+  echo \"Setup to use BusyBox utils\"\n+  DOCKER_EXEC mkdir -p $BASE_SCRATCH_DIR/bins/\n+  # tar excluded for now because it requires passing in the exact archive type in ./depends (fixed in later BusyBox version)\n+  # find excluded for now because it does not recognize the -delete option in ./depends (fixed in later BusyBox version)\n+  # ar excluded for now because it does not recognize the -q option in ./depends (unknown if fixed)\n+  # shellcheck disable=SC1010\n+  DOCKER_EXEC for util in \\$\\(busybox --list \\| grep -v \"^ar$\" \\| grep -v \"^tar$\" \\| grep -v \"^find$\"\\)\\; do ln -s \\$\\(command -v busybox\\) $BASE_SCRATCH_DIR/bins/\\$util\\; done\n+  # Print BusyBox version\n+  DOCKER_EXEC patch --help\n+fi"
      }
    ]
  }
]