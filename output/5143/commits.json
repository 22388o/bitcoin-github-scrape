[
  {
    "sha": "ae4151bbad74ab54de818d7704fa4568ee65e40d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZTQxNTFiYmFkNzRhYjU0ZGU4MThkNzcwNGZhNDU2OGVlNjVlNDBk",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-10-25T12:24:14Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-11-25T11:35:32Z"
      },
      "message": "No semantic change: reuse stack variable in P2SH evaluation",
      "tree": {
        "sha": "d5b7988524b78c41f6b060c6c376bd28fc9b3ca3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d5b7988524b78c41f6b060c6c376bd28fc9b3ca3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae4151bbad74ab54de818d7704fa4568ee65e40d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae4151bbad74ab54de818d7704fa4568ee65e40d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ae4151bbad74ab54de818d7704fa4568ee65e40d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae4151bbad74ab54de818d7704fa4568ee65e40d/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "397b9011c9b88ccf623f798a4925228c30813530",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/397b9011c9b88ccf623f798a4925228c30813530",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/397b9011c9b88ccf623f798a4925228c30813530"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 10,
      "deletions": 7
    },
    "files": [
      {
        "sha": "d97f917c373641b6986f61b60775885f9402fcbd",
        "filename": "src/script/interpreter.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 7,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ae4151bbad74ab54de818d7704fa4568ee65e40d/src/script/interpreter.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ae4151bbad74ab54de818d7704fa4568ee65e40d/src/script/interpreter.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/interpreter.cpp?ref=ae4151bbad74ab54de818d7704fa4568ee65e40d",
        "patch": "@@ -1107,21 +1107,24 @@ bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, unsigne\n         if (!scriptSig.IsPushOnly())\n             return set_error(serror, SCRIPT_ERR_SIG_PUSHONLY);\n \n-        // stackCopy cannot be empty here, because if it was the\n+        // Restore stack.\n+        swap(stack, stackCopy);\n+\n+        // stack cannot be empty here, because if it was the\n         // P2SH  HASH <> EQUAL  scriptPubKey would be evaluated with\n         // an empty stack and the EvalScript above would return false.\n-        assert(!stackCopy.empty());\n+        assert(!stack.empty());\n \n-        const valtype& pubKeySerialized = stackCopy.back();\n+        const valtype& pubKeySerialized = stack.back();\n         CScript pubKey2(pubKeySerialized.begin(), pubKeySerialized.end());\n-        popstack(stackCopy);\n+        popstack(stack);\n \n-        if (!EvalScript(stackCopy, pubKey2, flags, checker, serror))\n+        if (!EvalScript(stack, pubKey2, flags, checker, serror))\n             // serror is set\n             return false;\n-        if (stackCopy.empty())\n+        if (stack.empty())\n             return set_error(serror, SCRIPT_ERR_EVAL_FALSE);\n-        if (!CastToBool(stackCopy.back()))\n+        if (!CastToBool(stack.back()))\n             return set_error(serror, SCRIPT_ERR_EVAL_FALSE);\n         else\n             return set_success(serror);"
      }
    ]
  },
  {
    "sha": "b6e03cc59208305681745ad06f2056ffe6690597",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiNmUwM2NjNTkyMDgzMDU2ODE3NDVhZDA2ZjIwNTZmZmU2NjkwNTk3",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-10-13T01:39:47Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-11-25T11:38:01Z"
      },
      "message": "Add SCRIPT_VERIFY_CLEANSTACK (BIP62 rule 6)\n\nBased on an earlier patch by Peter Todd, though the rules here are different\n(P2SH scripts should not have a CLEANSTACK check before the P2SH evaluation).",
      "tree": {
        "sha": "78e701bf890c2302c2249266cfcd124e5b7e554a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/78e701bf890c2302c2249266cfcd124e5b7e554a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b6e03cc59208305681745ad06f2056ffe6690597",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b6e03cc59208305681745ad06f2056ffe6690597",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b6e03cc59208305681745ad06f2056ffe6690597",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b6e03cc59208305681745ad06f2056ffe6690597/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ae4151bbad74ab54de818d7704fa4568ee65e40d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae4151bbad74ab54de818d7704fa4568ee65e40d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ae4151bbad74ab54de818d7704fa4568ee65e40d"
      }
    ],
    "stats": {
      "total": 75,
      "additions": 69,
      "deletions": 6
    },
    "files": [
      {
        "sha": "1b187f5ef5cb06c753ffef0a5f9e319e2b2963a2",
        "filename": "src/script/interpreter.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 3,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/script/interpreter.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/script/interpreter.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/interpreter.cpp?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -1096,7 +1096,6 @@ bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, unsigne\n         return false;\n     if (stack.empty())\n         return set_error(serror, SCRIPT_ERR_EVAL_FALSE);\n-\n     if (CastToBool(stack.back()) == false)\n         return set_error(serror, SCRIPT_ERR_EVAL_FALSE);\n \n@@ -1126,8 +1125,18 @@ bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, unsigne\n             return set_error(serror, SCRIPT_ERR_EVAL_FALSE);\n         if (!CastToBool(stack.back()))\n             return set_error(serror, SCRIPT_ERR_EVAL_FALSE);\n-        else\n-            return set_success(serror);\n+    }\n+\n+    // The CLEANSTACK check is only performed after potential P2SH evaluation,\n+    // as the non-P2SH evaluation of a P2SH script will obviously not result in\n+    // a clean stack (the P2SH inputs remain).\n+    if ((flags & SCRIPT_VERIFY_CLEANSTACK) != 0) {\n+        // Disallow CLEANSTACK without P2SH, as otherwise a switch CLEANSTACK->P2SH+CLEANSTACK\n+        // would be possible, which is not a softfork (and P2SH should be one).\n+        assert((flags & SCRIPT_VERIFY_P2SH) != 0);\n+        if (stack.size() != 1) {\n+            return set_error(serror, SCRIPT_ERR_CLEANSTACK);\n+        }\n     }\n \n     return set_success(serror);"
      },
      {
        "sha": "9b35b176aeb7000a7d75e50eb8cf6b495080dda9",
        "filename": "src/script/interpreter.h",
        "status": "modified",
        "additions": 8,
        "deletions": 2,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/script/interpreter.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/script/interpreter.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/interpreter.h?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -67,8 +67,14 @@ enum\n     // discouraged NOPs fails the script. This verification flag will never be\n     // a mandatory flag applied to scripts in a block. NOPs that are not\n     // executed, e.g.  within an unexecuted IF ENDIF block, are *not* rejected.\n-    SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS  = (1U << 7)\n-\n+    SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS  = (1U << 7),\n+\n+    // Require that only a single stack element remains after evaluation. This changes the success criterion from\n+    // \"At least one stack element must remain, and when interpreted as a boolean, it must be true\" to\n+    // \"Exactly one stack element must remain, and when interpreted as a boolean, it must be true\".\n+    // (softfork safe, BIP62 rule 6)\n+    // Note: CLEANSTACK should never be used without P2SH.\n+    SCRIPT_VERIFY_CLEANSTACK = (1U << 8),\n };\n \n uint256 SignatureHash(const CScript &scriptCode, const CTransaction& txTo, unsigned int nIn, int nHashType);"
      },
      {
        "sha": "f085b63032dd552c9e664ca37bcf056636e4f294",
        "filename": "src/script/script_error.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/script/script_error.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/script/script_error.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/script_error.h?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -43,6 +43,7 @@ typedef enum ScriptError_t\n     SCRIPT_ERR_SIG_HIGH_S,\n     SCRIPT_ERR_SIG_NULLDUMMY,\n     SCRIPT_ERR_PUBKEYTYPE,\n+    SCRIPT_ERR_CLEANSTACK,\n \n     /* softfork safeness */\n     SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS,"
      },
      {
        "sha": "d21abebb48cf40bc28b553a5df3f9c0bd2a0de6b",
        "filename": "src/test/data/script_invalid.json",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/test/data/script_invalid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/test/data/script_invalid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_invalid.json?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -671,6 +671,18 @@ signatures and pubkeys.\n     \"SIGPUSHONLY\",\n     \"P2SH(P2PK) with non-push scriptSig\"\n ],\n+[\n+    \"11 0x47 0x3044022057c4ba463d3b8e6848b3896be14c6953caf0528cd390ad15104a109c94b558ba02206fa3922154e1d0bfca92ce5f9adbe4991be33f3f5b7f6bf501e895b7e37fd72f01\",\n+    \"0x41 0x0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8 CHECKSIG\",\n+    \"CLEANSTACK,P2SH\",\n+    \"P2PK with unnecessary input\"\n+],\n+[\n+    \"11 0x47 0x304402203407c26745ea95ee31fbb5074e730ff9be235d5a8d8e0a2c868358bf6a04797402205cc0e594dfd275583472168298d448be59c2530a4ea4d7c37311b82108f9f8bc01 0x43 0x410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8ac\",\n+    \"HASH160 0x14 0x31edc23bdafda4639e669f89ad6b2318dd79d032 EQUAL\",\n+    \"CLEANSTACK,P2SH\",\n+    \"P2SH with unnecessary input\"\n+],\n \n [\"The End\"]\n ]"
      },
      {
        "sha": "072c7dcafd1cd2a740cffcb59b00c8f523568455",
        "filename": "src/test/data/script_valid.json",
        "status": "modified",
        "additions": 18,
        "deletions": 0,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/test/data/script_valid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/test/data/script_valid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_valid.json?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -822,6 +822,24 @@ See also the corresponding inverted versions of these tests in script_invalid.js\n     \"SIGPUSHONLY\",\n     \"2-of-2 with two identical keys and sigs pushed\"\n ],\n+[\n+    \"11 0x47 0x304402204ba8b04dfe8657608427b996bd7c151ff8cd8579b3316c7314549a6c59f6bfb7022058cf052927fbc5e51e26dd4711c470bbf7f3adc8aaaf7bfa304eff6bb6e6399e01\",\n+    \"0x41 0x0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8 CHECKSIG\",\n+    \"P2SH\",\n+    \"P2PK with unnecessary input but no CLEANSTACK\"\n+],\n+[\n+    \"11 0x47 0x304402202beaa2f6a4ec783091643797f9819b5ae39a03dfcf3b934746e96dd6b2ad5f7202200650a618fb2ce08b4edd160351172e016a041c81622d806390420d15cc6cece401 0x43 0x410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8ac\",\n+    \"HASH160 0x14 0x31edc23bdafda4639e669f89ad6b2318dd79d032 EQUAL\",\n+    \"P2SH\",\n+    \"P2SH with unnecessary input but no CLEANSTACK\"\n+],\n+[\n+    \"0x47 0x3044022048505fd42afde400932558ea7fa76a52c2fff3130fa820a6a05647f64d5d780e022056a6bc823c95cedf68f6f67ad036533b48b9f3f706355a71f9f6e647e889f79201 0x43 0x410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8ac\",\n+    \"HASH160 0x14 0x31edc23bdafda4639e669f89ad6b2318dd79d032 EQUAL\",\n+    \"CLEANSTACK,P2SH\",\n+    \"P2SH with CLEANSTACK\"\n+],\n \n [\"The End\"]\n ]"
      },
      {
        "sha": "22c182b1225ff6831165ae6be0755eb8e1e0735c",
        "filename": "src/test/script_tests.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 0,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/test/script_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/test/script_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/script_tests.cpp?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -489,6 +489,22 @@ BOOST_AUTO_TEST_CASE(script_build)\n                                \"2-of-2 with two identical keys and sigs pushed\", SCRIPT_VERIFY_SIGPUSHONLY\n                               ).Num(0).PushSig(keys.key1).PushSig(keys.key1));\n \n+    good.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey0) << OP_CHECKSIG,\n+                               \"P2PK with unnecessary input but no CLEANSTACK\", SCRIPT_VERIFY_P2SH\n+                              ).Num(11).PushSig(keys.key0));\n+    bad.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey0) << OP_CHECKSIG,\n+                              \"P2PK with unnecessary input\", SCRIPT_VERIFY_CLEANSTACK | SCRIPT_VERIFY_P2SH\n+                             ).Num(11).PushSig(keys.key0));\n+    good.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey0) << OP_CHECKSIG,\n+                               \"P2SH with unnecessary input but no CLEANSTACK\", SCRIPT_VERIFY_P2SH, true\n+                              ).Num(11).PushSig(keys.key0).PushRedeem());\n+    bad.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey0) << OP_CHECKSIG,\n+                              \"P2SH with unnecessary input\", SCRIPT_VERIFY_CLEANSTACK | SCRIPT_VERIFY_P2SH, true\n+                             ).Num(11).PushSig(keys.key0).PushRedeem());\n+    good.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey0) << OP_CHECKSIG,\n+                               \"P2SH with CLEANSTACK\", SCRIPT_VERIFY_CLEANSTACK | SCRIPT_VERIFY_P2SH, true\n+                              ).PushSig(keys.key0).PushRedeem());\n+\n \n     std::map<std::string, Array> tests_good;\n     std::map<std::string, Array> tests_bad;"
      },
      {
        "sha": "67b2dd5df66a44292979057833468048c060ce9f",
        "filename": "src/test/transaction_tests.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b6e03cc59208305681745ad06f2056ffe6690597/src/test/transaction_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b6e03cc59208305681745ad06f2056ffe6690597/src/test/transaction_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/transaction_tests.cpp?ref=b6e03cc59208305681745ad06f2056ffe6690597",
        "patch": "@@ -38,7 +38,8 @@ static std::map<string, unsigned int> mapFlagNames = boost::assign::map_list_of\n     (string(\"SIGPUSHONLY\"), (unsigned int)SCRIPT_VERIFY_SIGPUSHONLY)\n     (string(\"MINIMALDATA\"), (unsigned int)SCRIPT_VERIFY_MINIMALDATA)\n     (string(\"NULLDUMMY\"), (unsigned int)SCRIPT_VERIFY_NULLDUMMY)\n-    (string(\"DISCOURAGE_UPGRADABLE_NOPS\"), (unsigned int)SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS);\n+    (string(\"DISCOURAGE_UPGRADABLE_NOPS\"), (unsigned int)SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)\n+    (string(\"CLEANSTACK\"), (unsigned int)SCRIPT_VERIFY_CLEANSTACK);\n \n unsigned int ParseScriptFlags(string strFlags)\n {"
      }
    ]
  },
  {
    "sha": "da918ac06e0d064e9584959ab3d241d03500e972",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYTkxOGFjMDZlMGQwNjRlOTU4NDk1OWFiM2QyNDFkMDM1MDBlOTcy",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-11-19T14:52:50Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-11-25T11:38:01Z"
      },
      "message": "Make SCRIPT_VERIFY_CLEANSTACK a standardness requirement",
      "tree": {
        "sha": "9ef858aad579c4eae5363e58aacec298afab793a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9ef858aad579c4eae5363e58aacec298afab793a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da918ac06e0d064e9584959ab3d241d03500e972",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/da918ac06e0d064e9584959ab3d241d03500e972",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/da918ac06e0d064e9584959ab3d241d03500e972",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/da918ac06e0d064e9584959ab3d241d03500e972/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b6e03cc59208305681745ad06f2056ffe6690597",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b6e03cc59208305681745ad06f2056ffe6690597",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b6e03cc59208305681745ad06f2056ffe6690597"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "ed85816a3751d15cc5704adbb30e834526221219",
        "filename": "src/script/standard.h",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/da918ac06e0d064e9584959ab3d241d03500e972/src/script/standard.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/da918ac06e0d064e9584959ab3d241d03500e972/src/script/standard.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/standard.h?ref=da918ac06e0d064e9584959ab3d241d03500e972",
        "patch": "@@ -48,7 +48,8 @@ static const unsigned int STANDARD_SCRIPT_VERIFY_FLAGS = MANDATORY_SCRIPT_VERIFY\n                                                          SCRIPT_VERIFY_STRICTENC |\n                                                          SCRIPT_VERIFY_MINIMALDATA |\n                                                          SCRIPT_VERIFY_NULLDUMMY |\n-                                                         SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS;\n+                                                         SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS |\n+                                                         SCRIPT_VERIFY_CLEANSTACK;\n \n /** For convenience, standard but not mandatory verify flags. */\n static const unsigned int STANDARD_NOT_MANDATORY_VERIFY_FLAGS = STANDARD_SCRIPT_VERIFY_FLAGS & ~MANDATORY_SCRIPT_VERIFY_FLAGS;"
      }
    ]
  }
]