dcousens,2015-12-16T13:04:37Z,Couldn't the `minRelayFee` be smaller than the actual though?  Isn't the point of this to follow rational incentives?\n,https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165098671,165098671,
luke-jr,2015-12-16T13:11:30Z,There is another check for the economically-rational fee comparison before this one.\n,https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165099846,165099846,
morcos,2015-12-16T13:43:05Z,"NACK on both commits\n\nIt's necessary to pay for actual fees of the previously transmitted tx ~~otherwise you could do the following attack.  Sent tx A of size 100k, paying 100,000 satoshis fee.  Send tx B of size 1k paying 101,000 satoshis fee which evicts tx A due to full mempool.   Send tx C of size 100k, paying 101,001 satoshis fee which RBF's tx B.  At this point you have now sent 201k bytes",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165109434,165109434,
morcos,2015-12-16T14:30:01Z,"Sorry.  Bad example.\n\nAnyway more simply, if tx A pays 2000 satoshis for 1000 bytes.  Then you can keep replacing it in a chain of txs that each pay only 1 satoshi higher for an effective relay cost of 1 satoshi per 1000 bytes.\n",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165126092,165126092,
DavidVorick,2015-12-16T14:35:15Z,"NACK, as morcos stated the purpose of requiring a larger fee is to prevent DoS attacks on the transaction relay network, and not just to make sure that all transactions have paid their fair amount of fee.\n",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165127284,165127284,
GIJensen,2015-12-16T14:42:58Z,"@morcos, so we'd have to consider all previously replaced TXs in the chain to accurately calculate the correct min fee? Is that heavy?\n\nConcept ACK, I like the idea, if it's possible to do securely.\n",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165129520,165129520,
DavidVorick,2015-12-16T14:46:30Z,"@GIJensen you only have to consider the transaction that is being replaced and the transaction that is replacing it. The transaction that is being replaced can be assumed to have already paid the correct minimum fee, so as long as you are paying the minimum above that it's guaranteed to be sufficient.\n",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165130430,165130430,
GIJensen,2015-12-16T14:51:50Z,@DavidVorick with RBF right now you have a guarantee that the previous TX paid a sufficient fee as its always previous actualFee(replaced)+whatever. Using minimum fees is different though because if you replace 20 transactions the minfee of the previous is still always the same regardless of how many it replaced. So you could increase by 1 satoshi to get minRelayFee+minRelayFee usually.\n\nIf you ,https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165131765,165131765,
GIJensen,2015-12-16T14:55:13Z,A simpler explanation. Right now RBF only looks at the previous TX and that's fine. With this change it makes more sense to look at the entire chain (as it's now relevant).\n,https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165132598,165132598,
sdaftuar,2015-12-16T15:12:31Z,"@GIJensen  Opt-in RBF already considers the fees paid by all transactions being removed from the mempool.  (Otherwise there would be a free relay attack, where descendant transactions get relayed for free simply by replacing their parent, causing them to be evicted.) \n\nThis isn't terribly expensive to calculate, as we conservatively limit the number of transactions that a new transaction can rep",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165136796,165136796,
GIJensen,2015-12-16T15:15:58Z,"@sdaftuar then I don't understand @morco's concerns. If all previous minimum fees are considered, then you can't pay less than the sum of all replaced transaction's minimum fees, no?\n",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165137650,165137650,
sdaftuar,2015-12-16T15:26:15Z,"@GIJensen The example @morcos gave is correct.  The current logic prevents free relay attacks by requiring that the new transaction still have enough to pay for its own relay, even after paying for all the fees being evicted -- so the total fee in the mempool is now at least minRelayFee higher after the replacement.\n\nAs @morcos pointed out, this pull would allow the total fee in the mempool to i",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165141218,165141218,
GIJensen,2015-12-16T15:38:39Z,@sdaftuar but doesn't that ignore what I was saying? I already said this doesn't work in It's current state and it could only work if it can/will factor in the minimum fees for all transactions replaced in the chain (making it literally impossible to pay any less than the sum of all minimum fees) I guess that's impossible if they're completely dropped from mempool.\n\nI still agree with the concep,https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165147136,165147136,
sdaftuar,2015-12-16T15:52:40Z,"@GIJensen  Your suggestion is to sum the minRelayFee for all transactions what would be evicted, including descendants of transactions that conflict with the replacement, right?  That is actually what this PR does.   But the free relay attack @morcos described is still correct; note that his example didn't have anything to do with chains.  Say you have a transaction in the mempool with no descenda",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165152829,165152829,
luke-jr,2015-12-16T18:30:44Z,"@morcos The problem you describe is exactly what the second commit was indended to fix. But I see that in more complex scenarios it wouldn't actually be a complete fix. I think the CTxMemPoolEntry would need to cache the minimums required for this to work, and it's probably not worth it, so closing.\n",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165204688,165204688,
luke-jr,2015-12-17T00:39:05Z,"For the benefit of readers:\n- <@GIJensen&gt; @Luke-Jr, PR 7220 for my sanity, you closed it because it doesn't cache the minimums (so the proper min can't be calculated)? That's what I thought but two other people disagreed with me :S\n- <@GIJensen&gt; @Luke-Jr I'm just asking for clarity on the comments previous to your final one. I was trying to convey the issue is the PR as is didn't account f",https://github.com/bitcoin/bitcoin/pull/7220#issuecomment-165301290,165301290,
