[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552584176",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-552584176",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 552584176,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MjU4NDE3Ng==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-11T19:38:18Z",
    "updated_at": "2020-06-05T20:10:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19069 (refactor: replace pointers by references within tx_verify.{h,cpp} by theStack)\n* #18096 (doc: IsFinalTx comment about nSequence & OP_CLTV by nothingmuch)\n* #17484 (wallet: add cached m_is_ibd to remove Chain::isInitialBlockDownload by ariard)\n* #15719 (Wallet passive startup by ryanofsky)\n* #14707 ([RPC] Include coinbase transactions in receivedby RPCs by andrewtoth)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/552584176/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/566816288",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-566816288",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 566816288,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjgxNjI4OA==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-18T00:49:41Z",
    "updated_at": "2019-12-18T00:49:41Z",
    "author_association": "MEMBER",
    "body": "@ryanofsky Thanks for review!\r\n\r\nI went ahead on replaced `checkFinalTx` by `CheckFinalWalletTx` which itself calls `IsFinalTx` by caching median time past in the wallet.\r\n\r\nAbout testing, I think a bit about it, it's quite hard because contrary to the consensus code where finality enforcement is going to change after softfork activation, wallet is always using current finality consensus rules. So that would need to have 2 versions of the wallet. I think that's an issue already known of our current wallet test framework..\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/566816288/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/567153538",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-567153538",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 567153538,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NzE1MzUzOA==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-18T18:28:25Z",
    "updated_at": "2019-12-18T18:28:25Z",
    "author_association": "MEMBER",
    "body": "01377a5\r\n\r\nMoved `IsFinalTx` from `consensus/tx_verify.h` to `consensus/tx_check.h` as it's context-independent and so let wallet code called it without linking against server one. Should fix travis build failure.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/567153538/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570729250",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-570729250",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 570729250,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDcyOTI1MA==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-03T23:32:49Z",
    "updated_at": "2020-01-04T00:30:50Z",
    "author_association": "MEMBER",
    "body": "Updated bbdc8b5, extended both `IsTrusted` declarations with NO_THREAD_SAFETY_ANALYSIS to pass static analysis on macOS and so remove travis failure.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/570729250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627765493",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-627765493",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 627765493,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzc2NTQ5Mw==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-13T06:03:34Z",
    "updated_at": "2020-05-13T06:03:34Z",
    "author_association": "MEMBER",
    "body": "@fjahr @ryanofsky it has been rebased after #16426 merged, they shouldn't have any substantial changes since your last ACK but let me know if you find any issue.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/627765493/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630662766",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-630662766",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 630662766,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDY2Mjc2Ng==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-19T08:16:49Z",
    "updated_at": "2020-05-19T08:16:49Z",
    "author_association": "MEMBER",
    "body": "Thanks @ryanofsky and @jonatack for reviews, took most of your suggestion, specially with better comment for top message commit.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630662766/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630796103",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-630796103",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 630796103,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDc5NjEwMw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-19T12:51:43Z",
    "updated_at": "2020-05-19T12:51:43Z",
    "author_association": "MEMBER",
    "body": "re-almost ACK 808dc17 the changes per `git diff b14e07b 808dc17` look good (thanks!); building locally with Clang is raising as mentioned above.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630796103/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633040289",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-633040289",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 633040289,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzA0MDI4OQ==",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?u=348c27f90b6fff8fd72fa27232272651436a2ff0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-23T12:12:55Z",
    "updated_at": "2020-05-23T12:12:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "I also see the build error locally (I use clang by default). Code looks good but will wait with a full review until the fix is up.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633040289/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/638557606",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-638557606",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 638557606,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzODU1NzYwNg==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-04T02:07:14Z",
    "updated_at": "2020-06-04T02:07:14Z",
    "author_association": "MEMBER",
    "body": "Rebased and updated with fix at d55ba31. Thanks for your patience!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/638557606/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640738686",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#issuecomment-640738686",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17443",
    "id": 640738686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MDczODY4Ng==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-08T16:34:30Z",
    "updated_at": "2020-06-08T16:34:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n\ud83d\udc19 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/640738686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/344854791",
    "pull_request_review_id": 315085918,
    "id": 344854791,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0NDg1NDc5MQ==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate\n+    // flags select which rules would be enforced for the next block.",
    "path": "src/validation.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Here it seems should be either \"Setting-appropriate flags select\" or \"Setting appropriate flags selects\". \r\n\r\nI think it's the latter but it's not clear from the sentence.\r\n\r\nSuggest: s/would/will/",
    "created_at": "2019-11-11T18:47:04Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r344854791",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/344854791"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r344854791"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/344854791/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 197,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/344855824",
    "pull_request_review_id": 315085918,
    "id": 344855824,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0NDg1NTgyNA==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate\n+    // flags select which rules would be enforced for the next block.\n+    // At the present time, only CSV softfork (i.e BIP 113) alter",
    "path": "src/validation.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "s/i.e/i.e./\r\n\r\nIt looks like \"softfork\" should be plural.",
    "created_at": "2019-11-11T18:49:38Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r344855824",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/344855824"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r344855824"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/344855824/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 198,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/358329218",
    "pull_request_review_id": 332692782,
    "id": 358329218,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1ODMyOTIxOA==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate\n+    // flags select which rules would be enforced for the next block.\n+    // At the present time, only CSV softfork (i.e BIP 113) alter\n+    // nBlockTime meaning through LOCKTIME_MEDIAN_TIME_PAST flag.",
    "path": "src/validation.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe drop this sentence about CSV/LOCKTIME_MEDIAN_TIME_PAST. It seems only slightly relevant, and already pretty clear by looking at the code below. This sentence could also become out of date if the code below changes.",
    "created_at": "2019-12-16T16:22:58Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r358329218",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/358329218"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r358329218"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/358329218/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 198,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 199,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/358335066",
    "pull_request_review_id": 332692782,
    "id": 358335066,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1ODMzNTA2Ng==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate",
    "path": "src/validation.cpp",
    "position": 11,
    "original_position": 11,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I understand correcting \"negative value for flags indicates that _the current network-enforced consensus rules_ should be used\" to \"negative value for flags indicates that _no soft-forked consensus rules_ should be used\".\r\n\r\nBut I think the other changes to this comment make it less clear. I'm wondering if something about the following removed section is inaccurate or if it was shortened and rewritten for a different reason:\r\n\r\n> In a future soft-fork scenario that would mean checking which rules would be enforced for the next block and setting the appropriate flags. At the present time no soft-forks are scheduled, so no flags are set.",
    "created_at": "2019-12-16T16:32:53Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r358335066",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/358335066"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r358335066"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/358335066/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 211,
    "original_line": 211,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359105468",
    "pull_request_review_id": 333674536,
    "id": 359105468,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTEwNTQ2OA==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate",
    "path": "src/validation.cpp",
    "position": 11,
    "original_position": 11,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think the comment was written when BIP113 code was merged but no yet activated and scheduled for activation. It's right we don't have soft-forks scheduled now, but it's false there is no flag to set (LOCKTIME_MEDIAN_TIME_PAST)",
    "created_at": "2019-12-18T00:55:46Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359105468",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359105468"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359105468"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359105468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 211,
    "original_line": 211,
    "side": "RIGHT",
    "in_reply_to_id": 358335066
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359502232",
    "pull_request_review_id": 334177086,
    "id": 359502232,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTUwMjIzMg==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate",
    "path": "src/validation.cpp",
    "position": 11,
    "original_position": 11,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359105468\r\n\r\nI don't understand \"it's false there is no flag to set (LOCKTIME_MEDIAN_TIME_PAST).\" since this code isn't setting LOCKTIME_MEDIAN_TIME_PAST, it's setting 0...\r\n\r\nBut more broadly, I don't understand why there would be a reason to keep this code if it isn't going to serve a function in a future soft fork. Why not simplify by making the CheckFinalTx `flags` argument required instead of optional, and dropping `std::max`. and dropping this comment?\r\n\r\n",
    "created_at": "2019-12-18T18:32:25Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359502232",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359502232"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359502232"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359502232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 211,
    "original_line": 211,
    "side": "RIGHT",
    "in_reply_to_id": 358335066
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359507613",
    "pull_request_review_id": 334177086,
    "id": 359507613,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTUwNzYxMw==",
    "diff_hunk": "@@ -3964,6 +3965,27 @@ bool CWalletTx::IsImmatureCoinBase() const\n     return GetBlocksToMaturity() > 0;\n }\n \n+bool CWalletTx::isFinal() const\n+{\n+    return pwallet->CheckFinalWalletTx(*tx);\n+}\n+\n+bool CWallet::CheckFinalWalletTx(const CTransaction& tx) const\n+{\n+    // Wallet not doing historical validation work, it's only\n+    // interested by the nLocktime evaluation as enforced on\n+    // current chain tip (BIP 113). In the future, if there\n+    // is forks changing this, wallet should be updated.\n+\n+    // CheckFinalWalletTx() uses m_last_block_processed_height +1\n+    // to evaluate nLockTime because when IsFinalTx() is called within\n+    // CBlock::AcceptBlock(), the height of the block *being*\n+    // evaluated is what is used. Thus if we want to know if a\n+    // transaction can be part of the *next* block, we need to call\n+    // IsFinalTx() with one more than m_last_block_processed_height.\n+    return IsFinalTx(tx, m_last_block_processed_height + 1, m_last_block_median_time_past);",
    "path": "src/wallet/wallet.cpp",
    "position": 97,
    "original_position": 48,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "0ef43cef24b837367a90c97a31470e0f19f18552",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Replace Chain::checkFinal by CWallet::CheckFinalWalletTx\" (0ef43cef24b837367a90c97a31470e0f19f18552)\r\n\r\nI see this comment is copied from [existing code](https://github.com/bitcoin/bitcoin/blob/6fef85bfa3cd7f76e83b8b57f9e4acd63eb664ec/src/validation.cpp#L200-L205), but the part about this function being called from `CBlock::AcceptBlock` doesn't apply here, right? Would it be ok to drop this long comment and simply write that we are passing  `m_last_block_processed_height + 1` because we are interested to know if the transaction could be included in the next block, not the current tip?",
    "created_at": "2019-12-18T18:44:02Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359507613",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359507613"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359507613"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359507613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 4156,
    "original_start_line": 3980,
    "start_side": "RIGHT",
    "line": 4162,
    "original_line": 4162,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359635222",
    "pull_request_review_id": 334346173,
    "id": 359635222,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTYzNTIyMg==",
    "diff_hunk": "@@ -192,12 +192,11 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n {\n     AssertLockHeld(cs_main);\n \n-    // By convention a negative value for flags indicates that the\n-    // current network-enforced consensus rules should be used. In\n-    // a future soft-fork scenario that would mean checking which\n-    // rules would be enforced for the next block and setting the\n-    // appropriate flags. At the present time no soft-forks are\n-    // scheduled, so no flags are set.\n+    // By convention a negative value for flags indicates that no\n+    // soft-forked consensus rules should be used. Setting appropriate",
    "path": "src/validation.cpp",
    "position": 11,
    "original_position": 11,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "c9609737208a238984717d16e13f770ea350bb95",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "CheckFinalTx is called with STANDARD_LOCKTIME_VERIFY_FLAGS in `PreChecks` and `removeForReorg`. Given it's only mempool I think you'e right, you can hardcode that you always want to use the most recent consensus rules but I would prefer to do that as a follow-up to avoid missing something.",
    "created_at": "2019-12-19T00:25:32Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359635222",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359635222"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359635222"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359635222/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 211,
    "original_line": 211,
    "side": "RIGHT",
    "in_reply_to_id": 358335066
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359636084",
    "pull_request_review_id": 334347246,
    "id": 359636084,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1OTYzNjA4NA==",
    "diff_hunk": "@@ -3964,6 +3965,27 @@ bool CWalletTx::IsImmatureCoinBase() const\n     return GetBlocksToMaturity() > 0;\n }\n \n+bool CWalletTx::isFinal() const\n+{\n+    return pwallet->CheckFinalWalletTx(*tx);\n+}\n+\n+bool CWallet::CheckFinalWalletTx(const CTransaction& tx) const\n+{\n+    // Wallet not doing historical validation work, it's only\n+    // interested by the nLocktime evaluation as enforced on\n+    // current chain tip (BIP 113). In the future, if there\n+    // is forks changing this, wallet should be updated.\n+\n+    // CheckFinalWalletTx() uses m_last_block_processed_height +1\n+    // to evaluate nLockTime because when IsFinalTx() is called within\n+    // CBlock::AcceptBlock(), the height of the block *being*\n+    // evaluated is what is used. Thus if we want to know if a\n+    // transaction can be part of the *next* block, we need to call\n+    // IsFinalTx() with one more than m_last_block_processed_height.\n+    return IsFinalTx(tx, m_last_block_processed_height + 1, m_last_block_median_time_past);",
    "path": "src/wallet/wallet.cpp",
    "position": 97,
    "original_position": 48,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "0ef43cef24b837367a90c97a31470e0f19f18552",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The comment is about that we want to call `IsFinalTx` the same way it's called in `AcceptBlock`, i.e with `nBlockHeight` set to tip+1 to evaluate the consensus rule identically in both wallet and node. You don't want discrepancies between them. I think the last sentence is expressing that \"if a transaction can be part of the *next* block\", and speaking of `m_last_block_processed_height` is verbose but at least you avoid confusion between wallet tip and node tip.\r\n",
    "created_at": "2019-12-19T00:29:18Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359636084",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359636084"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r359636084"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/359636084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 4156,
    "original_start_line": 3980,
    "start_side": "RIGHT",
    "line": 4162,
    "original_line": 4162,
    "side": "RIGHT",
    "in_reply_to_id": 359507613
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/364474972",
    "pull_request_review_id": 340186421,
    "id": 364474972,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NDQ3NDk3Mg==",
    "diff_hunk": "@@ -477,8 +477,8 @@ class CWalletTx\n     bool IsEquivalentTo(const CWalletTx& tx) const;\n \n     bool InMempool() const;\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const NO_THREAD_SAFETY_ANALYSIS;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const NO_THREAD_SAFETY_ANALYSIS;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "1f479751b2eaf6f17ae76334b72ebc5fd76d8956",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Replace Chain::checkFinal by CWallet::CheckFinalWalletTx\" (1f479751b2eaf6f17ae76334b72ebc5fd76d8956)\r\n\r\nI think it'd be safer to just add `AssertLockHeld` statements if the compiler can't determine that a particular lock is held, than to disable safety analysis altogether. On my system, the following changes seem to work:\r\n\r\n```diff\r\ndiff --git a/src/wallet/wallet.cpp b/src/wallet/wallet.cpp\r\nindex 9d291f0b585..c702f90681d 100644\r\n--- a/src/wallet/wallet.cpp\r\n+++ b/src/wallet/wallet.cpp\r\n@@ -1882,6 +1882,7 @@ bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\r\n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const\r\n {\r\n     // Quick answer in most cases\r\n+    AssertLockHeld(pwallet->cs_wallet);\r\n     if (!pwallet->CheckFinalWalletTx(*tx)) return false;\r\n     int nDepth = GetDepthInMainChain();\r\n     if (nDepth >= 1) return true;\r\n@@ -3967,6 +3968,7 @@ bool CWalletTx::IsImmatureCoinBase() const\r\n \r\n bool CWalletTx::isFinal() const\r\n {\r\n+    AssertLockHeld(pwallet->cs_wallet);\r\n     return pwallet->CheckFinalWalletTx(*tx);\r\n }\r\n \r\ndiff --git a/src/wallet/wallet.h b/src/wallet/wallet.h\r\nindex acf0de45f1c..4ae39ba328a 100644\r\n--- a/src/wallet/wallet.h\r\n+++ b/src/wallet/wallet.h\r\n@@ -477,8 +477,8 @@ public:\r\n     bool IsEquivalentTo(const CWalletTx& tx) const;\r\n \r\n     bool InMempool() const;\r\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const NO_THREAD_SAFETY_ANALYSIS;\r\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const NO_THREAD_SAFETY_ANALYSIS;\r\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\r\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;\r\n \r\n     int64_t GetTxTime() const;\r\n \r\n@@ -531,7 +531,7 @@ public:\r\n     const uint256& GetHash() const { return tx->GetHash(); }\r\n     bool IsCoinBase() const { return tx->IsCoinBase(); }\r\n     bool IsImmatureCoinBase() const;\r\n-    bool isFinal() const NO_THREAD_SAFETY_ANALYSIS;\r\n+    bool isFinal() const;\r\n };\r\n \r\n class COutput\r\n```\r\n\r\n\r\n\r\n6e10c40e9507c2ff45d47ca863778fff85584b36",
    "created_at": "2020-01-08T22:28:26Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r364474972",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/364474972"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r364474972"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/364474972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 480,
    "start_side": "LEFT",
    "line": null,
    "original_line": 497,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367693585",
    "pull_request_review_id": 344272652,
    "id": 367693585,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzY5MzU4NQ==",
    "diff_hunk": "@@ -477,8 +477,8 @@ class CWalletTx\n     bool IsEquivalentTo(const CWalletTx& tx) const;\n \n     bool InMempool() const;\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const NO_THREAD_SAFETY_ANALYSIS;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const NO_THREAD_SAFETY_ANALYSIS;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "1f479751b2eaf6f17ae76334b72ebc5fd76d8956",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Did you test on a Linux ? IIRC clang static analysis only work on MacOS. `AssertLockHeld` is lock checking at runtime",
    "created_at": "2020-01-16T22:59:48Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r367693585",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367693585"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r367693585"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367693585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 480,
    "start_side": "LEFT",
    "line": null,
    "original_line": 497,
    "side": "RIGHT",
    "in_reply_to_id": 364474972
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367700050",
    "pull_request_review_id": 344280851,
    "id": 367700050,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2NzcwMDA1MA==",
    "diff_hunk": "@@ -477,8 +477,8 @@ class CWalletTx\n     bool IsEquivalentTo(const CWalletTx& tx) const;\n \n     bool InMempool() const;\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const NO_THREAD_SAFETY_ANALYSIS;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const NO_THREAD_SAFETY_ANALYSIS;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "1f479751b2eaf6f17ae76334b72ebc5fd76d8956",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> Did you test on a Linux ? IIRC clang static analysis only work on MacOS. `AssertLockHeld` is lock checking at runtime\r\n\r\nAssertLockHeld does affect static analysis, because it sets the `assert_exclusive_lock` attribute, see https://clang.llvm.org/docs/ThreadSafetyAnalysis.html. I am testing on linux, and I am using clang and have static analysis enabled. The following change works fine for me with the asserts added, so still think NO_THREAD_SAFETY_ANALYSIS annotations are unneeded.\r\n\r\n```diff\r\n--- a/src/wallet/wallet.h\r\n+++ b/src/wallet/wallet.h\r\n@@ -481,12 +481,12 @@ public:\r\n     // annotation \"EXCLUSIVE_LOCKS_REQUIRED(pwallet->cs_wallet)\". The\r\n     // annotation \"NO_THREAD_SAFETY_ANALYSIS\" was temporarily added to avoid\r\n     // having to resolve the issue of member access into incomplete type CWallet.\r\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const NO_THREAD_SAFETY_ANALYSIS;\r\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\r\n     // TODO: Remove \"NO_THREAD_SAFETY_ANALYSIS\" and replace it with the correct\r\n     // annotation \"EXCLUSIVE_LOCKS_REQUIRED(pwallet->cs_wallet)\". The\r\n     // annotation \"NO_THREAD_SAFETY_ANALYSIS\" was temporarily added to avoid\r\n     // having to resolve the issue of member access into incomplete type CWallet.\r\n-    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const NO_THREAD_SAFETY_ANALYSIS;\r\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;\r\n \r\n     int64_t GetTxTime() const;\r\n \r\n@@ -543,7 +543,7 @@ public:\r\n     // annotation \"EXCLUSIVE_LOCKS_REQUIRED(pwallet->cs_wallet)\". The\r\n     // annotation \"NO_THREAD_SAFETY_ANALYSIS\" was temporarily added to avoid\r\n     // having to resolve the issue of member access into incomplete type CWallet.\r\n-    bool isFinal() const NO_THREAD_SAFETY_ANALYSIS;\r\n+    bool isFinal() const;\r\n };\r\n```",
    "created_at": "2020-01-16T23:21:20Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r367700050",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367700050"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r367700050"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/367700050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 480,
    "start_side": "LEFT",
    "line": null,
    "original_line": 497,
    "side": "RIGHT",
    "in_reply_to_id": 364474972
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368250007",
    "pull_request_review_id": 344963927,
    "id": 368250007,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2ODI1MDAwNw==",
    "diff_hunk": "@@ -3960,6 +3967,29 @@ bool CWalletTx::IsImmatureCoinBase() const\n     return GetBlocksToMaturity() > 0;\n }\n \n+bool CWalletTx::isFinal() const\n+{\n+    AssertLockHeld(pwallet->cs_wallet);\n+    return pwallet->CheckFinalWalletTx(*tx);\n+}\n+\n+bool CWallet::CheckFinalWalletTx(const CTransaction& tx) const\n+{\n+    AssertLockHeld(cs_wallet);\n+    // Wallet not doing historical validation work, it's only",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 94,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "9afb8ddd1d9406a623d209bc5a4a5e955f0b806c",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: some grammar improvement on this paragraph\r\n\r\n```\r\n    // The wallet is not doing historical validation work, it's only\r\n    // interested in the nLocktime evaluation as enforced on\r\n    // the current chain tip (BIP 113). If there are forks changing\r\n    // this in the future, the wallet should be updated.\r\n```",
    "created_at": "2020-01-18T21:39:14Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r368250007",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368250007"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r368250007"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/368250007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4145,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372640391",
    "pull_request_review_id": 350437766,
    "id": 372640391,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MjY0MDM5MQ==",
    "diff_hunk": "@@ -3960,6 +3967,29 @@ bool CWalletTx::IsImmatureCoinBase() const\n     return GetBlocksToMaturity() > 0;\n }\n \n+bool CWalletTx::isFinal() const\n+{\n+    AssertLockHeld(pwallet->cs_wallet);\n+    return pwallet->CheckFinalWalletTx(*tx);\n+}\n+\n+bool CWallet::CheckFinalWalletTx(const CTransaction& tx) const\n+{\n+    AssertLockHeld(cs_wallet);\n+    // Wallet not doing historical validation work, it's only",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 94,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "9afb8ddd1d9406a623d209bc5a4a5e955f0b806c",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks for review, will take them if I have to update PR!",
    "created_at": "2020-01-29T21:30:18Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r372640391",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372640391"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r372640391"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/372640391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4145,
    "side": "RIGHT",
    "in_reply_to_id": 368250007
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424696041",
    "pull_request_review_id": 411254577,
    "id": 424696041,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNDY5NjA0MQ==",
    "diff_hunk": "@@ -3924,12 +3926,16 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     }\n \n     const Optional<int> tip_height = chain.getHeight();\n+    int64_t mtp_time;\n     if (tip_height) {\n         walletInstance->m_last_block_processed = chain.getBlockHash(*tip_height);\n         walletInstance->m_last_block_processed_height = *tip_height;\n+        chain.findBlock(walletInstance->GetLastBlockHash(), FoundBlock().mtpTime(mtp_time));",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "46744a2998ee196bd366b49fa14036ab7acec30b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Add m_last_block_mediam_time_past in CWallet\" (46744a2998ee196bd366b49fa14036ab7acec30b)\r\n\r\nWould seem better to handle failure, drop temporary variable, and use m_last_block_processed consistently here:\r\n\r\n```c++\r\nCHECK_NONFATAL(chain.findBlock(walletInstance->m_last_block_processed, FoundBlock().mtpTime(walletInstance->m_last_block_median_time_past)));\r\n``` ",
    "created_at": "2020-05-13T19:58:56Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r424696041",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424696041"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r424696041"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/424696041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3933,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425634319",
    "pull_request_review_id": 412431850,
    "id": 425634319,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTYzNDMxOQ==",
    "diff_hunk": "@@ -56,3 +56,16 @@ bool CheckTransaction(const CTransaction& tx, TxValidationState& state)\n \n     return true;\n }\n+\n+bool IsFinalTx(const CTransaction &tx, int nBlockHeight, int64_t nBlockTime)",
    "path": "src/consensus/tx_check.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "b14e07b227f3830120e97f44b3d6ece55bf700c6",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "a20187d suggestion while moving this code \r\n```diff\r\n-bool IsFinalTx(const CTransaction &tx, int nBlockHeight, int64_t nBlockTime)\r\n+bool IsFinalTx(const CTransaction& tx, int nBlockHeight, int64_t nBlockTime)\r\n```\r\n",
    "created_at": "2020-05-15T08:04:57Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425634319",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425634319"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425634319"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425634319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 60,
    "original_line": 60,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425640362",
    "pull_request_review_id": 412431850,
    "id": 425640362,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY0MDM2Mg==",
    "diff_hunk": "@@ -3924,12 +3926,16 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     }\n \n     const Optional<int> tip_height = chain.getHeight();\n+    int64_t mtp_time;\n     if (tip_height) {\n         walletInstance->m_last_block_processed = chain.getBlockHash(*tip_height);\n         walletInstance->m_last_block_processed_height = *tip_height;\n+        chain.findBlock(walletInstance->GetLastBlockHash(), FoundBlock().mtpTime(mtp_time));",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "46744a2998ee196bd366b49fa14036ab7acec30b",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "46744a2 I agree with @ryanofsky's suggestion above.\r\n\r\nIf you do keep the tempvar, please move it to the local scope where it is used:\r\n```diff\r\n-    int64_t mtp_time;\r\n     if (tip_height) {\r\n         walletInstance->m_last_block_processed = chain.getBlockHash(*tip_height);\r\n         walletInstance->m_last_block_processed_height = *tip_height;\r\n+        int64_t mtp_time;\r\n```",
    "created_at": "2020-05-15T08:16:59Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425640362",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425640362"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425640362"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425640362/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3933,
    "side": "RIGHT",
    "in_reply_to_id": 424696041
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425656746",
    "pull_request_review_id": 412431850,
    "id": 425656746,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY1Njc0Ng==",
    "diff_hunk": "@@ -555,6 +555,11 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    // TODO: Remove \"NO_THREAD_SAFETY_ANALYSIS\" and replace it with the correct\n+    // annotation \"EXCLUSIVE_LOCKS_REQUIRED(pwallet->cs_wallet)\". The\n+    // annotation \"NO_THREAD_SAFETY_ANALYSIS\" was temporarily added to avoid\n+    // having to resolve the issue of member access into incomplete type CWallet.",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "b14e07b227f3830120e97f44b3d6ece55bf700c6",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "36ab1db7 Why not resolve the issue and get rid of this (and the TODO), rather than taking on technical debt?",
    "created_at": "2020-05-15T08:47:06Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425656746",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425656746"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425656746"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425656746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 561,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425662971",
    "pull_request_review_id": 412431850,
    "id": 425662971,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY2Mjk3MQ==",
    "diff_hunk": "@@ -3960,6 +3967,29 @@ bool CWalletTx::IsImmatureCoinBase() const\n     return GetBlocksToMaturity() > 0;\n }\n \n+bool CWalletTx::isFinal() const\n+{\n+    AssertLockHeld(pwallet->cs_wallet);\n+    return pwallet->CheckFinalWalletTx(*tx);\n+}\n+\n+bool CWallet::CheckFinalWalletTx(const CTransaction& tx) const\n+{\n+    AssertLockHeld(cs_wallet);\n+    // Wallet not doing historical validation work, it's only",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 94,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "9afb8ddd1d9406a623d209bc5a4a5e955f0b806c",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It would be good to fix this. I started rewriting it as well before seeing @fjahr's suggestion. It's costing multiple reviewers time already (and future readers trying to parse it) when it could be fixed easily.",
    "created_at": "2020-05-15T08:58:26Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425662971",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425662971"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425662971"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425662971/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4145,
    "side": "RIGHT",
    "in_reply_to_id": 368250007
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425671493",
    "pull_request_review_id": 412431850,
    "id": 425671493,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTY3MTQ5Mw==",
    "diff_hunk": "@@ -1041,7 +1041,7 @@ static UniValue ListReceived(const CWallet* const pwallet, const UniValue& param\n     for (const std::pair<const uint256, CWalletTx>& pairWtx : pwallet->mapWallet) {\n         const CWalletTx& wtx = pairWtx.second;\n \n-        if (wtx.IsCoinBase() || !pwallet->chain().checkFinalTx(*wtx.tx)) {\n+        if (wtx.IsCoinBase() || !wtx.isFinal()) {",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "b14e07b227f3830120e97f44b3d6ece55bf700c6",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nice improvement here!",
    "created_at": "2020-05-15T09:13:37Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425671493",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425671493"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r425671493"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425671493/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1044,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427112533",
    "pull_request_review_id": 414205009,
    "id": 427112533,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzExMjUzMw==",
    "diff_hunk": "@@ -3924,12 +3926,16 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     }\n \n     const Optional<int> tip_height = chain.getHeight();\n+    int64_t mtp_time;\n     if (tip_height) {\n         walletInstance->m_last_block_processed = chain.getBlockHash(*tip_height);\n         walletInstance->m_last_block_processed_height = *tip_height;\n+        chain.findBlock(walletInstance->GetLastBlockHash(), FoundBlock().mtpTime(mtp_time));",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "46744a2998ee196bd366b49fa14036ab7acec30b",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Solved, note I don't think using `m_last_block_processed` or `GetBlockHash` changes something on the consistency level but did so for code clarity",
    "created_at": "2020-05-19T08:14:01Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427112533",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427112533"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427112533"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427112533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3933,
    "side": "RIGHT",
    "in_reply_to_id": 424696041
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427113087",
    "pull_request_review_id": 414205709,
    "id": 427113087,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzExMzA4Nw==",
    "diff_hunk": "@@ -555,6 +555,11 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    // TODO: Remove \"NO_THREAD_SAFETY_ANALYSIS\" and replace it with the correct\n+    // annotation \"EXCLUSIVE_LOCKS_REQUIRED(pwallet->cs_wallet)\". The\n+    // annotation \"NO_THREAD_SAFETY_ANALYSIS\" was temporarily added to avoid\n+    // having to resolve the issue of member access into incomplete type CWallet.",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "b14e07b227f3830120e97f44b3d6ece55bf700c6",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes thanks for the call, in fact issue was solved since. Removed.",
    "created_at": "2020-05-19T08:14:54Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427113087",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427113087"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427113087"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427113087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 561,
    "side": "RIGHT",
    "in_reply_to_id": 425656746
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427113212",
    "pull_request_review_id": 414205839,
    "id": 427113212,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzExMzIxMg==",
    "diff_hunk": "@@ -3960,6 +3967,29 @@ bool CWalletTx::IsImmatureCoinBase() const\n     return GetBlocksToMaturity() > 0;\n }\n \n+bool CWalletTx::isFinal() const\n+{\n+    AssertLockHeld(pwallet->cs_wallet);\n+    return pwallet->CheckFinalWalletTx(*tx);\n+}\n+\n+bool CWallet::CheckFinalWalletTx(const CTransaction& tx) const\n+{\n+    AssertLockHeld(cs_wallet);\n+    // Wallet not doing historical validation work, it's only",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 94,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "9afb8ddd1d9406a623d209bc5a4a5e955f0b806c",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, took comment.",
    "created_at": "2020-05-19T08:15:06Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427113212",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427113212"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427113212"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427113212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4145,
    "side": "RIGHT",
    "in_reply_to_id": 368250007
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427249004",
    "pull_request_review_id": 414376547,
    "id": 427249004,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI0OTAwNA==",
    "diff_hunk": "@@ -555,6 +555,7 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 4,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "03870881969b12d8023716897ff674ec6ec3568e",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"[wallet] Replace Chain::checkFinal by CWallet::CheckFinalWalletTx\" (03870881969b12d8023716897ff674ec6ec3568e)\r\n\r\nTravis error here:\r\n\r\n```\r\nIn file included from interfaces/wallet.cpp:24:\r\n./wallet/wallet.h:558:51: error: use of undeclared identifier 'cs_wallet'; did you mean 'pwallet'?\r\n    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);\r\n                                                  ^~~~~~~~~\r\n                                                  pwallet\r\n./threadsafety.h:31:79: note: expanded from macro 'EXCLUSIVE_LOCKS_REQUIRED'\r\n#define EXCLUSIVE_LOCKS_REQUIRED(...) __attribute__((exclusive_locks_required(__VA_ARGS__)))\r\n                                                                              ^\r\n./wallet/wallet.h:272:20: note: 'pwallet' declared here\r\n    const CWallet* pwallet;\r\n```\r\n\r\nhttps://travis-ci.org/github/bitcoin/bitcoin/jobs/688716547#L3380\r\n\r\nProbably needs to say `pwallet->cs_wallet` not just `cs_wallet`\r\n\r\nI wonder @ariard if you're able to test lock annotations locally since these errors seem to come up a lot. It shouldn't be hard to enable them. I just configure with `./configure CXX=clang++ --enable-debug --enable-werror` for these",
    "created_at": "2020-05-19T12:05:30Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427249004",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427249004"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427249004"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427249004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 558,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427266096",
    "pull_request_review_id": 414398164,
    "id": 427266096,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI2NjA5Ng==",
    "diff_hunk": "@@ -555,6 +555,7 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 4,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "03870881969b12d8023716897ff674ec6ec3568e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seeing the same messages while building locally, the gcc 8.3 build is fine but the clang 6.0 debug/werror build errors.",
    "created_at": "2020-05-19T12:34:47Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427266096",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427266096"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427266096"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427266096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 558,
    "side": "RIGHT",
    "in_reply_to_id": 427249004
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427274230",
    "pull_request_review_id": 414408532,
    "id": 427274230,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzI3NDIzMA==",
    "diff_hunk": "@@ -555,6 +555,7 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 4,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "03870881969b12d8023716897ff674ec6ec3568e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Building with `pwallet->cs_wallet` halts with\r\n```\r\n./wallet/wallet.h:558:58: error: member access into incomplete type 'const CWallet'\r\n    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(pwallet->cs_wallet);\r\n                                                         ^\r\n./wallet/fees.h:13:7: note: forward declaration of 'CWallet'\r\nclass CWallet;\r\n      ^\r\n```",
    "created_at": "2020-05-19T12:47:49Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427274230",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427274230"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427274230"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427274230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 558,
    "side": "RIGHT",
    "in_reply_to_id": 427249004
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427640395",
    "pull_request_review_id": 414872655,
    "id": 427640395,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzY0MDM5NQ==",
    "diff_hunk": "@@ -555,6 +555,7 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 4,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "03870881969b12d8023716897ff674ec6ec3568e",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@jonatack @ryanofsky You right I didn't the warning at first, was compiling with gcc locally. Okay in fact the issue hasn't been solved wrt to `NO_THREAD_SAFETY_ANALYSIS`. \r\n\r\nIsn't the way to solve it cleanly would be to get `CWalletTx` its own lock instead of requiring `CWallet` one ? I don't see a better way to solve dependency declaration..",
    "created_at": "2020-05-19T22:39:44Z",
    "updated_at": "2020-06-04T02:06:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427640395",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427640395"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r427640395"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427640395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 558,
    "side": "RIGHT",
    "in_reply_to_id": 427249004
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/434951570",
    "pull_request_review_id": 424052794,
    "id": 434951570,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzNDk1MTU3MA==",
    "diff_hunk": "@@ -555,6 +555,7 @@ class CWalletTx\n     // wrong copy.\n     CWalletTx(CWalletTx const &) = delete;\n     void operator=(CWalletTx const &x) = delete;\n+    bool isFinal() const EXCLUSIVE_LOCKS_REQUIRED(cs_wallet);",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 4,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "03870881969b12d8023716897ff674ec6ec3568e",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Updated dropping `isFinal` accessor on the advice of @ryanofsky ",
    "created_at": "2020-06-04T02:06:31Z",
    "updated_at": "2020-06-04T02:06:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r434951570",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/434951570"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r434951570"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/434951570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 558,
    "side": "RIGHT",
    "in_reply_to_id": 427249004
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439173261",
    "pull_request_review_id": 429421317,
    "id": 439173261,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzOTE3MzI2MQ==",
    "diff_hunk": "@@ -3941,9 +3943,11 @@ std::shared_ptr<CWallet> CWallet::CreateWalletFromFile(interfaces::Chain& chain,\n     if (tip_height) {\n         walletInstance->m_last_block_processed = chain.getBlockHash(*tip_height);\n         walletInstance->m_last_block_processed_height = *tip_height;\n+        chain.findBlock(walletInstance->m_last_block_processed, FoundBlock().mtpTime(walletInstance->m_last_block_median_time_past));",
    "path": "src/wallet/wallet.cpp",
    "position": 71,
    "original_position": 36,
    "commit_id": "d55ba31ddd0f755db763db600413b2ce31a5466c",
    "original_commit_id": "1d2345b31f638cfd1f581a4cf67d3a5624e4d036",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"[wallet] Add m_last_block_mediam_time_past in CWallet\" (1d2345b31f638cfd1f581a4cf67d3a5624e4d036)\r\n\r\nSuggest using CHECK_NONFATAL(chain.findBlock...) to catch a failure early if chain.findBlock returns not found for some reason",
    "created_at": "2020-06-12T02:25:23Z",
    "updated_at": "2020-06-12T14:52:54Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r439173261",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439173261"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17443#discussion_r439173261"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17443"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/439173261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3949,
    "original_line": 3946,
    "side": "RIGHT"
  }
]