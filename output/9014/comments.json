[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256128799",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-256128799",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 256128799,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjEyODc5OQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-25T18:30:39Z",
    "updated_at": "2016-10-25T18:30:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "OK, ended up rewriting the PR quite a bit, cleaning it up and resolving the nits folks had raised - it now no longer has this crazy map thing that can be used as both a paramter and a return value.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256128799/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256149859",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-256149859",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 256149859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjE0OTg1OQ==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-25T19:26:37Z",
    "updated_at": "2016-10-25T19:26:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "re-utack, much cleaner!\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256149859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256386778",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-256386778",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 256386778,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1NjM4Njc3OA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-26T15:40:25Z",
    "updated_at": "2016-10-26T17:21:54Z",
    "author_association": "MEMBER",
    "body": "Before headers first, reorgs were dealt with by accumulating the changes in\nanother cache level, which was only flushed if the reorg succeeded.\n\nNow there is much less a concept of reorgs, and only attempts to improve\nthe tip. ABC finds what block we want and like to be the tip, and calls\nABCS to make progress towards that. In case of failure, we find what other\nblock we'd like to become the tip (which may be the previous one), and make\nprogress towards that. cs_main is only released once we're in a strictly\nbetter state than what we started off in, as otherwise you'd briefly expose\nthe forking point to GBT during a reorg.\n\nEDIT: see https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85174751 - I don't think there is an issue for this PR.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/256386778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/258983475",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-258983475",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 258983475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODk4MzQ3NQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-07T22:26:44Z",
    "updated_at": "2016-11-07T22:26:44Z",
    "author_association": "MEMBER",
    "body": "Needs rebase.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/258983475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/258988616",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-258988616",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 258988616,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODk4ODYxNg==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-07T22:48:59Z",
    "updated_at": "2016-11-07T22:48:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/258988616/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259008367",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-259008367",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 259008367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTAwODM2Nw==",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?u=a0e0040aacd7d4f0787481e8ac30b494fa429e11&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-08T00:29:39Z",
    "updated_at": "2016-11-08T00:29:54Z",
    "author_association": "MEMBER",
    "body": "Travis failures:\n\n```\n  CXX      libbitcoin_server_a-rest.o\n../../src/main.cpp: In function \u2018bool ProcessMessage(CNode*, std::string, CDataStream&, int64_t, const CChainParams&, CConnman&)\u2019:\n../../src/main.cpp:6094:52: error: \u2018block\u2019 was not declared in this scope\n             forceProcessing |= MarkBlockAsReceived(block.GetHash());\n```\n\n```\n  CXX      libbitcoin_server_a-torcontrol.o\n../../src/main.cpp: In function \u2018bool ProcessMessage(CNode*, std::string, CDataStream&, int64_t, const CChainParams&, CConnman&)\u2019:\n../../src/main.cpp:6094:52: error: \u2018block\u2019 was not declared in this scope\n             forceProcessing |= MarkBlockAsReceived(block.GetHash());\n```\n\n```\n../../src/main.cpp: In function \u2018bool ProcessMessage(CNode*, std::string, CDataStream&, int64_t, const CChainParams&, CConnman&)\u2019:\n../../src/main.cpp:6094:52: error: \u2018block\u2019 was not declared in this scope\n             forceProcessing |= MarkBlockAsReceived(block.GetHash());\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259008367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259063259",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-259063259",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 259063259,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTA2MzI1OQ==",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-08T07:14:01Z",
    "updated_at": "2016-11-08T07:14:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looks like this is not rebased correctly - GH shows 5 conflicting files (and they match my own tests).\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259063259/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259310666",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-259310666",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 259310666,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1OTMxMDY2Ng==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-09T01:19:27Z",
    "updated_at": "2016-11-09T01:19:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "It just needs rebased again, closing for now and will rebase on top of #9075 after that gets merged.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/259310666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261402967",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-261402967",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 261402967,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTQwMjk2Nw==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-17T23:28:13Z",
    "updated_at": "2016-11-17T23:28:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased on  #9075.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/261402967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/262133519",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-262133519",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 262133519,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjEzMzUxOQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-22T02:51:41Z",
    "updated_at": "2016-11-22T02:51:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased after #9125 was merged. Note that #9125 should have fixed most of the performance regression here (and was likely the source of its major reorg speedup, though it should help in more real-world conditions as well), though this should still help some, and is a good step towards #9027 as well as improving callback concurrency in the future.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/262133519/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/262843945",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-262843945",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 262843945,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2Mjg0Mzk0NQ==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-24T20:59:01Z",
    "updated_at": "2016-11-24T20:59:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/262843945/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/263457490",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-263457490",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 263457490,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzQ1NzQ5MA==",
    "user": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-29T02:21:17Z",
    "updated_at": "2016-11-29T02:21:17Z",
    "author_association": "MEMBER",
    "body": "Code review ACK, will test.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/263457490/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/263722051",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-263722051",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 263722051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MzcyMjA1MQ==",
    "user": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-29T22:33:31Z",
    "updated_at": "2016-11-29T22:33:31Z",
    "author_association": "MEMBER",
    "body": "ACK 7b717cd",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/263722051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/264690796",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#issuecomment-264690796",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9014",
    "id": 264690796,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NDY5MDc5Ng==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-04T08:21:02Z",
    "updated_at": "2016-12-04T08:21:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased after #9260.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/264690796/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84932213",
    "pull_request_review_id": 5678302,
    "id": 84932213,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTMyMjEz",
    "diff_hunk": "@@ -2799,20 +2799,40 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+struct CompareBlockIndexByWork {\n+    bool operator()(const CBlockIndex* a, const CBlockIndex* b) const {\n+        return a->nChainWork < b->nChainWork;",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Don't you need a fallback for when the chainwork is identical?\n",
    "created_at": "2016-10-25T15:35:52Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84932213",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84932213"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84932213"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84932213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2804,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84941470",
    "pull_request_review_id": 5686996,
    "id": 84941470,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQxNDcw",
    "diff_hunk": "@@ -2799,20 +2799,40 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+struct CompareBlockIndexByWork {\n+    bool operator()(const CBlockIndex* a, const CBlockIndex* b) const {\n+        return a->nChainWork < b->nChainWork;\n+    }\n+};\n+\n+// Used in ActivateBestChain/ConnectBlock to keep track of blocks connected\n+// and notify listeners in the right order.\n+// Note that since mapBlocks is sorted lowest-work to highest-work, iterating\n+// over it will give you the order in which the blocks were connected\n+struct BlockConnectTrace {\n+    std::map<CBlockIndex*, std::shared_ptr<const CBlock>, CompareBlockIndexByWork> mapBlocks;\n+};\n+\n /**\n- * Connect a new block to chainActive. pblock is either NULL or a pointer to a CBlock\n- * corresponding to pindexNew, to bypass loading it again from disk.\n+ * Connect a new block to chainActive.\n+ * If a shared_ptr to the block for pindexNew already exists in blockTrace.mapBlocks,\n+ * we will bypass re-loading the block from disk.\n  */\n-bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const CBlock* pblock, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, std::vector<std::tuple<CTransaction,CBlockIndex*,int>> &txChanged)\n+bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, BlockConnectTrace& blockTrace)\n {\n     assert(pindexNew->pprev == chainActive.Tip());\n     // Read block from disk.\n     int64_t nTime1 = GetTimeMicros();\n-    CBlock block;\n-    if (!pblock) {\n-        if (!ReadBlockFromDisk(block, pindexNew, chainparams.GetConsensus()))\n+    const CBlock *pblock;\n+    auto it = blockTrace.mapBlocks.find(pindexNew);\n+    if (it == blockTrace.mapBlocks.end()) {\n+        CBlock *pblockNew = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 37,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: maybe do this as\n\n```\nit = blockTrace.mapBlocks.emplace(pindexNew, std::shared_ptr<const CBlock>(new CBlock())).first;\n```\n\nOr\n\n```\nauto pblockNew = std::make_shared<CBlock>();\n```\n\nand update following code accordingly\n",
    "created_at": "2016-10-25T16:15:57Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84941470",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84941470"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84941470"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84941470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2829,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84941702",
    "pull_request_review_id": 5687211,
    "id": 84941702,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQxNzAy",
    "diff_hunk": "@@ -2799,20 +2799,40 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+struct CompareBlockIndexByWork {\n+    bool operator()(const CBlockIndex* a, const CBlockIndex* b) const {\n+        return a->nChainWork < b->nChainWork;",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Since its only used in each ActivateBestChainStep call individually, there is only ever one thing per given height/total work, but the map came out of an older version of the code and is now useless...so I'm replacing it with a vector.\n",
    "created_at": "2016-10-25T16:16:57Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84941702",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84941702"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84941702"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84941702/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2804,
    "side": "RIGHT",
    "in_reply_to_id": 84932213
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948521",
    "pull_request_review_id": 5686996,
    "id": 84948521,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQ4NTIx",
    "diff_hunk": "@@ -6023,23 +6050,24 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n \n     else if (strCommand == NetMsgType::BLOCK && !fImporting && !fReindex) // Ignore blocks received while importing\n     {\n-        CBlock block;\n-        vRecv >> block;\n+        CBlock *pblock = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 181,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "See other comment about using make_shared\n",
    "created_at": "2016-10-25T16:50:35Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948521",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948521"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948521"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 6053,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948692",
    "pull_request_review_id": 5686996,
    "id": 84948692,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQ4Njky",
    "diff_hunk": "@@ -132,7 +132,8 @@ UniValue generateBlocks(boost::shared_ptr<CReserveScript> coinbaseScript, int nG\n             continue;\n         }\n         CValidationState state;\n-        if (!ProcessNewBlock(state, Params(), NULL, pblock, true, NULL))\n+        std::shared_ptr<const CBlock> shared_pblock(new CBlock(*pblock));",
    "path": "src/rpc/mining.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "make_shared\n",
    "created_at": "2016-10-25T16:51:24Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948692",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948692"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948692"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 135,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948777",
    "pull_request_review_id": 5686996,
    "id": 84948777,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQ4Nzc3",
    "diff_hunk": "@@ -726,7 +727,9 @@ UniValue submitblock(const JSONRPCRequest& request)\n             + HelpExampleRpc(\"submitblock\", \"\\\"mydata\\\"\")\n         );\n \n-    CBlock block;\n+    CBlock* blockptr = new CBlock();",
    "path": "src/rpc/mining.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "make_shared\n",
    "created_at": "2016-10-25T16:51:53Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948777",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948777"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948777"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948777/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 730,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948818",
    "pull_request_review_id": 5686996,
    "id": 84948818,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQ4ODE4",
    "diff_hunk": "@@ -223,7 +223,8 @@ BOOST_AUTO_TEST_CASE(CreateNewBlock_validity)\n         pblock->hashMerkleRoot = BlockMerkleRoot(*pblock);\n         pblock->nNonce = blockinfo[i].nonce;\n         CValidationState state;\n-        BOOST_CHECK(ProcessNewBlock(state, chainparams, NULL, pblock, true, NULL));\n+        std::shared_ptr<const CBlock> shared_pblock(new CBlock(*pblock));",
    "path": "src/test/miner_tests.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "make_shared\n",
    "created_at": "2016-10-25T16:52:05Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948818",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948818"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948818"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 226,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948843",
    "pull_request_review_id": 5686996,
    "id": 84948843,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTQ4ODQz",
    "diff_hunk": "@@ -127,7 +127,8 @@ TestChain100Setup::CreateAndProcessBlock(const std::vector<CMutableTransaction>&\n     while (!CheckProofOfWork(block.GetHash(), block.nBits, chainparams.GetConsensus())) ++block.nNonce;\n \n     CValidationState state;\n-    ProcessNewBlock(state, chainparams, NULL, &block, true, NULL);\n+    std::shared_ptr<const CBlock> shared_pblock(new CBlock(block));",
    "path": "src/test/test_bitcoin.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "make_shared\n",
    "created_at": "2016-10-25T16:52:13Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948843",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948843"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84948843"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84948843/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 130,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84950014",
    "pull_request_review_id": 5686996,
    "id": 84950014,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTUwMDE0",
    "diff_hunk": "@@ -3740,7 +3766,7 @@ static bool AcceptBlock(const CBlock& block, CValidationState& state, const CCha\n     return true;\n }\n \n-bool ProcessNewBlock(CValidationState& state, const CChainParams& chainparams, CNode* pfrom, const CBlock* pblock, bool fForceProcessing, const CDiskBlockPos* dbp)\n+bool ProcessNewBlock(CValidationState& state, const CChainParams& chainparams, CNode* pfrom, std::shared_ptr<const CBlock>& pblock, bool fForceProcessing, const CDiskBlockPos* dbp)",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 137,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Semantics of passing shared_ptr by reference are a bit wonky. I think it is correct in this use case though. Perhaps it would be better for maintainability to eat the performance cost of an atomic increment and pass by value, or pass by const reference (if possible?).\n",
    "created_at": "2016-10-25T16:58:11Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84950014",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84950014"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84950014"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84950014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3769,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84950114",
    "pull_request_review_id": 5686996,
    "id": 84950114,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTUwMTE0",
    "diff_hunk": "@@ -5829,7 +5855,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         BlockTransactions resp;\n         vRecv >> resp;\n \n-        CBlock block;\n+        CBlock *pblock = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 146,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "make_shared\n",
    "created_at": "2016-10-25T16:58:38Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84950114",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84950114"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84950114"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84950114/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 5858,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84951636",
    "pull_request_review_id": 5686996,
    "id": 84951636,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTUxNjM2",
    "diff_hunk": "@@ -2799,20 +2799,40 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+struct CompareBlockIndexByWork {\n+    bool operator()(const CBlockIndex* a, const CBlockIndex* b) const {\n+        return a->nChainWork < b->nChainWork;\n+    }\n+};\n+\n+// Used in ActivateBestChain/ConnectBlock to keep track of blocks connected\n+// and notify listeners in the right order.\n+// Note that since mapBlocks is sorted lowest-work to highest-work, iterating\n+// over it will give you the order in which the blocks were connected\n+struct BlockConnectTrace {\n+    std::map<CBlockIndex*, std::shared_ptr<const CBlock>, CompareBlockIndexByWork> mapBlocks;",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it may be worthwhile for you to make this a class and keep the implementation details hidden...\n",
    "created_at": "2016-10-25T17:06:55Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84951636",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84951636"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84951636"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84951636/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2813,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84953007",
    "pull_request_review_id": 5698055,
    "id": 84953007,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTUzMDA3",
    "diff_hunk": "@@ -5829,7 +5855,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         BlockTransactions resp;\n         vRecv >> resp;\n \n-        CBlock block;\n+        CBlock *pblock = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 146,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The shared_ptrs are to a const CBlock, and IIRC you cant blindly cast a shared_ptr<CBlock> to a shared_ptr<const CBlock>, but you need to access the block as non-const, and I kinda prefer this over a const_cast.\n",
    "created_at": "2016-10-25T17:13:42Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84953007",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84953007"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84953007"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84953007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 5858,
    "side": "RIGHT",
    "in_reply_to_id": 84950114
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84957095",
    "pull_request_review_id": 5701877,
    "id": 84957095,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTU3MDk1",
    "diff_hunk": "@@ -5829,7 +5855,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         BlockTransactions resp;\n         vRecv >> resp;\n \n-        CBlock block;\n+        CBlock *pblock = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 146,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "implicit copy-cast should work...\n\n```\n#include <memory>\nint main() {\n    auto a = std::make_shared<int>(10);\n    std::shared_ptr<const int> b = a;\n}\n```\n",
    "created_at": "2016-10-25T17:32:43Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84957095",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84957095"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84957095"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84957095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 5858,
    "side": "RIGHT",
    "in_reply_to_id": 84950114
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84964567",
    "pull_request_review_id": 5708818,
    "id": 84964567,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTY0NTY3",
    "diff_hunk": "@@ -5829,7 +5855,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         BlockTransactions resp;\n         vRecv >> resp;\n \n-        CBlock block;\n+        CBlock *pblock = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 146,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Cool, didnt realize that was a thing!\n",
    "created_at": "2016-10-25T18:06:28Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84964567",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84964567"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84964567"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84964567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 5858,
    "side": "RIGHT",
    "in_reply_to_id": 84950114
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84969535",
    "pull_request_review_id": 5713582,
    "id": 84969535,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTY5NTM1",
    "diff_hunk": "@@ -2799,20 +2799,40 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+struct CompareBlockIndexByWork {\n+    bool operator()(const CBlockIndex* a, const CBlockIndex* b) const {\n+        return a->nChainWork < b->nChainWork;\n+    }\n+};\n+\n+// Used in ActivateBestChain/ConnectBlock to keep track of blocks connected\n+// and notify listeners in the right order.\n+// Note that since mapBlocks is sorted lowest-work to highest-work, iterating\n+// over it will give you the order in which the blocks were connected\n+struct BlockConnectTrace {\n+    std::map<CBlockIndex*, std::shared_ptr<const CBlock>, CompareBlockIndexByWork> mapBlocks;",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I added txConflicted here to make diffs of individual commits easier, which now requires a lot of access to the contents directly :/ Not sure its worth it.\n",
    "created_at": "2016-10-25T18:29:28Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84969535",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84969535"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84969535"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84969535/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2813,
    "side": "RIGHT",
    "in_reply_to_id": 84951636
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84969627",
    "pull_request_review_id": 5713673,
    "id": 84969627,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg0OTY5NjI3",
    "diff_hunk": "@@ -2799,20 +2799,40 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+struct CompareBlockIndexByWork {\n+    bool operator()(const CBlockIndex* a, const CBlockIndex* b) const {\n+        return a->nChainWork < b->nChainWork;\n+    }\n+};\n+\n+// Used in ActivateBestChain/ConnectBlock to keep track of blocks connected\n+// and notify listeners in the right order.\n+// Note that since mapBlocks is sorted lowest-work to highest-work, iterating\n+// over it will give you the order in which the blocks were connected\n+struct BlockConnectTrace {\n+    std::map<CBlockIndex*, std::shared_ptr<const CBlock>, CompareBlockIndexByWork> mapBlocks;\n+};\n+\n /**\n- * Connect a new block to chainActive. pblock is either NULL or a pointer to a CBlock\n- * corresponding to pindexNew, to bypass loading it again from disk.\n+ * Connect a new block to chainActive.\n+ * If a shared_ptr to the block for pindexNew already exists in blockTrace.mapBlocks,\n+ * we will bypass re-loading the block from disk.\n  */\n-bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const CBlock* pblock, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, std::vector<std::tuple<CTransaction,CBlockIndex*,int>> &txChanged)\n+bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, BlockConnectTrace& blockTrace)\n {\n     assert(pindexNew->pprev == chainActive.Tip());\n     // Read block from disk.\n     int64_t nTime1 = GetTimeMicros();\n-    CBlock block;\n-    if (!pblock) {\n-        if (!ReadBlockFromDisk(block, pindexNew, chainparams.GetConsensus()))\n+    const CBlock *pblock;\n+    auto it = blockTrace.mapBlocks.find(pindexNew);\n+    if (it == blockTrace.mapBlocks.end()) {\n+        CBlock *pblockNew = new CBlock();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 37,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The new version should be cleaner.\n",
    "created_at": "2016-10-25T18:29:50Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84969627",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84969627"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r84969627"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/84969627/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2829,
    "side": "RIGHT",
    "in_reply_to_id": 84941470
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85033430",
    "pull_request_review_id": 5773286,
    "id": 85033430,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDMzNDMw",
    "diff_hunk": "@@ -2799,11 +2799,18 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n+// Used to track conflicted transactions removed from mempool and transactions",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "34d0c884d612a3e2519ce3670894a32d668bd052",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can you use a doxygen compatible comment here?\n",
    "created_at": "2016-10-26T01:06:18Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85033430",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85033430"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85033430"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85033430/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2802,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85034371",
    "pull_request_review_id": 5774127,
    "id": 85034371,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDM0Mzcx",
    "diff_hunk": "@@ -2974,6 +2975,8 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "a0d30f80f31fbdc8e1aaf2bf1ea5f32c0b3e8ec4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This logic needs to be duplicated in the disconnect logic above. It's possible that an invalid block is received which triggers a reorg. So we start from chain A-B, and receive A-C-D, with D invalid. We'll first disconnect B, then successfully connect C, but fail when connecting D. We'll loop back then, disconnect C, and reconnect B. Your code will (I believe) report both C and B as newly connected, while it should be nothing at all.\n\nPerhaps it's easier to do a filtering step in ActivateBestChain that removes the errorneously blocks in the trace.\n",
    "created_at": "2016-10-26T01:17:52Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85034371",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85034371"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85034371"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85034371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2978,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85034775",
    "pull_request_review_id": 5774478,
    "id": 85034775,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDM0Nzc1",
    "diff_hunk": "@@ -2806,11 +2806,13 @@ struct ConnectTrace {\n     std::vector<std::pair<CBlockIndex*, std::shared_ptr<const CBlock> > > blocksConnected;\n };\n \n+",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "051b9968cf32dfe7f05cf159b8b515bbdaae845d",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Unintentional new lines?\n",
    "created_at": "2016-10-26T01:22:46Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85034775",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85034775"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85034775"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85034775/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2809,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85035520",
    "pull_request_review_id": 5775179,
    "id": 85035520,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDM1NTIw",
    "diff_hunk": "@@ -3740,7 +3766,7 @@ static bool AcceptBlock(const CBlock& block, CValidationState& state, const CCha\n     return true;\n }\n \n-bool ProcessNewBlock(CValidationState& state, const CChainParams& chainparams, CNode* pfrom, const CBlock* pblock, bool fForceProcessing, const CDiskBlockPos* dbp)\n+bool ProcessNewBlock(CValidationState& state, const CChainParams& chainparams, CNode* pfrom, std::shared_ptr<const CBlock>& pblock, bool fForceProcessing, const CDiskBlockPos* dbp)",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 137,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "d0f3b607859dd9e46869aa2639d733dc129fabc4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In my opinion, passing by reference is preferred at any time when you're sure the shared_ptr itself (not the object it points to) is only accessed from a single thread. The cost of the atomic increment is negligable here though, so I don't care in this particular case.\n",
    "created_at": "2016-10-26T01:32:54Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85035520",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85035520"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85035520"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85035520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3769,
    "side": "RIGHT",
    "in_reply_to_id": 84950014
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85042624",
    "pull_request_review_id": 5781432,
    "id": 85042624,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDQyNjI0",
    "diff_hunk": "@@ -5846,7 +5841,8 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         BlockTransactions resp;\n         vRecv >> resp;\n \n-        CBlock block;\n+        CBlock *pblock = new CBlock();\n+        std::shared_ptr<const CBlock> shared_pblock(pblock); // pblock will be delted by the shared_ptr",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "5095970c9703bdb23459839b4aade2ad56b792d5",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo: deleted\n",
    "created_at": "2016-10-26T03:07:25Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85042624",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85042624"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85042624"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85042624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 5845,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85043630",
    "pull_request_review_id": 5782379,
    "id": 85043630,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDQzNjMw",
    "diff_hunk": "@@ -2974,6 +2975,8 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "a0d30f80f31fbdc8e1aaf2bf1ea5f32c0b3e8ec4",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hmm? I dont believe so? Note that the callbacks in question are called from ABC after each ABCS call, and might happen for blocks which will be reorged out in the next ABCS call (this is the existing behavior).\n",
    "created_at": "2016-10-26T03:22:20Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85043630",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85043630"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85043630"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85043630/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2978,
    "side": "RIGHT",
    "in_reply_to_id": 85034371
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85047825",
    "pull_request_review_id": 5786012,
    "id": 85047825,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MDQ3ODI1",
    "diff_hunk": "@@ -2959,14 +2968,16 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n \n         // Connect new blocks.\n         BOOST_REVERSE_FOREACH(CBlockIndex *pindexConnect, vpindexToConnect) {\n-            if (!ConnectTip(state, chainparams, pindexConnect, pindexConnect == pindexMostWork ? pblock : NULL, txConflicted, txChanged)) {\n+            if (!ConnectTip(state, chainparams, pindexConnect, pindexConnect == pindexMostWork ? pblock : std::shared_ptr<const CBlock>(), connectTrace)) {\n                 if (state.IsInvalid()) {\n                     // The block violates a consensus rule.\n                     if (!state.CorruptionPossible())\n                         InvalidChainFound(vpindexToConnect.back());\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 84,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No, cs_main is held during the entirety of the attempted reorg here, and the callbacks only fire after the whole thing (I think).\n",
    "created_at": "2016-10-26T04:27:58Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85047825",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85047825"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85047825"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85047825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2979,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85133796",
    "pull_request_review_id": 5866264,
    "id": 85133796,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MTMzNzk2",
    "diff_hunk": "@@ -2959,14 +2968,16 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n \n         // Connect new blocks.\n         BOOST_REVERSE_FOREACH(CBlockIndex *pindexConnect, vpindexToConnect) {\n-            if (!ConnectTip(state, chainparams, pindexConnect, pindexConnect == pindexMostWork ? pblock : NULL, txConflicted, txChanged)) {\n+            if (!ConnectTip(state, chainparams, pindexConnect, pindexConnect == pindexMostWork ? pblock : std::shared_ptr<const CBlock>(), connectTrace)) {\n                 if (state.IsInvalid()) {\n                     // The block violates a consensus rule.\n                     if (!state.CorruptionPossible())\n                         InvalidChainFound(vpindexToConnect.back());\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 84,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm very confused. ActivateBestChain has always locked cs_main, called ActivateBestChainStep once, and then unlocked cs_main and made callbacks before repeating. In the old code we pushed transactions to update onto the callback queue at the end of ConnectTip and never removed them (since there will never be a DisconnectTip call within the same cs_main in ActivateBestChainStep since all DisconnectTips happen before ConnectTip).\n",
    "created_at": "2016-10-26T14:24:01Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85133796",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85133796"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85133796"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85133796/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2979,
    "side": "RIGHT",
    "in_reply_to_id": 85047825
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85174751",
    "pull_request_review_id": 5905319,
    "id": 85174751,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MTc0NzUx",
    "diff_hunk": "@@ -2959,14 +2968,16 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n \n         // Connect new blocks.\n         BOOST_REVERSE_FOREACH(CBlockIndex *pindexConnect, vpindexToConnect) {\n-            if (!ConnectTip(state, chainparams, pindexConnect, pindexConnect == pindexMostWork ? pblock : NULL, txConflicted, txChanged)) {\n+            if (!ConnectTip(state, chainparams, pindexConnect, pindexConnect == pindexMostWork ? pblock : std::shared_ptr<const CBlock>(), connectTrace)) {\n                 if (state.IsInvalid()) {\n                     // The block violates a consensus rule.\n                     if (!state.CorruptionPossible())\n                         InvalidChainFound(vpindexToConnect.back());\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 84,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It seems that failed reorgs are an exception to what I said before, so ignore what I said. I think we should fix this (it could lead to GBT working on the forking point of a failed reorg), but that's outside of the scope here.\n",
    "created_at": "2016-10-26T17:21:30Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85174751",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85174751"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85174751"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85174751/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2979,
    "side": "RIGHT",
    "in_reply_to_id": 85047825
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85176434",
    "pull_request_review_id": 5906887,
    "id": 85176434,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MTc2NDM0",
    "diff_hunk": "@@ -2800,28 +2800,40 @@ static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n /**\n+ * Used to track conflicted transactions removed from mempool and transactions\n+ * applied to the UTXO state as a part of a single ActivateBestChainStep call.\n+ */\n+struct ConnectTrace {\n+    std::vector<std::shared_ptr<const CTransaction>> txConflicted;\n+    std::vector<std::pair<CBlockIndex*, std::shared_ptr<const CBlock> > > blocksConnected;\n+};\n+\n+/**\n  * Connect a new block to chainActive. pblock is either NULL or a pointer to a CBlock\n  * corresponding to pindexNew, to bypass loading it again from disk.\n  */\n-bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const CBlock* pblock, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, std::vector<std::tuple<CTransaction,CBlockIndex*,int>> &txChanged)\n+bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const std::shared_ptr<const CBlock>& pblock, ConnectTrace& connectTrace)\n {\n     assert(pindexNew->pprev == chainActive.Tip());\n     // Read block from disk.\n     int64_t nTime1 = GetTimeMicros();\n-    CBlock block;\n     if (!pblock) {\n-        if (!ReadBlockFromDisk(block, pindexNew, chainparams.GetConsensus()))\n+        std::shared_ptr<CBlock> pblockNew = std::make_shared<CBlock>();\n+        connectTrace.blocksConnected.emplace_back(pindexNew, pblockNew);\n+        if (!ReadBlockFromDisk(*pblockNew, pindexNew, chainparams.GetConsensus()))",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ultranit: if you swap this line with the one above, you can pass std::move(pblockNew) to emplace_back, avoiding an atomic increment + decrement when pblockNew goes out of scope.\n",
    "created_at": "2016-10-26T17:29:20Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85176434",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85176434"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85176434"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85176434/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2823,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85187415",
    "pull_request_review_id": 5917235,
    "id": 85187415,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MTg3NDE1",
    "diff_hunk": "@@ -2800,28 +2800,40 @@ static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n /**\n+ * Used to track conflicted transactions removed from mempool and transactions\n+ * applied to the UTXO state as a part of a single ActivateBestChainStep call.\n+ */\n+struct ConnectTrace {\n+    std::vector<std::shared_ptr<const CTransaction>> txConflicted;\n+    std::vector<std::pair<CBlockIndex*, std::shared_ptr<const CBlock> > > blocksConnected;\n+};\n+\n+/**\n  * Connect a new block to chainActive. pblock is either NULL or a pointer to a CBlock\n  * corresponding to pindexNew, to bypass loading it again from disk.\n  */\n-bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const CBlock* pblock, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, std::vector<std::tuple<CTransaction,CBlockIndex*,int>> &txChanged)\n+bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const std::shared_ptr<const CBlock>& pblock, ConnectTrace& connectTrace)\n {\n     assert(pindexNew->pprev == chainActive.Tip());\n     // Read block from disk.\n     int64_t nTime1 = GetTimeMicros();\n-    CBlock block;\n     if (!pblock) {\n-        if (!ReadBlockFromDisk(block, pindexNew, chainparams.GetConsensus()))\n+        std::shared_ptr<CBlock> pblockNew = std::make_shared<CBlock>();\n+        connectTrace.blocksConnected.emplace_back(pindexNew, pblockNew);\n+        if (!ReadBlockFromDisk(*pblockNew, pindexNew, chainparams.GetConsensus()))",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No, because pblockNew is a std::shared_ptr<CBlock> not an std::shared_ptr<const CBlock>, so you must call the std::shared_ptr constructor to convert it.\n",
    "created_at": "2016-10-26T18:20:49Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85187415",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85187415"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85187415"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85187415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2823,
    "side": "RIGHT",
    "in_reply_to_id": 85176434
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85189057",
    "pull_request_review_id": 5918727,
    "id": 85189057,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MTg5MDU3",
    "diff_hunk": "@@ -2800,28 +2800,40 @@ static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n /**\n+ * Used to track conflicted transactions removed from mempool and transactions\n+ * applied to the UTXO state as a part of a single ActivateBestChainStep call.\n+ */\n+struct ConnectTrace {\n+    std::vector<std::shared_ptr<const CTransaction>> txConflicted;\n+    std::vector<std::pair<CBlockIndex*, std::shared_ptr<const CBlock> > > blocksConnected;\n+};\n+\n+/**\n  * Connect a new block to chainActive. pblock is either NULL or a pointer to a CBlock\n  * corresponding to pindexNew, to bypass loading it again from disk.\n  */\n-bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const CBlock* pblock, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, std::vector<std::tuple<CTransaction,CBlockIndex*,int>> &txChanged)\n+bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const std::shared_ptr<const CBlock>& pblock, ConnectTrace& connectTrace)\n {\n     assert(pindexNew->pprev == chainActive.Tip());\n     // Read block from disk.\n     int64_t nTime1 = GetTimeMicros();\n-    CBlock block;\n     if (!pblock) {\n-        if (!ReadBlockFromDisk(block, pindexNew, chainparams.GetConsensus()))\n+        std::shared_ptr<CBlock> pblockNew = std::make_shared<CBlock>();\n+        connectTrace.blocksConnected.emplace_back(pindexNew, pblockNew);\n+        if (!ReadBlockFromDisk(*pblockNew, pindexNew, chainparams.GetConsensus()))",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I see!\n",
    "created_at": "2016-10-26T18:28:20Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85189057",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85189057"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85189057"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85189057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2823,
    "side": "RIGHT",
    "in_reply_to_id": 85176434
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85193453",
    "pull_request_review_id": 5922923,
    "id": 85193453,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg1MTkzNDUz",
    "diff_hunk": "@@ -2800,28 +2800,40 @@ static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n /**\n+ * Used to track conflicted transactions removed from mempool and transactions\n+ * applied to the UTXO state as a part of a single ActivateBestChainStep call.\n+ */\n+struct ConnectTrace {\n+    std::vector<std::shared_ptr<const CTransaction>> txConflicted;\n+    std::vector<std::pair<CBlockIndex*, std::shared_ptr<const CBlock> > > blocksConnected;\n+};\n+\n+/**\n  * Connect a new block to chainActive. pblock is either NULL or a pointer to a CBlock\n  * corresponding to pindexNew, to bypass loading it again from disk.\n  */\n-bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const CBlock* pblock, std::vector<std::shared_ptr<const CTransaction>> &txConflicted, std::vector<std::tuple<CTransaction,CBlockIndex*,int>> &txChanged)\n+bool static ConnectTip(CValidationState& state, const CChainParams& chainparams, CBlockIndex* pindexNew, const std::shared_ptr<const CBlock>& pblock, ConnectTrace& connectTrace)\n {\n     assert(pindexNew->pprev == chainActive.Tip());\n     // Read block from disk.\n     int64_t nTime1 = GetTimeMicros();\n-    CBlock block;\n     if (!pblock) {\n-        if (!ReadBlockFromDisk(block, pindexNew, chainparams.GetConsensus()))\n+        std::shared_ptr<CBlock> pblockNew = std::make_shared<CBlock>();\n+        connectTrace.blocksConnected.emplace_back(pindexNew, pblockNew);\n+        if (!ReadBlockFromDisk(*pblockNew, pindexNew, chainparams.GetConsensus()))",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "3f78bc176a3c612f320bce4516aadcd6234c0850",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "(if anyone else gets confused, Matt meant std::shared_ptr not std::atomic above)\n",
    "created_at": "2016-10-26T18:49:31Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85193453",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85193453"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r85193453"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/85193453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2823,
    "side": "RIGHT",
    "in_reply_to_id": 85176434
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89256214",
    "pull_request_review_id": 9802773,
    "id": 89256214,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg5MjU2MjE0",
    "diff_hunk": "@@ -2974,6 +2975,8 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "a0d30f80f31fbdc8e1aaf2bf1ea5f32c0b3e8ec4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok (answered elsewhere).",
    "created_at": "2016-11-23T04:44:44Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r89256214",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89256214"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r89256214"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89256214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2978,
    "side": "RIGHT",
    "in_reply_to_id": 85034371
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89257012",
    "pull_request_review_id": 9803498,
    "id": 89257012,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg5MjU3MDEy",
    "diff_hunk": "@@ -3110,13 +3118,17 @@ bool ActivateBestChain(CValidationState &state, const CChainParams& chainparams,\n \n         // throw all transactions though the signal-interface\n         // while _not_ holding the cs_main lock\n-        for (const auto& tx : txConflicted)\n+        for (const auto& tx : connectTrace.txConflicted)\n         {\n             GetMainSignals().SyncTransaction(*tx, pindexNewTip, CMainSignals::SYNC_TRANSACTION_NOT_IN_BLOCK);\n         }\n         // ... and about transactions that got confirmed:\n-        for (unsigned int i = 0; i < txChanged.size(); i++)\n-            GetMainSignals().SyncTransaction(*std::get<0>(txChanged[i]), std::get<1>(txChanged[i]), std::get<2>(txChanged[i]));\n+        for (const auto& pair : connectTrace.blocksConnected) {\n+            assert(pair.second);\n+            const CBlock& block = *(pair.second);",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 136,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "7b717cdf7fde0614f64237d3430b7728103ee7e4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This loop could be rewritten as \r\n```\r\nfor (const auto& ptx : pair.second->vtx)\r\n    GetMainSignals().SyncTransaction(*ptx, pair.first, i);\r\n```\r\n",
    "created_at": "2016-11-23T05:01:13Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r89257012",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89257012"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r89257012"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89257012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3128,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89928493",
    "pull_request_review_id": 10456731,
    "id": 89928493,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDg5OTI4NDkz",
    "diff_hunk": "@@ -3018,6 +3019,8 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it\n+                    connectTrace.blocksConnected.pop_back();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 43,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "eb33aa1412264a982ff315c88a231671c876e590",
    "user": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: slightly weird that the caller of ConnectTip() has to know to do this on failures.  Perhaps document this somewhere?",
    "created_at": "2016-11-29T02:13:48Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r89928493",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89928493"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r89928493"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/89928493/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3023,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/90170769",
    "pull_request_review_id": 10693090,
    "id": 90170769,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkwMTcwNzY5",
    "diff_hunk": "@@ -3018,6 +3019,8 @@ static bool ActivateBestChainStep(CValidationState& state, const CChainParams& c\n                     state = CValidationState();\n                     fInvalidFound = true;\n                     fContinue = false;\n+                    // If we didn't actually connect the block, don't notify listeners about it\n+                    connectTrace.blocksConnected.pop_back();",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 43,
    "commit_id": "dd0df81ebdbf705f7ad386c7229bf1bbc3125f62",
    "original_commit_id": "eb33aa1412264a982ff315c88a231671c876e590",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2016-11-30T05:26:43Z",
    "updated_at": "2016-12-04T08:19:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r90170769",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/90170769"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9014#discussion_r90170769"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9014"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/90170769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3023,
    "side": "RIGHT",
    "in_reply_to_id": 89928493
  }
]