[
  {
    "sha": "07e4bdba3bd46c3a15dedb0a2660453c300643dc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowN2U0YmRiYTNiZDQ2YzNhMTVkZWRiMGEyNjYwNDUzYzMwMDY0M2Rj",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@protonmail.com",
        "date": "2019-10-03T04:08:52Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@protonmail.com",
        "date": "2019-10-03T04:58:47Z"
      },
      "message": "Don't rename main thread at process level\n\nSet only the internal name.\n\nFixes #17036 for both `bitcoind` and `bitcoin-qt`.",
      "tree": {
        "sha": "f8f640a3962e72252121ebc3652b74b09c53f0bc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f8f640a3962e72252121ebc3652b74b09c53f0bc"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/07e4bdba3bd46c3a15dedb0a2660453c300643dc",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/07e4bdba3bd46c3a15dedb0a2660453c300643dc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/07e4bdba3bd46c3a15dedb0a2660453c300643dc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/07e4bdba3bd46c3a15dedb0a2660453c300643dc/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f4a0d27e85754d60804ffa36e415b67c263180b9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f4a0d27e85754d60804ffa36e415b67c263180b9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f4a0d27e85754d60804ffa36e415b67c263180b9"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 12,
      "deletions": 2
    },
    "files": [
      {
        "sha": "17989a4214aff39125e4fc43778a4991e35fc824",
        "filename": "src/bitcoind.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/bitcoind.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/bitcoind.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoind.cpp?ref=07e4bdba3bd46c3a15dedb0a2660453c300643dc",
        "patch": "@@ -45,7 +45,7 @@ static bool AppInit(int argc, char* argv[])\n \n     bool fRet = false;\n \n-    util::ThreadRename(\"init\");\n+    util::ThreadSetInternalName(\"init\");\n \n     //\n     // Parameters"
      },
      {
        "sha": "86f4dc91a1f3d7d31893b201e0722e66e504099e",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=07e4bdba3bd46c3a15dedb0a2660453c300643dc",
        "patch": "@@ -416,7 +416,7 @@ int GuiMain(int argc, char* argv[])\n     std::tie(argc, argv) = winArgs.get();\n #endif\n     SetupEnvironment();\n-    util::ThreadRename(\"main\");\n+    util::ThreadSetInternalName(\"main\");\n \n     std::unique_ptr<interfaces::Node> node = interfaces::MakeNode();\n "
      },
      {
        "sha": "168f9325d075ad9ad60ffc6e6f4bdf3a227e8f42",
        "filename": "src/util/threadnames.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/util/threadnames.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/util/threadnames.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/threadnames.cpp?ref=07e4bdba3bd46c3a15dedb0a2660453c300643dc",
        "patch": "@@ -60,3 +60,8 @@ void util::ThreadRename(std::string&& name)\n     SetThreadName((\"b-\" + name).c_str());\n     SetInternalName(std::move(name));\n }\n+\n+void util::ThreadSetInternalName(std::string&& name)\n+{\n+    SetInternalName(std::move(name));\n+}"
      },
      {
        "sha": "69a1b55bfe531b8a0433989361980cff6daced4e",
        "filename": "src/util/threadnames.h",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/util/threadnames.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/07e4bdba3bd46c3a15dedb0a2660453c300643dc/src/util/threadnames.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/threadnames.h?ref=07e4bdba3bd46c3a15dedb0a2660453c300643dc",
        "patch": "@@ -10,8 +10,13 @@\n namespace util {\n //! Rename a thread both in terms of an internal (in-memory) name as well\n //! as its system thread name.\n+//! @note Do not call this for the main thread, as this will interfere with\n+//! UNIX utilities such as top and killall. Use ThreadSetInternalName instead.\n void ThreadRename(std::string&&);\n \n+//! Set the internal (in-memory) name of the current thread only.\n+void ThreadSetInternalName(std::string&&);\n+\n //! Get the thread's internal (in-memory) name; used e.g. for identification in\n //! logging.\n const std::string& ThreadGetInternalName();"
      }
    ]
  }
]