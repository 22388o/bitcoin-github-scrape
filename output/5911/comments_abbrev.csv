laanwj,2015-03-19T07:42:43Z,"This change has another advantage: every connection will (potentially) go through a different exit node. That significantly reduces the chance to get unlucky and pick a single exit node that is either malicious with regard to bitcoin, or widely banned on the P2P network.\n\nYou can test this by looking at `via` in the peers list or `addrlocal` in `getpeerinfo`. This is the address that peers repor",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-83393101,83393101,
jgarzik,2015-03-19T09:13:45Z,Vaguely in favor -- needs a lot of thinking-through.  Consult with some Tor experts for their opinion?\n,https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-83433020,83433020,
laanwj,2015-03-19T09:56:20Z,> needs a lot of thinking-through\n\nCan you explain what problem you see with this?\n,https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-83460274,83460274,
jgarzik,2015-03-19T10:09:25Z,"@laanwj Nothing specific - just pattern matching.  Sometimes stream cycling makes activities more visible rather than less, e.g. for the reasons that Tor bridges are used.  This is the type of change that can have subtle ramifications not immediately obvious.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-83475940,83475940,
laanwj,2015-03-19T10:20:16Z,"In that case it may be prudent to have it disabled by default, but I would like to have the option for this. Note that Tor already switches the circuit (for new connections) every 10 minutes by default, so this will mostly have an effect on the initial connections which are made in a short timespan. \n\n@gmaxwell was talking about defaulting this to enabled, maybe he can comment.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-83487882,83487882,
gmaxwell,2015-03-19T13:44:15Z,"I previously got an opinion from a tor developer that sounded vaguely like ""you're not doing that already??""-- without it we potentially lose all our sybil resistant and a single bad-exit can partition us from the network, as we make all our connections at the same time, at startup.\n\nHopping around the globe can make things more visible if you're a web broswer and you're hoping to not be noticed",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-83586619,83586619,
laanwj,2015-04-01T09:29:58Z,"> We could do something more mild, like have each of our outbound connection indexes share a identifer with no loss... \n\nThis would have the effect of reusing the same circuit when reconnecting quickly. I can imagine that would happen when a node boots you immediately, or for some reason you're cycling faster than every 10 minutes - if it takes longer a new circuit would be used automatically by",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-88413096,88413096,
gmaxwell,2015-04-01T09:50:11Z,"@laanwj one downside that occurs to me is that an exit can make you ban that peer, then you'd continue using that same exit again and again. So at a minimum a misbehaving disconnect should change the identity for that slot.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-88418780,88418780,
laanwj,2015-04-02T09:27:38Z,"Agreed. Bleh, I'd like to avoid that kind of complexity and 'slot management'.\n\nIn practice I've encountered no performance problems in using a different circuit every time. And even if it introduced some extra latency for new connections, we're not terribly sensitive to that.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-88839158,88839158,
laanwj,2015-04-13T13:31:19Z,"I'd like to move this forward. Anything that still needs to be done here? \n\nIf we are in doubt about enabling the randomization by default, I'd like to merge this with the option defaulting to false.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-92352173,92352173,
gmaxwell,2015-04-13T16:15:16Z,"This seems to work fine for me at least.  I'm not concerned with more streams, it seems to make multiple connections a bit slower (for the obvious reasons), but also seems to make the connectivity more reliable (previously all the ipv4 peers would go down at once sometimes). \n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-92413917,92413917,
laanwj,2015-04-17T17:29:34Z,"Added a RPC test for the `-proxy`, `-onion` and `-proxyrandomize` functionality, as promised in OP.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-94032917,94032917,
sipa,2015-04-20T15:16:01Z,What happens when you use this socks5 authentication with a non-Tor socks5\nproxy?\n,https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-94480958,94480958,
isislovecruft,2015-05-06T22:52:06Z,"> @sipa: What happens when you use this socks5 authentication with a non-Tor socks5 proxy?\n\nOverwhemingly likely: it won't accept the username and password because there isn't any user $RANDOM with password $RANDOM, and so it will reject the connection. (See [RFC1929](https://tools.ietf.org/html/rfc1929) §2 for what the byte values are in an auth rejection reply.)\n\nRather unlikely: if the non-",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-99634894,99634894,
isislovecruft,2015-05-06T23:04:50Z,"> > @gmaxwell: We could do something more mild, like have each of our outbound connection indexes share a identifer with no loss...\n> \n> @laanwj: This would have the effect of reusing the same circuit when reconnecting quickly. I can imagine that would happen when a node boots you immediately, or for some reason you're cycling faster than every 10 minutes - if it takes longer a new circuit would",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-99638520,99638520,
laanwj,2015-05-07T07:50:45Z,"@sipa\n\n> What happens when you use this socks5 authentication with a non-Tor socks5 proxy?\n- If the SOCKS5 proxy doesn't _support_ authentication (for example, ssh -D), it makes no difference. No token is sent.\n- If the proxy _requires_ authentication then submitting random passwords will make it deny your connections just like submitting no password did before. I've never heard any requests r",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-99758681,99758681,
isislovecruft,2015-07-13T21:32:32Z,"@laanwj No problem; happy to help!\n\n> Right, makes sense. However in our case, outgoing connections are quite rare. We make only up to  8. So as I understand, it'll never create a huge number of circuits. This makes it less of an issue, I suppose?\n\nOh, if it's only 8 at a time, then you're correct that it really doesn't matter… the overhead is miniscule.\n",https://github.com/bitcoin/bitcoin/pull/5911#issuecomment-121066255,121066255,
