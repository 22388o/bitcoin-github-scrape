[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/526741579",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-526741579",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 526741579,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjc0MTU3OQ==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-30T20:37:32Z",
    "updated_at": "2019-08-30T20:37:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "I added a cache which works per call/across calls, but does not store the results semi-permanently.\r\n\r\nThis should reduce DoS risk of this change.\r\n\r\nThere is no risk of _untrusted_ parents causing a resource exploitation, as we immediately return once that is detected.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/526741579/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/526769063",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-526769063",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 526769063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjc2OTA2Mw==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-30T22:33:01Z",
    "updated_at": "2019-11-04T02:14:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15931](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15931.html) (Remove GetDepthInMainChain dependency on locked chain interface by ariard)\n* [#15729](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15729.html) (rpc: Raise error in getbalance if minconf is not zero by promag)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/526769063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527518660",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-527518660",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 527518660,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzUxODY2MA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T15:48:00Z",
    "updated_at": "2019-09-03T15:48:00Z",
    "author_association": "MEMBER",
    "body": "> If a parent is not trusted, then a child should not be either.\r\n\r\nWould be nice to have a test for this or update the `wallet_balance.py` script in case it is already tested there. (`wallet_balance.py` is failing)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527518660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527563982",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-527563982",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 527563982,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzU2Mzk4Mg==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T17:42:37Z",
    "updated_at": "2019-09-03T17:42:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I updated the tests to pass.\r\n\r\nIn the test, we  have two nodes with a balance of 50 each and then:\r\n\r\nSend 40 from node A to node B.\r\nSend 60 from node B to node A.\r\n\r\nThen we would check the balances.\r\n\r\nPreviously, we would immediately report a balance of 30 on node B as unconfirmed and trusted.\r\n\r\nNow, we show that balance as unconfirmed.\r\n\r\nThe balance is indeed \"trusted\" and \"confirmed\" insofar as removing the mempool transactions would return *at least* that much money. But the current software marks it as unconfirmed because the 'taint' tracking of transaction trust for summing balances doesn't consider which inputs belong to a user.\r\n\r\nI think the new behavior is correct; we shouldn't be treating those funds as confirmed. If you want to *rely* on that specific UTXO existing which has given you that balance, you cannot, as a third party spending the other input would destroy that unconfirmed.\r\n\r\nOverall I think that this points to a general concept worth exploring as a revision to the categories \"unconfirmed\" and \"confirmed\", to have \"free cash\", \"locked\", and \"unconfirmed\". Free cash can be spent at will, locked funds are balances that are guaranteed to exist but we don't have a confirmed UTXO for yet, and unconfirmed are funds we may or may not receive. I think this is out of scope of this PR though, but is worth further thought.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527563982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528522217",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-528522217",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 528522217,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODUyMjIxNw==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-05T18:47:57Z",
    "updated_at": "2019-09-05T18:47:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Test failure unrelated it seems? In assumevalid",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528522217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528930189",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-528930189",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 528930189,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODkzMDE4OQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-06T16:52:00Z",
    "updated_at": "2019-09-06T16:52:00Z",
    "author_association": "MEMBER",
    "body": "Do you expect a performance penalty for big wallets?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528930189/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528941809",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-528941809",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 528941809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODk0MTgwOQ==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-06T17:26:42Z",
    "updated_at": "2019-09-06T17:26:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes and No.\r\n\r\nYes:\r\nA properly constructed wallet, which has long-chains of unconfirmed transactions, will take longer to analyze. However, given the use of the set cache it should still be linear in the number of long-chain inputs (this could be large if there are a ton of fully independent unconfirmeds being spent).\r\n\r\nNo:\r\nA normal wallet, and normal wallet transactions (who is confirmed or whose parents are all confirmed) won't have much impact. Note we also abort as soon as we find an offending tx. It might be better to do this via BFS than DFS, but DFS is simpler to implement.\r\n\r\nNote that a third party can't force a long-chain lookup on you without your participation, because you're checking IsMine at each level. So an unconfirmed spend to you will look back only until it's a transaction with another participant that's unconfirmed.\r\n\r\nIt's also possible to use an unordered_set here -- but perhaps that's better done as something across the module (std::set/map is used extensively)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/528941809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533717925",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-533717925",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 533717925,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzMzcxNzkyNQ==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-20T21:41:03Z",
    "updated_at": "2019-09-20T21:41:03Z",
    "author_association": "MEMBER",
    "body": "> I think the new behavior is correct; we shouldn't be treating those funds as confirmed. If you want to rely on that specific UTXO existing which has given you that balance, you cannot, as a third party spending the other input would destroy that unconfirmed.\r\n\r\nBut your balance isn't specific UTXOs. Users don't care about UTXOs, just total bitcoins.\r\n\r\n30 BTC should show as confirmed and trusted...",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533717925/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533778856",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-533778856",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 533778856,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzMzc3ODg1Ng==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-21T08:16:30Z",
    "updated_at": "2019-09-21T08:16:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Then it's a mistake to compute balance from summing IsTrusted, but we shouldn't rely on broken IsTrusted behavior to compute Balance.\r\n\r\nBear in mind for the specific situation you're thinking of, there are also edge cases where we over report correct balance. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/533778856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536933191",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-536933191",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 536933191,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNjkzMzE5MQ==",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?u=348c27f90b6fff8fd72fa27232272651436a2ff0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-01T08:40:46Z",
    "updated_at": "2019-10-01T08:40:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Otherwise, it's possible that a parent is not IsTrusted but a child is.\r\n\r\nWas the test you changed a good example of how this can happen or did you have other examples in mind? Would it be worth to have an explicit test for that?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536933191/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544687097",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-544687097",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 544687097,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDY4NzA5Nw==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-21T20:11:51Z",
    "updated_at": "2019-10-21T20:11:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @ryanofsky, thanks for the review!\r\n\r\nThis is a change that came up as a bug-fix esque change while working on OP_SECURETHEBAG. You can see the branch where this change is important here: https://github.com/bitcoin/bitcoin/compare/master...JeremyRubin:stb-with-rpc?expand=1. Essentially, without this change, we can be tricked into accepting an OP_SECURETHEBAG output because we don't properly check the parents.\r\n\r\nAs this was a change which, on its own, was not dependent on OP_SECURETHEBAG, I broke it out as I felt the change stands on its own.\r\n\r\nI'll add to the release notes and to the tests comments.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544687097/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544702465",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-544702465",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 544702465,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDcwMjQ2NQ==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-21T20:51:34Z",
    "updated_at": "2019-10-21T20:51:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "I had to rebase to clear out the release notes; code hasn't changed except the comment in wallet_balances.py. I have also updated the PR message.\r\n\r\nre-ack when you have a moment @ryanofsky!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/544702465/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546437942",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-546437942",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 546437942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NjQzNzk0Mg==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-25T17:17:31Z",
    "updated_at": "2019-10-25T17:17:31Z",
    "author_association": "MEMBER",
    "body": "Code Review ACK 4671fc3, maybe extend DoS protection in a follow-up PR.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546437942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/548118527",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-548118527",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 548118527,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0ODExODUyNw==",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?u=348c27f90b6fff8fd72fa27232272651436a2ff0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-30T21:24:02Z",
    "updated_at": "2019-10-30T21:24:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Code review ACK 4671fc3d9e669da8b8781f0cbefee43cb9acd527\r\n\r\nThanks for adding the extended description in the test. Good idea @ryanofsky !",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/548118527/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549727433",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-549727433",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 549727433,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0OTcyNzQzMw==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-05T08:59:41Z",
    "updated_at": "2019-11-05T08:59:41Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, this looks ready with 4 review ACKs",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549727433/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549951998",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-549951998",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16766",
    "id": 549951998,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0OTk1MTk5OA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-05T18:20:21Z",
    "updated_at": "2019-11-05T18:20:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "re: https://github.com/bitcoin/bitcoin/pull/16766#pullrequestreview-310861505 from @promag \r\n\r\n> Looking into `IsTrusted`, couldn't we change it to not require `cs_main` (just `cs_wallet`)?\r\n\r\nIt's not trivial because of the GetDepthInMainChain and checkFinalTx calls, but #16426 does this\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/549951998/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/320435215",
    "pull_request_review_id": 283206185,
    "id": 320435215,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMDQzNTIxNQ==",
    "diff_hunk": "@@ -112,10 +112,10 @@ def run_test(self):\n         def test_balances(*, fee_node_1=0):\n             # getbalance without any arguments includes unconfirmed transactions, but not untrusted transactions\n             assert_equal(self.nodes[0].getbalance(), Decimal('9.99'))  # change from node 0's send\n-            assert_equal(self.nodes[1].getbalance(), Decimal('30') - fee_node_1)  # change from node 1's send\n+            assert_equal(self.nodes[1].getbalance(), Decimal('0'))  # change from node 1's send",
    "path": "test/functional/wallet_balance.py",
    "position": null,
    "original_position": 5,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "bee1dc9f8a5182f03979fa066dc7937fc945bf29",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n            assert_equal(self.nodes[1].getbalance(), Decimal('0'))  # node 1's send had an unsafe input\r\n```",
    "created_at": "2019-09-03T19:16:39Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r320435215",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/320435215"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r320435215"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/320435215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 115,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529167",
    "pull_request_review_id": 284597322,
    "id": 321529167,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTUyOTE2Nw==",
    "diff_hunk": "@@ -2407,10 +2421,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trustedParents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trustedParents)};",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 39,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "With the overloaded `IsTrusted` this could be reverted? Same below.",
    "created_at": "2019-09-05T23:47:40Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321529167",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529167"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321529167"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2428,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529969",
    "pull_request_review_id": 284597322,
    "id": 321529969,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTUyOTk2OQ==",
    "diff_hunk": "@@ -2320,8 +2326,16 @@ bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n         if (parent == nullptr)\n             return false;\n         const CTxOut& parentOut = parent->tx->vout[txin.prevout.n];\n+        // Check that this specific input being spent is trusted\n         if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE)\n             return false;\n+        // If we've already trusted this parent, continue\n+        if (trustedParents.count(parent->GetHash()))\n+            continue;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, join with line above - to follow correct format.",
    "created_at": "2019-09-05T23:51:38Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321529969",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529969"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321529969"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529969/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2334,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529995",
    "pull_request_review_id": 284597322,
    "id": 321529995,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTUyOTk5NQ==",
    "diff_hunk": "@@ -2295,6 +2295,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trustedParents) const",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, snake case - header too.",
    "created_at": "2019-09-05T23:51:48Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321529995",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529995"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321529995"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321529995/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2303,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558440",
    "pull_request_review_id": 284633375,
    "id": 321558440,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTU1ODQ0MA==",
    "diff_hunk": "@@ -2407,10 +2421,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trustedParents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trustedParents)};",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 39,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nope -- because I'm caching the trust across the entire wallet (outside the loop) rather than just a single call.",
    "created_at": "2019-09-06T02:52:19Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321558440",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558440"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321558440"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2428,
    "side": "RIGHT",
    "in_reply_to_id": 321529167
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558475",
    "pull_request_review_id": 284633424,
    "id": 321558475,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTU1ODQ3NQ==",
    "diff_hunk": "@@ -2320,8 +2326,16 @@ bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n         if (parent == nullptr)\n             return false;\n         const CTxOut& parentOut = parent->tx->vout[txin.prevout.n];\n+        // Check that this specific input being spent is trusted\n         if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE)\n             return false;\n+        // If we've already trusted this parent, continue\n+        if (trustedParents.count(parent->GetHash()))\n+            continue;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sure what you mean",
    "created_at": "2019-09-06T02:52:34Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321558475",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558475"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321558475"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2334,
    "side": "RIGHT",
    "in_reply_to_id": 321529969
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558665",
    "pull_request_review_id": 284633688,
    "id": 321558665,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTU1ODY2NQ==",
    "diff_hunk": "@@ -2295,6 +2295,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trustedParents) const",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Did we change styles?",
    "created_at": "2019-09-06T02:53:58Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321558665",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558665"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321558665"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321558665/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2303,
    "side": "RIGHT",
    "in_reply_to_id": 321529995
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321561721",
    "pull_request_review_id": 284637511,
    "id": 321561721,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTU2MTcyMQ==",
    "diff_hunk": "@@ -2295,6 +2295,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trustedParents) const",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "We settled on a variable naming style in 2017: 47d84414662",
    "created_at": "2019-09-06T03:15:17Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321561721",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321561721"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321561721"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321561721/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2303,
    "side": "RIGHT",
    "in_reply_to_id": 321529995
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321813286",
    "pull_request_review_id": 284968946,
    "id": 321813286,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTgxMzI4Ng==",
    "diff_hunk": "@@ -2320,8 +2326,16 @@ bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n         if (parent == nullptr)\n             return false;\n         const CTxOut& parentOut = parent->tx->vout[txin.prevout.n];\n+        // Check that this specific input being spent is trusted\n         if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE)\n             return false;\n+        // If we've already trusted this parent, continue\n+        if (trustedParents.count(parent->GetHash()))\n+            continue;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "got it; went ahead and did this in the entire function (rather than leave it half-styled)",
    "created_at": "2019-09-06T16:25:33Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321813286",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321813286"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321813286"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321813286/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2334,
    "side": "RIGHT",
    "in_reply_to_id": 321529969
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321822248",
    "pull_request_review_id": 284980848,
    "id": 321822248,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTgyMjI0OA==",
    "diff_hunk": "@@ -2407,10 +2421,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trustedParents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trustedParents)};",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 39,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Right, missed this is in a loop \ud83e\udd26\u200d\u2642",
    "created_at": "2019-09-06T16:50:41Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321822248",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321822248"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321822248"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321822248/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2428,
    "side": "RIGHT",
    "in_reply_to_id": 321529167
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321822360",
    "pull_request_review_id": 284981017,
    "id": 321822360,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyMTgyMjM2MA==",
    "diff_hunk": "@@ -2320,8 +2326,16 @@ bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n         if (parent == nullptr)\n             return false;\n         const CTxOut& parentOut = parent->tx->vout[txin.prevout.n];\n+        // Check that this specific input being spent is trusted\n         if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE)\n             return false;\n+        // If we've already trusted this parent, continue\n+        if (trustedParents.count(parent->GetHash()))\n+            continue;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "07858cc41a2f3cc74f281f4ac4331e26dffc9644",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yup, that was the idea.",
    "created_at": "2019-09-06T16:51:05Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321822360",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321822360"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r321822360"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/321822360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2334,
    "side": "RIGHT",
    "in_reply_to_id": 321529969
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324154009",
    "pull_request_review_id": 287964155,
    "id": 324154009,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNDE1NDAwOQ==",
    "diff_hunk": "@@ -2295,33 +2295,38 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const\n {\n     // Quick answer in most cases\n-    if (!locked_chain.checkFinalTx(*tx)) {\n-        return false;\n-    }\n+    if (!locked_chain.checkFinalTx(*tx)) return false;\n     int nDepth = GetDepthInMainChain(locked_chain);",
    "path": "src/wallet/wallet.cpp",
    "position": 16,
    "original_position": 16,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe I'm missing something but I think you could avoid calling `GetDepthInMainChain` for parents if `nDepth >= 1`?",
    "created_at": "2019-09-13T11:42:07Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324154009",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324154009"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324154009"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324154009/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2306,
    "original_line": 2306,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324154718",
    "pull_request_review_id": 287964155,
    "id": 324154718,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNDE1NDcxOA==",
    "diff_hunk": "@@ -576,6 +576,7 @@ class CWalletTx\n \n     bool InMempool() const;\n     bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;",
    "path": "src/wallet/wallet.h",
    "position": 4,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, should be private?",
    "created_at": "2019-09-13T11:44:26Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324154718",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324154718"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324154718"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324154718/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 619,
    "original_line": 619,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324156875",
    "pull_request_review_id": 287964155,
    "id": 324156875,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNDE1Njg3NQ==",
    "diff_hunk": "@@ -2295,33 +2295,38 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const\n {\n     // Quick answer in most cases\n-    if (!locked_chain.checkFinalTx(*tx)) {\n-        return false;\n-    }\n+    if (!locked_chain.checkFinalTx(*tx)) return false;\n     int nDepth = GetDepthInMainChain(locked_chain);\n-    if (nDepth >= 1)\n-        return true;\n-    if (nDepth < 0)\n-        return false;\n-    if (!pwallet->m_spend_zero_conf_change || !IsFromMe(ISMINE_ALL)) // using wtx's cached debit\n-        return false;\n+    if (nDepth >= 1) return true;\n+    if (nDepth < 0) return false;\n+    // using wtx's cached debit\n+    if (!pwallet->m_spend_zero_conf_change || !IsFromMe(ISMINE_ALL)) return false;\n \n     // Don't trust unconfirmed transactions from us unless they are in the mempool.\n-    if (!InMempool())\n-        return false;\n+    if (!InMempool()) return false;\n \n     // Trusted if all inputs are from us and are in the mempool:\n     for (const CTxIn& txin : tx->vin)\n     {\n         // Transactions not sent by us: not trusted\n         const CWalletTx* parent = pwallet->GetWalletTx(txin.prevout.hash);\n-        if (parent == nullptr)\n-            return false;\n+        if (parent == nullptr) return false;\n         const CTxOut& parentOut = parent->tx->vout[txin.prevout.n];\n-        if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE)\n-            return false;\n+        // Check that this specific input being spent is trusted\n+        if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE) return false;\n+        // If we've already trusted this parent, continue\n+        if (trusted_parents.count(parent->GetHash())) continue;",
    "path": "src/wallet/wallet.cpp",
    "position": 47,
    "original_position": 47,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You could `.insert()` here, and use the result value `.second` to know whether it was missing and then call `parent->IsTrusted`.",
    "created_at": "2019-09-13T11:51:21Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324156875",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324156875"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324156875"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324156875/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2325,
    "original_line": 2325,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414041",
    "pull_request_review_id": 288309378,
    "id": 324414041,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNDQxNDA0MQ==",
    "diff_hunk": "@@ -2295,33 +2295,38 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const\n {\n     // Quick answer in most cases\n-    if (!locked_chain.checkFinalTx(*tx)) {\n-        return false;\n-    }\n+    if (!locked_chain.checkFinalTx(*tx)) return false;\n     int nDepth = GetDepthInMainChain(locked_chain);\n-    if (nDepth >= 1)\n-        return true;\n-    if (nDepth < 0)\n-        return false;\n-    if (!pwallet->m_spend_zero_conf_change || !IsFromMe(ISMINE_ALL)) // using wtx's cached debit\n-        return false;\n+    if (nDepth >= 1) return true;\n+    if (nDepth < 0) return false;\n+    // using wtx's cached debit\n+    if (!pwallet->m_spend_zero_conf_change || !IsFromMe(ISMINE_ALL)) return false;\n \n     // Don't trust unconfirmed transactions from us unless they are in the mempool.\n-    if (!InMempool())\n-        return false;\n+    if (!InMempool()) return false;\n \n     // Trusted if all inputs are from us and are in the mempool:\n     for (const CTxIn& txin : tx->vin)\n     {\n         // Transactions not sent by us: not trusted\n         const CWalletTx* parent = pwallet->GetWalletTx(txin.prevout.hash);\n-        if (parent == nullptr)\n-            return false;\n+        if (parent == nullptr) return false;\n         const CTxOut& parentOut = parent->tx->vout[txin.prevout.n];\n-        if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE)\n-            return false;\n+        // Check that this specific input being spent is trusted\n+        if (pwallet->IsMine(parentOut) != ISMINE_SPENDABLE) return false;\n+        // If we've already trusted this parent, continue\n+        if (trusted_parents.count(parent->GetHash())) continue;",
    "path": "src/wallet/wallet.cpp",
    "position": 47,
    "original_position": 47,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm a little uncomfortable with that design because we then need to remove ourselves from the set if the recursion returns false.\r\n\r\nIt's also a bit weird because we add ourselves to the trusted set before recursion so technically there are elements not known to be trusted in the set. This is safe because the element is a child, but it's odd. ",
    "created_at": "2019-09-14T06:16:10Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324414041",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414041"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324414041"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2325,
    "original_line": 2325,
    "side": "RIGHT",
    "in_reply_to_id": 324156875
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414084",
    "pull_request_review_id": 288309430,
    "id": 324414084,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNDQxNDA4NA==",
    "diff_hunk": "@@ -2295,33 +2295,38 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const\n {\n     // Quick answer in most cases\n-    if (!locked_chain.checkFinalTx(*tx)) {\n-        return false;\n-    }\n+    if (!locked_chain.checkFinalTx(*tx)) return false;\n     int nDepth = GetDepthInMainChain(locked_chain);",
    "path": "src/wallet/wallet.cpp",
    "position": 16,
    "original_position": 16,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You're right, but we already don't recurse on trusted parents right?",
    "created_at": "2019-09-14T06:18:01Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324414084",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414084"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324414084"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2306,
    "original_line": 2306,
    "side": "RIGHT",
    "in_reply_to_id": 324154009
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414154",
    "pull_request_review_id": 288309518,
    "id": 324414154,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNDQxNDE1NA==",
    "diff_hunk": "@@ -2295,33 +2295,38 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;\n+    return IsTrusted(locked_chain, s);\n+}\n+\n+bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const\n {\n     // Quick answer in most cases\n-    if (!locked_chain.checkFinalTx(*tx)) {\n-        return false;\n-    }\n+    if (!locked_chain.checkFinalTx(*tx)) return false;\n     int nDepth = GetDepthInMainChain(locked_chain);",
    "path": "src/wallet/wallet.cpp",
    "position": 16,
    "original_position": 16,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Doh!",
    "created_at": "2019-09-14T06:21:05Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324414154",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414154"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r324414154"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/324414154/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2306,
    "original_line": 2306,
    "side": "RIGHT",
    "in_reply_to_id": 324154009
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/326309913",
    "pull_request_review_id": 290745289,
    "id": 326309913,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyNjMwOTkxMw==",
    "diff_hunk": "@@ -576,6 +576,7 @@ class CWalletTx\n \n     bool InMempool() const;\n     bool IsTrusted(interfaces::Chain::Lock& locked_chain) const;\n+    bool IsTrusted(interfaces::Chain::Lock& locked_chain, std::set<uint256>& trusted_parents) const;",
    "path": "src/wallet/wallet.h",
    "position": 4,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Actually I'd rather just get rid of the other function as usually you'd want to share the cache across IsTrusted calls...\r\n\r\nSlightly more agressive change but maybe it's ok",
    "created_at": "2019-09-19T18:02:04Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r326309913",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/326309913"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r326309913"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/326309913/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 619,
    "original_line": 619,
    "side": "RIGHT",
    "in_reply_to_id": 324154718
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/329941238",
    "pull_request_review_id": 295449381,
    "id": 329941238,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMyOTk0MTIzOA==",
    "diff_hunk": "@@ -2407,10 +2412,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trusted_parents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trusted_parents)};",
    "path": "src/wallet/wallet.cpp",
    "position": 63,
    "original_position": 63,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I would prefer to keep using the old interface here and in 2488, 3784 until the `trusted_parents` are actually used/shared.",
    "created_at": "2019-10-01T08:43:50Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r329941238",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/329941238"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r329941238"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/329941238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2418,
    "original_line": 2418,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330124848",
    "pull_request_review_id": 295695132,
    "id": 330124848,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMDEyNDg0OA==",
    "diff_hunk": "@@ -2407,10 +2412,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trusted_parents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trusted_parents)};",
    "path": "src/wallet/wallet.cpp",
    "position": 63,
    "original_position": 63,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What do you mean by \"actually used/shared\"?",
    "created_at": "2019-10-01T15:30:22Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330124848",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330124848"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330124848"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330124848/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2418,
    "original_line": 2418,
    "side": "RIGHT",
    "in_reply_to_id": 329941238
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330131687",
    "pull_request_review_id": 295704005,
    "id": 330131687,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMDEzMTY4Nw==",
    "diff_hunk": "@@ -2407,10 +2412,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trusted_parents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trusted_parents)};",
    "path": "src/wallet/wallet.cpp",
    "position": 63,
    "original_position": 63,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I mean for now, you could leave this line unchanged since `trusted_parents` is not used outside of `IsTrusted`. I know you eventually want to share the parents for optimization but I would not change this line until that is the case.",
    "created_at": "2019-10-01T15:42:54Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330131687",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330131687"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330131687"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330131687/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2418,
    "original_line": 2418,
    "side": "RIGHT",
    "in_reply_to_id": 329941238
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330147652",
    "pull_request_review_id": 295725082,
    "id": 330147652,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMDE0NzY1Mg==",
    "diff_hunk": "@@ -2407,10 +2412,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trusted_parents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trusted_parents)};",
    "path": "src/wallet/wallet.cpp",
    "position": 63,
    "original_position": 63,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not sure what the \"eventually\" or \"actually\" part is... this is what is done by the code already. Note that trusted_parents lives outside the for loop so is shared across calls.\r\n\r\nAnd it's less so optimization and more so anti-DoS.",
    "created_at": "2019-10-01T16:15:31Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330147652",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330147652"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330147652"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330147652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2418,
    "original_line": 2418,
    "side": "RIGHT",
    "in_reply_to_id": 329941238
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330157090",
    "pull_request_review_id": 295737428,
    "id": 330157090,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzMDE1NzA5MA==",
    "diff_hunk": "@@ -2407,10 +2412,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trusted_parents;\n         for (const auto& entry : mapWallet)\n         {\n             const CWalletTx& wtx = entry.second;\n-            const bool is_trusted{wtx.IsTrusted(*locked_chain)};\n+            const bool is_trusted{wtx.IsTrusted(*locked_chain, trusted_parents)};",
    "path": "src/wallet/wallet.cpp",
    "position": 63,
    "original_position": 63,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "58cb227cc07f7f00ce91ec2fa903c343769f5524",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I see, I misunderstood at which level the caching is happening, thanks!",
    "created_at": "2019-10-01T16:36:46Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330157090",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330157090"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r330157090"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/330157090/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2418,
    "original_line": 2418,
    "side": "RIGHT",
    "in_reply_to_id": 329941238
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337184938",
    "pull_request_review_id": 304779049,
    "id": 337184938,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNzE4NDkzOA==",
    "diff_hunk": "@@ -112,10 +112,10 @@ def run_test(self):\n         def test_balances(*, fee_node_1=0):",
    "path": "test/functional/wallet_balance.py",
    "position": 42,
    "original_position": 1,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "bee1dc9f8a5182f03979fa066dc7937fc945bf29",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Update wallet_balance.py test to reflect new behavior\" (bee1dc9f8a5182f03979fa066dc7937fc945bf29)\r\n\r\nYou also have a really nice description of the test setup in https://github.com/bitcoin/bitcoin/pull/16766#issuecomment-527563982 that could be nice to incorporate as a comment or link in the `test_balances` function.",
    "created_at": "2019-10-21T18:56:50Z",
    "updated_at": "2019-10-21T20:44:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r337184938",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337184938"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r337184938"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337184938/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 150,
    "original_line": 150,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338789552",
    "pull_request_review_id": 306861509,
    "id": 338789552,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODc4OTU1Mg==",
    "diff_hunk": "@@ -2294,6 +2294,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;",
    "path": "src/wallet/wallet.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "595f09d6de7f1b94428cdd1310777aa6a4c584e5",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hmm I don't know about the need of DoS protection, can't we rely on mempool DEFAULT_ANCESTOR_LIMIT there ? A transaction to be trusted has to be in-mempool (among other standards), so their unconfirmed parent too, at first parent hit which is not we should return. What's th worst complexity for a graph of 25 parents?",
    "created_at": "2019-10-24T21:00:42Z",
    "updated_at": "2019-10-24T21:22:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338789552",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338789552"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338789552"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338789552/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2298,
    "original_line": 2298,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338790225",
    "pull_request_review_id": 306861509,
    "id": 338790225,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODc5MDIyNQ==",
    "diff_hunk": "@@ -2420,10 +2420,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trustedParents;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "5dd7da4ccd1354f09e2d00bab29288db0d5665d0",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If you go with DoS protection, can't you go further and reuse the cached set of trusted parents between WalletTxToJSON call in `listtransactions` and `listsinceblock`, they are all after chain locks so shouldn't be an issue ?",
    "created_at": "2019-10-24T21:02:23Z",
    "updated_at": "2019-10-24T21:22:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338790225",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338790225"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338790225"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338790225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2423,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338792196",
    "pull_request_review_id": 306861509,
    "id": 338792196,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODc5MjE5Ng==",
    "diff_hunk": "@@ -85,6 +85,7 @@ Wallet\n ------\n \n - The wallet now by default uses bech32 addresses when using RPC, and creates native segwit change outputs.\n+- The way that output trust was computed has been fixed in #16766, which impacts confirmed/unconfirmed balance status and coin selection.",
    "path": "doc/release-notes.md",
    "position": 4,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "91f3073f08aff395dd813296bf99fd8ccc81bb27",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: maybe precise how the trust computation has been changed \"to evaluate trustiness of outpoint spent by parent and so recursively\"",
    "created_at": "2019-10-24T21:07:23Z",
    "updated_at": "2019-10-24T21:22:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338792196",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338792196"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338792196"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338792196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 88,
    "original_line": 88,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831279",
    "pull_request_review_id": 306914396,
    "id": 338831279,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODgzMTI3OQ==",
    "diff_hunk": "@@ -2294,6 +2294,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;",
    "path": "src/wallet/wallet.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "595f09d6de7f1b94428cdd1310777aa6a4c584e5",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Even so, you can imagine a case where we have a single input single output chain of 25 taking:\r\n\r\nsum n = 0 to N n = n * (n-1) /2 = O(N^2).\r\n\r\nWhich for 25 = 625 iterations.\r\n\r\nImagine what this would be for a tree with no descendants limit!\r\n\r\n\r\nThe caching guarantees that it is O(N*log(N)) worst case (could be improved possibly by switching to unordered_set... but it's worth benchmarking since we will usually have a very small set)",
    "created_at": "2019-10-24T23:19:27Z",
    "updated_at": "2019-10-24T23:19:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338831279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338831279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2298,
    "original_line": 2298,
    "side": "RIGHT",
    "in_reply_to_id": 338789552
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831601",
    "pull_request_review_id": 306914773,
    "id": 338831601,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODgzMTYwMQ==",
    "diff_hunk": "@@ -2420,10 +2420,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trustedParents;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "5dd7da4ccd1354f09e2d00bab29288db0d5665d0",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Possibly, but because it's through the interfaced call I didn't want to scope creep to include that. But it's maybe worth a follow up PR?",
    "created_at": "2019-10-24T23:20:54Z",
    "updated_at": "2019-10-24T23:20:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338831601",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831601"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338831601"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2423,
    "side": "RIGHT",
    "in_reply_to_id": 338790225
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831988",
    "pull_request_review_id": 306915268,
    "id": 338831988,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODgzMTk4OA==",
    "diff_hunk": "@@ -85,6 +85,7 @@ Wallet\n ------\n \n - The wallet now by default uses bech32 addresses when using RPC, and creates native segwit change outputs.\n+- The way that output trust was computed has been fixed in #16766, which impacts confirmed/unconfirmed balance status and coin selection.",
    "path": "doc/release-notes.md",
    "position": 4,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "91f3073f08aff395dd813296bf99fd8ccc81bb27",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not sure what level of detail is best for the release note; will leave up to maintainer discretion. Since it can be nuanced, if someone is relying on this it's best that they read the PR.",
    "created_at": "2019-10-24T23:22:41Z",
    "updated_at": "2019-10-24T23:22:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338831988",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831988"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338831988"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338831988/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 88,
    "original_line": 88,
    "side": "RIGHT",
    "in_reply_to_id": 338792196
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338832764",
    "pull_request_review_id": 306916260,
    "id": 338832764,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODgzMjc2NA==",
    "diff_hunk": "@@ -2294,6 +2294,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;",
    "path": "src/wallet/wallet.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "595f09d6de7f1b94428cdd1310777aa6a4c584e5",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I believe the worst case is O(a^n), where a is the number of inputs/output per transaction, and n is the ancestor limit. Simply build a tx graph where every transaction spends a outputs of the previous layer, in a different inputs.",
    "created_at": "2019-10-24T23:26:28Z",
    "updated_at": "2019-10-24T23:26:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338832764",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338832764"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r338832764"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338832764/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2298,
    "original_line": 2298,
    "side": "RIGHT",
    "in_reply_to_id": 338789552
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339154872",
    "pull_request_review_id": 307340842,
    "id": 339154872,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTE1NDg3Mg==",
    "diff_hunk": "@@ -2294,6 +2294,12 @@ bool CWalletTx::InMempool() const\n }\n \n bool CWalletTx::IsTrusted(interfaces::Chain::Lock& locked_chain) const\n+{\n+    std::set<uint256> s;",
    "path": "src/wallet/wallet.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "595f09d6de7f1b94428cdd1310777aa6a4c584e5",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Okay assuming complexity O(a^n), standard txn are limited by MAX_STANDARD_TX_WEIGHT and 148-bytes input, that gives you 548 inputs/outputs on every tx layer so something like 13700 iterations... Would be interesting to know how `IsTrusted` behaves on such computation order, but the fees burn for a DoS attacker seems pretty high.\r\n\r\n> Imagine what this would be for a tree with no descendants limit!\r\n\r\nNot sure why descendants limit matters there?\r\n\r\nAnyway, DoS protection is simple enough to get it for peace of mind.",
    "created_at": "2019-10-25T17:15:18Z",
    "updated_at": "2019-10-25T17:26:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r339154872",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339154872"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r339154872"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339154872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2298,
    "original_line": 2298,
    "side": "RIGHT",
    "in_reply_to_id": 338789552
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339155391",
    "pull_request_review_id": 307341533,
    "id": 339155391,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzOTE1NTM5MQ==",
    "diff_hunk": "@@ -2420,10 +2420,11 @@ CWallet::Balance CWallet::GetBalance(const int min_depth, bool avoid_reuse) cons\n     {\n         auto locked_chain = chain().lock();\n         LOCK(cs_wallet);\n+        std::set<uint256> trustedParents;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "4671fc3d9e669da8b8781f0cbefee43cb9acd527",
    "original_commit_id": "5dd7da4ccd1354f09e2d00bab29288db0d5665d0",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Really IMO but if DoS protection is worth it, it should take precedence on creeping into interfaced call. ",
    "created_at": "2019-10-25T17:16:45Z",
    "updated_at": "2019-10-25T17:16:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r339155391",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339155391"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16766#discussion_r339155391"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16766"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/339155391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2423,
    "side": "RIGHT",
    "in_reply_to_id": 338790225
  }
]