[
  {
    "sha": "32cab91278651d07a11132b7636dc3d21144e616",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMmNhYjkxMjc4NjUxZDA3YTExMTMyYjc2MzZkYzNkMjExNDRlNjE2",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2016-06-27T13:39:28Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2016-07-06T05:44:51Z"
      },
      "message": "Bump `-dbcache` default to 300MiB\n\nAlso cap the allocation for the leveldb-specific cache for the UTXO set\nto 8MiB.\nThis avoids that the extra cache memory goes to the much less effective\nleveldb cache instead of our application-level cache.",
      "tree": {
        "sha": "4accba322e45e4cea27af76f8eb92655abd822a3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4accba322e45e4cea27af76f8eb92655abd822a3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/32cab91278651d07a11132b7636dc3d21144e616",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/32cab91278651d07a11132b7636dc3d21144e616",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/32cab91278651d07a11132b7636dc3d21144e616",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/32cab91278651d07a11132b7636dc3d21144e616/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1922e5a6545835ac57e8a56aa4c4a251c07fe9e9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1922e5a6545835ac57e8a56aa4c4a251c07fe9e9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1922e5a6545835ac57e8a56aa4c4a251c07fe9e9"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 13,
      "deletions": 5
    },
    "files": [
      {
        "sha": "22a6af74e026dcd4f9843f080d5a730b00f7a611",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32cab91278651d07a11132b7636dc3d21144e616/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32cab91278651d07a11132b7636dc3d21144e616/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=32cab91278651d07a11132b7636dc3d21144e616",
        "patch": "@@ -1216,10 +1216,10 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n     nTotalCache = std::max(nTotalCache, nMinDbCache << 20); // total cache cannot be less than nMinDbCache\n     nTotalCache = std::min(nTotalCache, nMaxDbCache << 20); // total cache cannot be greated than nMaxDbcache\n     int64_t nBlockTreeDBCache = nTotalCache / 8;\n-    if (nBlockTreeDBCache > (1 << 21) && !GetBoolArg(\"-txindex\", DEFAULT_TXINDEX))\n-        nBlockTreeDBCache = (1 << 21); // block tree db cache shouldn't be larger than 2 MiB\n+    nBlockTreeDBCache = std::min(nBlockTreeDBCache, (GetBoolArg(\"-txindex\", DEFAULT_TXINDEX) ? nMaxBlockDBAndTxIndexCache : nMaxBlockDBCache) << 20);\n     nTotalCache -= nBlockTreeDBCache;\n     int64_t nCoinDBCache = std::min(nTotalCache / 2, (nTotalCache / 4) + (1 << 23)); // use 25%-50% of the remainder for disk cache\n+    nCoinDBCache = std::min(nCoinDBCache, nMaxCoinsDBCache << 20); // cap total coins db cache\n     nTotalCache -= nCoinDBCache;\n     nCoinCacheUsage = nTotalCache; // the rest goes to in-memory cache\n     LogPrintf(\"Cache configuration:\\n\");"
      },
      {
        "sha": "5b98d2792c50df4c53a3665cfdc7e4269dfa6b4c",
        "filename": "src/txdb.h",
        "status": "modified",
        "additions": 11,
        "deletions": 3,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32cab91278651d07a11132b7636dc3d21144e616/src/txdb.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32cab91278651d07a11132b7636dc3d21144e616/src/txdb.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txdb.h?ref=32cab91278651d07a11132b7636dc3d21144e616",
        "patch": "@@ -22,11 +22,19 @@ class CCoinsViewDBCursor;\n class uint256;\n \n //! -dbcache default (MiB)\n-static const int64_t nDefaultDbCache = 100;\n-//! max. -dbcache in (MiB)\n+static const int64_t nDefaultDbCache = 300;\n+//! max. -dbcache (MiB)\n static const int64_t nMaxDbCache = sizeof(void*) > 4 ? 16384 : 1024;\n-//! min. -dbcache in (MiB)\n+//! min. -dbcache (MiB)\n static const int64_t nMinDbCache = 4;\n+//! Max memory allocated to block tree DB specific cache, if no -txindex (MiB)\n+static const int64_t nMaxBlockDBCache = 2;\n+//! Max memory allocated to block tree DB specific cache, if -txindex (MiB)\n+// Unlike for the UTXO database, for the txindex scenario the leveldb cache make\n+// a meaningful difference: https://github.com/bitcoin/bitcoin/pull/8273#issuecomment-229601991\n+static const int64_t nMaxBlockDBAndTxIndexCache = 1024;\n+//! Max memory allocated to coin DB specific cache (MiB)\n+static const int64_t nMaxCoinsDBCache = 8;\n \n struct CDiskTxPos : public CDiskBlockPos\n {"
      }
    ]
  },
  {
    "sha": "efd1d8339ad9a2bb7a164e7475734a90f6fa034c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZmQxZDgzMzlhZDlhMmJiN2ExNjRlNzQ3NTczNGE5MGY2ZmEwMzRj",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2016-06-30T09:01:19Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2016-07-06T05:45:23Z"
      },
      "message": "doc: Mention dbcache increase in release notes",
      "tree": {
        "sha": "219b56a99a71abcfeb14702430185c1e485889d8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/219b56a99a71abcfeb14702430185c1e485889d8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/efd1d8339ad9a2bb7a164e7475734a90f6fa034c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/efd1d8339ad9a2bb7a164e7475734a90f6fa034c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/efd1d8339ad9a2bb7a164e7475734a90f6fa034c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/efd1d8339ad9a2bb7a164e7475734a90f6fa034c/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "32cab91278651d07a11132b7636dc3d21144e616",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/32cab91278651d07a11132b7636dc3d21144e616",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/32cab91278651d07a11132b7636dc3d21144e616"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 14,
      "deletions": 2
    },
    "files": [
      {
        "sha": "df63bb53eee2de71363327e6a9430a8de11babdb",
        "filename": "doc/release-notes.md",
        "status": "modified",
        "additions": 14,
        "deletions": 2,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/efd1d8339ad9a2bb7a164e7475734a90f6fa034c/doc/release-notes.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/efd1d8339ad9a2bb7a164e7475734a90f6fa034c/doc/release-notes.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-notes.md?ref=efd1d8339ad9a2bb7a164e7475734a90f6fa034c",
        "patch": "@@ -41,9 +41,21 @@ report issues about Windows XP to the issue tracker.\n Notable changes\n ===============\n \n-Example item\n-----------------\n+Database cache memory increased\n+--------------------------------\n+\n+As a result of growth of the UTXO set, performance with the prior default\n+database cache of 100 MiB has suffered.\n+For this reason the default was changed to 300 MiB in this release.\n+\n+For nodes on low-memory systems, the database cache can be changed back to\n+100 MiB (or to another value) by either:\n+\n+- Adding `dbcache=100` in bitcoin.conf\n+- Changing it in the GUI under `Options \u2192 Size of database cache`\n \n+Note that the database cache setting has the most performance impact\n+during initial sync of a node, and when catching up after downtime.\n \n bitcoin-cli: arguments privacy\n --------------------------------"
      }
    ]
  }
]