[
  {
    "sha": "a7328ab43ce1de502c929fd94b34f43ff1c389f4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNzMyOGFiNDNjZTFkZTUwMmM5MjlmZDk0YjM0ZjQzZmYxYzM4OWY0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-12-12T02:18:35Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-12-12T04:01:53Z"
      },
      "message": "test: Add feature_file_corruption.py",
      "tree": {
        "sha": "210c2ec4a9297ba72a86286c2fefd3d8af9fa73e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/210c2ec4a9297ba72a86286c2fefd3d8af9fa73e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a7328ab43ce1de502c929fd94b34f43ff1c389f4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a7328ab43ce1de502c929fd94b34f43ff1c389f4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a7328ab43ce1de502c929fd94b34f43ff1c389f4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a7328ab43ce1de502c929fd94b34f43ff1c389f4/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7701b62561c4d39d0e111c9894c5455087c3c778",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7701b62561c4d39d0e111c9894c5455087c3c778",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7701b62561c4d39d0e111c9894c5455087c3c778"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 32,
      "deletions": 0
    },
    "files": [
      {
        "sha": "d40dec344ab8d81c34573ed615e8ca6bc445911f",
        "filename": "test/functional/feature_file_corruption.py",
        "status": "added",
        "additions": 31,
        "deletions": 0,
        "changes": 31,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a7328ab43ce1de502c929fd94b34f43ff1c389f4/test/functional/feature_file_corruption.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a7328ab43ce1de502c929fd94b34f43ff1c389f4/test/functional/feature_file_corruption.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_file_corruption.py?ref=a7328ab43ce1de502c929fd94b34f43ff1c389f4",
        "patch": "@@ -0,0 +1,31 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2014-2018 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test reported errors on file corruption.\n+\n+See doc/files.md for a list of files.\n+\"\"\"\n+\n+import os\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+\n+\n+class FileCorruptionTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+\n+    def run_test(self):\n+        self.log.info('Test file corruption on mempool.dat')\n+        mempool_dat_path = os.path.join(self.nodes[0].datadir, 'regtest', 'mempool.dat')\n+        self.stop_nodes()\n+        with open(mempool_dat_path, 'rb+') as mempool_dat:\n+            mempool_dat.seek(9)\n+            mempool_dat.write(b'ff')\n+        with self.nodes[0].assert_debug_log(expected_msgs=['Failed to deserialize mempool data on disk']):\n+            self.start_nodes()\n+\n+\n+if __name__ == '__main__':\n+    FileCorruptionTest().main()"
      },
      {
        "sha": "8d0e6fa3b401ffa40929ea3099d029cae6dd483e",
        "filename": "test/functional/test_runner.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a7328ab43ce1de502c929fd94b34f43ff1c389f4/test/functional/test_runner.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a7328ab43ce1de502c929fd94b34f43ff1c389f4/test/functional/test_runner.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_runner.py?ref=a7328ab43ce1de502c929fd94b34f43ff1c389f4",
        "patch": "@@ -112,6 +112,7 @@\n     'wallet_txn_clone.py --segwit',\n     'rpc_getchaintips.py',\n     'interface_rest.py',\n+    'feature_file_corruption.py',\n     'mempool_spend_coinbase.py',\n     'mempool_reorg.py',\n     'mempool_persist.py',"
      }
    ]
  },
  {
    "sha": "3d01bddd2a1de98f25998487ef4798ea3698578b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozZDAxYmRkZDJhMWRlOThmMjU5OTg0ODdlZjQ3OThlYTM2OTg1Nzhi",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-12-12T02:28:11Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-12-12T04:01:53Z"
      },
      "message": "[ui] Add UIError and UIWarning",
      "tree": {
        "sha": "43847bdd6861b360b0c0067b6125e06ac2d65b94",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/43847bdd6861b360b0c0067b6125e06ac2d65b94"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3d01bddd2a1de98f25998487ef4798ea3698578b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3d01bddd2a1de98f25998487ef4798ea3698578b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3d01bddd2a1de98f25998487ef4798ea3698578b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3d01bddd2a1de98f25998487ef4798ea3698578b/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a7328ab43ce1de502c929fd94b34f43ff1c389f4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a7328ab43ce1de502c929fd94b34f43ff1c389f4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a7328ab43ce1de502c929fd94b34f43ff1c389f4"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 11,
      "deletions": 2
    },
    "files": [
      {
        "sha": "fa4354d4367de9a6592c1e08f1c44dc125d1947c",
        "filename": "src/ui_interface.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3d01bddd2a1de98f25998487ef4798ea3698578b/src/ui_interface.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3d01bddd2a1de98f25998487ef4798ea3698578b/src/ui_interface.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui_interface.cpp?ref=3d01bddd2a1de98f25998487ef4798ea3698578b",
        "patch": "@@ -59,17 +59,20 @@ void CClientUIInterface::NotifyHeaderTip(bool b, const CBlockIndex* i) { return\n void CClientUIInterface::BannedListChanged() { return g_ui_signals.BannedListChanged(); }\n \n \n-bool InitError(const std::string& str)\n+bool UIError(const std::string& str)\n {\n     uiInterface.ThreadSafeMessageBox(str, \"\", CClientUIInterface::MSG_ERROR);\n     return false;\n }\n \n-void InitWarning(const std::string& str)\n+void UIWarning(const std::string& str)\n {\n     uiInterface.ThreadSafeMessageBox(str, \"\", CClientUIInterface::MSG_WARNING);\n }\n \n+void InitWarning(const std::string& str) { return UIWarning(str); };\n+bool InitError(const std::string& str) { return UIError(str); };\n+\n std::string AmountHighWarn(const std::string& optname)\n {\n     return strprintf(_(\"%s is set very high!\"), optname);"
      },
      {
        "sha": "11ee9709508a52c3acdf3473879cbd1d1eb481ef",
        "filename": "src/ui_interface.h",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3d01bddd2a1de98f25998487ef4798ea3698578b/src/ui_interface.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3d01bddd2a1de98f25998487ef4798ea3698578b/src/ui_interface.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui_interface.h?ref=3d01bddd2a1de98f25998487ef4798ea3698578b",
        "patch": "@@ -120,6 +120,12 @@ class CClientUIInterface\n     ADD_SIGNALS_DECL_WRAPPER(BannedListChanged, void, void);\n };\n \n+/** Show warning message **/\n+void UIWarning(const std::string& str);\n+\n+/** Show error message **/\n+bool UIError(const std::string& str);\n+\n /** Show warning message **/\n void InitWarning(const std::string& str);\n "
      }
    ]
  },
  {
    "sha": "9aaf300143c3e380a91412930a37c1f3a807260c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5YWFmMzAwMTQzYzNlMzgwYTkxNDEyOTMwYTM3YzFmM2E4MDcyNjBj",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-12-12T03:10:18Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-12-12T04:01:53Z"
      },
      "message": "ui: Warn the user on corrupt mempool.dat",
      "tree": {
        "sha": "13881d4cbf21f46166bcb3a9ebf9869b2c7943fd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/13881d4cbf21f46166bcb3a9ebf9869b2c7943fd"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9aaf300143c3e380a91412930a37c1f3a807260c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9aaf300143c3e380a91412930a37c1f3a807260c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9aaf300143c3e380a91412930a37c1f3a807260c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9aaf300143c3e380a91412930a37c1f3a807260c/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3d01bddd2a1de98f25998487ef4798ea3698578b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3d01bddd2a1de98f25998487ef4798ea3698578b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3d01bddd2a1de98f25998487ef4798ea3698578b"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "1ed4fb8065bd8e5337c6831266d29af7daab5932",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9aaf300143c3e380a91412930a37c1f3a807260c/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9aaf300143c3e380a91412930a37c1f3a807260c/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=9aaf300143c3e380a91412930a37c1f3a807260c",
        "patch": "@@ -4749,7 +4749,7 @@ bool LoadMempool()\n             mempool.PrioritiseTransaction(i.first, i.second);\n         }\n     } catch (const std::exception& e) {\n-        LogPrintf(\"Failed to deserialize mempool data on disk: %s. Continuing anyway.\\n\", e.what());\n+        UIWarning(strprintf(\"Failed to deserialize mempool data on disk: %s. Continuing anyway.\\n\", e.what()));\n         return false;\n     }\n "
      },
      {
        "sha": "8ac70c78769e884414bcdaa28dd0001a2fccf0d0",
        "filename": "test/functional/feature_file_corruption.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9aaf300143c3e380a91412930a37c1f3a807260c/test/functional/feature_file_corruption.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9aaf300143c3e380a91412930a37c1f3a807260c/test/functional/feature_file_corruption.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_file_corruption.py?ref=9aaf300143c3e380a91412930a37c1f3a807260c",
        "patch": "@@ -25,6 +25,7 @@ def run_test(self):\n             mempool_dat.write(b'ff')\n         with self.nodes[0].assert_debug_log(expected_msgs=['Failed to deserialize mempool data on disk']):\n             self.start_nodes()\n+        self.stop_node(0, expected_stderr='Warning: Failed to deserialize mempool data on disk: CAutoFile::read: end of file: iostream error. Continuing anyway.')\n \n \n if __name__ == '__main__':"
      }
    ]
  }
]