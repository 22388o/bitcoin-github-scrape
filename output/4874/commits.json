[
  {
    "sha": "21f139b4a622f07679f1d1c30ad32e2b40a2617e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMWYxMzliNGE2MjJmMDc2NzlmMWQxYzMwYWQzMmUyYjQwYTI2MTdl",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2014-09-06T02:55:54Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2014-09-08T18:42:46Z"
      },
      "message": "qt: fix tablet crash. closes #4854.\n\nThis backports the relevant parts of:\nhttps://codereview.qt-project.org/#/c/82689/",
      "tree": {
        "sha": "fd8e753338e1e752d349102494f6fce22affddb4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fd8e753338e1e752d349102494f6fce22affddb4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21f139b4a622f07679f1d1c30ad32e2b40a2617e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/21f139b4a622f07679f1d1c30ad32e2b40a2617e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/21f139b4a622f07679f1d1c30ad32e2b40a2617e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/21f139b4a622f07679f1d1c30ad32e2b40a2617e/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6ee78938ee6fda4fd80ece1eb5d736c79045eddd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6ee78938ee6fda4fd80ece1eb5d736c79045eddd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6ee78938ee6fda4fd80ece1eb5d736c79045eddd"
      }
    ],
    "stats": {
      "total": 25,
      "additions": 23,
      "deletions": 2
    },
    "files": [
      {
        "sha": "e719e2e506c41274b3b4d27b9edd568d1036dcd6",
        "filename": "depends/packages/qt.mk",
        "status": "modified",
        "additions": 3,
        "deletions": 2,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/21f139b4a622f07679f1d1c30ad32e2b40a2617e/depends/packages/qt.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/21f139b4a622f07679f1d1c30ad32e2b40a2617e/depends/packages/qt.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/qt.mk?ref=21f139b4a622f07679f1d1c30ad32e2b40a2617e",
        "patch": "@@ -7,7 +7,7 @@ $(package)_dependencies=openssl\n $(package)_linux_dependencies=freetype fontconfig dbus libxcb libX11 xproto libXext\n $(package)_build_subdir=qtbase\n $(package)_qt_libs=corelib network widgets gui plugins testlib\n-$(package)_patches=mac-qmake.conf fix-xcb-include-order.patch\n+$(package)_patches=mac-qmake.conf fix-xcb-include-order.patch qt5-tablet-osx.patch\n \n define $(package)_set_vars\n $(package)_config_opts  = -release -opensource -confirm-license\n@@ -52,7 +52,8 @@ define $(package)_preprocess_cmds\n   cp -f qtbase/mkspecs/macx-clang/Info.plist.app qtbase/mkspecs/macx-clang-linux/ &&\\\n   cp -f qtbase/mkspecs/macx-clang/qplatformdefs.h qtbase/mkspecs/macx-clang-linux/ &&\\\n   cp -f $($(package)_patch_dir)/mac-qmake.conf qtbase/mkspecs/macx-clang-linux/qmake.conf && \\\n-  patch -p1 < $($(package)_patch_dir)/fix-xcb-include-order.patch\n+  patch -p1 < $($(package)_patch_dir)/fix-xcb-include-order.patch && \\\n+  patch -p1 < $($(package)_patch_dir)/qt5-tablet-osx.patch\n endef\n \n define $(package)_config_cmds"
      },
      {
        "sha": "7deabf8d4e04262c3870e9adbc6eb4b4a185d29f",
        "filename": "depends/patches/qt/qt5-tablet-osx.patch",
        "status": "added",
        "additions": 20,
        "deletions": 0,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/21f139b4a622f07679f1d1c30ad32e2b40a2617e/depends/patches/qt/qt5-tablet-osx.patch",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/21f139b4a622f07679f1d1c30ad32e2b40a2617e/depends/patches/qt/qt5-tablet-osx.patch",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/patches/qt/qt5-tablet-osx.patch?ref=21f139b4a622f07679f1d1c30ad32e2b40a2617e",
        "patch": "@@ -0,0 +1,20 @@\n+--- old/qtbase/src/widgets/kernel/qwidgetwindow.cpp\t2014-09-05 20:45:18.717570370 -0400\n++++ new/qtbase/src/widgets/kernel/qwidgetwindow.cpp\t2014-09-05 20:52:38.653576561 -0400\n+@@ -57,7 +57,7 @@\n+ Q_WIDGETS_EXPORT extern bool qt_tab_all_widgets();\n+ \n+ QWidget *qt_button_down = 0; // widget got last button-down\n+-static QWidget *qt_tablet_target = 0;\n++static QPointer<QWidget> qt_tablet_target = 0;\n+ \n+ // popup control\n+ QWidget *qt_popup_down = 0; // popup that contains the pressed widget\n+@@ -96,8 +96,6 @@\n+ \n+ QWidgetWindow::~QWidgetWindow()\n+ {\n+-    if (m_widget == qt_tablet_target)\n+-        qt_tablet_target = 0;\n+ }\n+ \n+ #ifndef QT_NO_ACCESSIBILITY"
      }
    ]
  }
]