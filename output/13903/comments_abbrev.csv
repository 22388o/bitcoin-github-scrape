gmaxwell,2018-08-07T18:32:10Z,What happens if pruning removes the block while we're reading it?,https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-411156875,411156875,
DrahtBot,2018-08-09T22:57:47Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15159](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15159.html) ([RPC] Update getrawtransaction by amitiutta",https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-411924091,411924091,
promag,2018-08-14T00:10:23Z,"> What happens if pruning removes the block while we're reading it?\n\n@gmaxwell wouldn't the removal fail since the file is opened?",https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-412708285,412708285,
luke-jr,2018-08-27T20:45:27Z,"@promag At least on Linux ext4, opened files can be removed cleanly. It would just no longer be possible to reopen them from filename.",https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-416362671,416362671,
promag,2018-08-27T21:47:00Z,"So in that case pruning would succeed and in that case LGTM.\n\nIf `fs::remove` throws then the process terminates, otherwise `CBlockIndex` state turns wrong â€” which would require restart to fix?\n\nI'll try to reproduce.",https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-416379638,416379638,
ryanofsky,2018-09-12T21:37:15Z,"It seems there is a race condition if the block is pruned after `GetBlockPos` is called and before the block file is actually opened:\n\nhttps://github.com/bitcoin/bitcoin/blob/8f464549c46db2954d7b64d1feb200eb35f2e7e8/src/validation.cpp#L1094-L1099\n\nOn unix it should be sufficient to just hold onto `cs_main` until after the block file is opened but before it is read, but on windows I'm not s",https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-420806441,420806441,
DrahtBot,2019-01-30T16:49:12Z,<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase,https://github.com/bitcoin/bitcoin/pull/13903#issuecomment-459018612,459018612,
ryanofsky,2018-09-12T21:26:17Z,"Note: it looks like adding this lock here is just a bugfix, and not directly related to the other changes.",https://github.com/bitcoin/bitcoin/pull/13903#discussion_r217195058,217195058,src/rpc/rawtransaction.cpp
