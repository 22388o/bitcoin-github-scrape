morcos,2015-04-24T20:18:01Z,"Nice! I'm glad you looked at this.\n\nThe way you checked `pindexRescan` isn't sufficient however.  You can't assume a pruned node has all the blocks past a certain point.  Blocks are deleted from disk in the order they were written, which doesn't necessarily correspond with order in the chain.  But perhaps you could scan backwards from the Tip until you get to either `pindexRescan` or one which i",https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-96052286,96052286,
jonasschnelli,2015-04-24T20:26:41Z,Right. I did ignore the fact that blocks are not fly in in order. Will change it to your proposed way of scanning backwards.\n\n~~Same needs to be done for #6058~~ (edit: already correct there)\n,https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-96054772,96054772,
jonasschnelli,2015-04-26T12:52:47Z,Fixed `pindexRescan` check mentioned by @morcos.\n,https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-96374657,96374657,
sipa,2015-04-27T12:30:20Z,"Concept & code review ACK, but this definitely needs testing.\n",https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-96632339,96632339,
jonasschnelli,2015-04-29T11:32:00Z,Also applied an additional test during wallet catchup-rescan if the previous block has TXs but no data to be sure we have pruned this block.\n,https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-97393680,97393680,
jonasschnelli,2015-05-28T07:01:00Z,Rebased.\n,https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-106201584,106201584,
laanwj,2015-06-10T10:32:20Z,utACK.\n,https://github.com/bitcoin/bitcoin/pull/6057#issuecomment-110689301,110689301,
PRabahy,2015-04-24T22:47:45Z,"This message is unclear to me. Do you mean:\n""Rescans are not possible in pruned mode. You will need to use -reindex which will download the whole blockchain again.""?\n",https://github.com/bitcoin/bitcoin/pull/6057#discussion_r29092036,29092036,src/init.cpp
jonasschnelli,2015-04-25T06:59:23Z,Thanks!\nEnglish is not my mother language and I always struggle with it.\nFeel free to also correct/rewrite the other warnings and errors (as well as the code comments).\n,https://github.com/bitcoin/bitcoin/pull/6057#discussion_r29098551,29098551,src/init.cpp
luke-jr,2015-06-02T02:58:00Z,"What prevents this error if the user has passed -reindex? In particular, a pruned node may not have the space for the whole blockchain, and may need to redownload it with pruning enabled.\n\n(... btw, does -reindex actually work correctly with pruned data? I think last time I tried, it ignored blocks after the first missing one, and redownloaded/reappended them...)\n",https://github.com/bitcoin/bitcoin/pull/6057#discussion_r31490030,31490030,src/init.cpp
