[
  {
    "sha": "198fb229a4196aebe264a9fb10558db394e386c5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxOThmYjIyOWE0MTk2YWViZTI2NGE5ZmIxMDU1OGRiMzk0ZTM4NmM1",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-01-07T17:12:39Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-01-21T21:16:28Z"
      },
      "message": "Add DEBUG_LOCKCONTENTION, to warn each time a thread waits to lock.\n\nIf compiled with -DDEBUG_LOCKCONTENTION, Bitcoin will print to\ndebug.log each time a thread has to wait for a lock to continue.",
      "tree": {
        "sha": "75a3d9a1bdb906fd012689860ec1fd1b74df7a30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/75a3d9a1bdb906fd012689860ec1fd1b74df7a30"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/198fb229a4196aebe264a9fb10558db394e386c5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/198fb229a4196aebe264a9fb10558db394e386c5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/198fb229a4196aebe264a9fb10558db394e386c5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/198fb229a4196aebe264a9fb10558db394e386c5/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "1240a1b0a82e0e944a6fdcf6ff26001e1bd68904",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1240a1b0a82e0e944a6fdcf6ff26001e1bd68904",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1240a1b0a82e0e944a6fdcf6ff26001e1bd68904"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 22,
      "deletions": 1
    },
    "files": [
      {
        "sha": "6a4c2a2ef31ced19026fa30a28bbb69b73ab685b",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 1,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/198fb229a4196aebe264a9fb10558db394e386c5/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/198fb229a4196aebe264a9fb10558db394e386c5/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=198fb229a4196aebe264a9fb10558db394e386c5",
        "patch": "@@ -1153,7 +1153,18 @@ static void pop_lock()\n void CCriticalSection::Enter(const char* pszName, const char* pszFile, int nLine)\n {\n     push_lock(this, CLockLocation(pszName, pszFile, nLine));\n+#ifdef DEBUG_LOCKCONTENTION\n+    bool result = mutex.try_lock();\n+    if (!result)\n+    {\n+        printf(\"LOCKCONTENTION: %s\\n\", pszName);\n+        printf(\"Locker: %s:%d\\n\", pszFile, nLine);\n+        mutex.lock();\n+        printf(\"Locked\\n\");\n+    }\n+#else\n     mutex.lock();\n+#endif\n }\n void CCriticalSection::Leave()\n {\n@@ -1170,9 +1181,19 @@ bool CCriticalSection::TryEnter(const char* pszName, const char* pszFile, int nL\n \n #else\n \n-void CCriticalSection::Enter(const char*, const char*, int)\n+void CCriticalSection::Enter(const char* pszName, const char* pszFile, int nLine)\n {\n+#ifdef DEBUG_LOCKCONTENTION\n+    bool result = mutex.try_lock();\n+    if (!result)\n+    {\n+        printf(\"LOCKCONTENTION: %s\\n\", pszName);\n+        printf(\"Locker: %s:%d\\n\", pszFile, nLine);\n+        mutex.lock();\n+    }\n+#else\n     mutex.lock();\n+#endif\n }\n \n void CCriticalSection::Leave()"
      }
    ]
  }
]