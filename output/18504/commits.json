[
  {
    "sha": "0660119ac372c2863d14060ac1bc9bc243771f94",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowNjYwMTE5YWMzNzJjMjg2M2QxNDA2MGFjMWJjOWJjMjQzNzcxZjk0",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-04-02T12:28:11Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-04-02T12:28:11Z"
      },
      "message": "Drop unintended bitcoin-tx dependency on libevent\n\nDon't include util/url.cpp to libbitcoin_util.a when libevent isn't available.\nThis fixes a compile error trying to build bitcoin-tx without libevent reported\nby Luke Dashjr in https://github.com/bitcoin/bitcoin/issues/18465\n\nFixes #18465",
      "tree": {
        "sha": "533a8cb84193e626ae3787fe4b7ccc7d165c5e3f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/533a8cb84193e626ae3787fe4b7ccc7d165c5e3f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0660119ac372c2863d14060ac1bc9bc243771f94",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0660119ac372c2863d14060ac1bc9bc243771f94",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0660119ac372c2863d14060ac1bc9bc243771f94",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0660119ac372c2863d14060ac1bc9bc243771f94/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5c1ba3a10a18c6edee20f27f3609ffbbbaa2e8f3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5c1ba3a10a18c6edee20f27f3609ffbbbaa2e8f3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5c1ba3a10a18c6edee20f27f3609ffbbbaa2e8f3"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 8,
      "deletions": 3
    },
    "files": [
      {
        "sha": "6ec40461c2adcd99965486308e490ed09ff8de03",
        "filename": "build_msvc/libbitcoin_util/libbitcoin_util.vcxproj.in",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0660119ac372c2863d14060ac1bc9bc243771f94/build_msvc/libbitcoin_util/libbitcoin_util.vcxproj.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0660119ac372c2863d14060ac1bc9bc243771f94/build_msvc/libbitcoin_util/libbitcoin_util.vcxproj.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/libbitcoin_util/libbitcoin_util.vcxproj.in?ref=0660119ac372c2863d14060ac1bc9bc243771f94",
        "patch": "@@ -8,6 +8,7 @@\n     <ConfigurationType>StaticLibrary</ConfigurationType>\n   </PropertyGroup>\n   <ItemGroup>\n+    <ClCompile Include=\"..\\..\\src\\util\\url.cpp\" />\n @SOURCE_FILES@\n   </ItemGroup>\n   <Import Project=\"$(VCTargetsPath)\\Microsoft.Cpp.props\" />"
      },
      {
        "sha": "177dbeef9eb62b91883975b44c972913310c478d",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 3,
        "deletions": 2,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0660119ac372c2863d14060ac1bc9bc243771f94/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0660119ac372c2863d14060ac1bc9bc243771f94/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=0660119ac372c2863d14060ac1bc9bc243771f94",
        "patch": "@@ -1271,7 +1271,7 @@ if test x$use_pkgconfig = xyes; then\n         BITCOIN_QT_CHECK([PKG_CHECK_MODULES([QR], [libqrencode], [have_qrencode=yes], [have_qrencode=no])])\n       fi\n       if test x$build_bitcoin_cli$build_bitcoind$bitcoin_enable_qt$use_tests$use_bench != xnonononono; then\n-        PKG_CHECK_MODULES([EVENT], [libevent],, [AC_MSG_ERROR(libevent not found.)])\n+        PKG_CHECK_MODULES([EVENT], [libevent], [use_libevent=yes], [AC_MSG_ERROR(libevent not found.)])\n         if test x$TARGET_OS != xwindows; then\n           PKG_CHECK_MODULES([EVENT_PTHREADS], [libevent_pthreads],, [AC_MSG_ERROR(libevent_pthreads not found.)])\n         fi\n@@ -1291,7 +1291,7 @@ if test x$use_pkgconfig = xyes; then\n else\n \n   if test x$build_bitcoin_cli$build_bitcoind$bitcoin_enable_qt$use_tests$use_bench != xnonononono; then\n-    AC_CHECK_HEADER([event2/event.h],, AC_MSG_ERROR(libevent headers missing),)\n+    AC_CHECK_HEADER([event2/event.h], [use_libevent=yes], AC_MSG_ERROR(libevent headers missing),)\n     AC_CHECK_LIB([event],[main],EVENT_LIBS=-levent,AC_MSG_ERROR(libevent missing))\n     if test x$TARGET_OS != xwindows; then\n       AC_CHECK_LIB([event_pthreads],[main],EVENT_PTHREADS_LIBS=-levent_pthreads,AC_MSG_ERROR(libevent_pthreads missing))\n@@ -1545,6 +1545,7 @@ AM_CONDITIONAL([ENABLE_QT_TESTS],[test x$BUILD_TEST_QT = xyes])\n AM_CONDITIONAL([ENABLE_BENCH],[test x$use_bench = xyes])\n AM_CONDITIONAL([USE_QRCODE], [test x$use_qr = xyes])\n AM_CONDITIONAL([USE_LCOV],[test x$use_lcov = xyes])\n+AM_CONDITIONAL([USE_LIBEVENT],[test x$use_libevent = xyes])\n AM_CONDITIONAL([GLIBC_BACK_COMPAT],[test x$use_glibc_compat = xyes])\n AM_CONDITIONAL([HARDEN],[test x$use_hardening = xyes])\n AM_CONDITIONAL([ENABLE_SSE42],[test x$enable_sse42 = xyes])"
      },
      {
        "sha": "c38a87a1e4bac8060106db54ec477a1e684bd51a",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0660119ac372c2863d14060ac1bc9bc243771f94/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0660119ac372c2863d14060ac1bc9bc243771f94/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=0660119ac372c2863d14060ac1bc9bc243771f94",
        "patch": "@@ -523,9 +523,12 @@ libbitcoin_util_a_SOURCES = \\\n   util/strencodings.cpp \\\n   util/string.cpp \\\n   util/time.cpp \\\n-  util/url.cpp \\\n   $(BITCOIN_CORE_H)\n \n+if USE_LIBEVENT\n+libbitcoin_util_a_SOURCES += util/url.cpp\n+endif\n+\n if GLIBC_BACK_COMPAT\n libbitcoin_util_a_SOURCES += compat/glibc_compat.cpp\n AM_LDFLAGS += $(COMPAT_LDFLAGS)"
      }
    ]
  },
  {
    "sha": "01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMWEzMzkyYjFiNzc4ZmE0ZmNmNTY4MDEzMzI2ZDZlYTFkZTRmYjNi",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-04-02T12:35:10Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-04-02T12:35:10Z"
      },
      "message": "Drop bitcoin-wallet dependency on libevent\n\nDon't require urlDecode function in wallet code since urlDecode implementation\ncurrently uses libevent. Just call urlDecode indirectly though URL_DECODE\nfunction pointer constant if available.\n\nIn bitcoind and bitcoin-qt, URL_DECODE is implemented and used to interpret RPC\nwallet requests. In bitcoin-wallet, URL_DECODE is null to avoid depending on\nlibevent.",
      "tree": {
        "sha": "4a498b5cc8d1121e9ab7276fc335b778043cd8a2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4a498b5cc8d1121e9ab7276fc335b778043cd8a2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0660119ac372c2863d14060ac1bc9bc243771f94",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0660119ac372c2863d14060ac1bc9bc243771f94",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0660119ac372c2863d14060ac1bc9bc243771f94"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 15,
      "deletions": 3
    },
    "files": [
      {
        "sha": "3c773fb64db413b96bf5d19242c319127754107a",
        "filename": "src/bitcoin-cli.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/bitcoin-cli.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/bitcoin-cli.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-cli.cpp?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -15,6 +15,7 @@\n #include <util/strencodings.h>\n #include <util/system.h>\n #include <util/translation.h>\n+#include <util/url.h>\n \n #include <functional>\n #include <memory>\n@@ -29,6 +30,7 @@\n #include <compat/stdin.h>\n \n const std::function<std::string(const char*)> G_TRANSLATION_FUN = nullptr;\n+UrlDecodeFn* const URL_DECODE = urlDecode;\n \n static const char DEFAULT_RPCCONNECT[] = \"127.0.0.1\";\n static const int DEFAULT_HTTP_CLIENT_TIMEOUT=900;"
      },
      {
        "sha": "76152a81d843f360586b5405ad88cd2ffe490905",
        "filename": "src/bitcoin-wallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/bitcoin-wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/bitcoin-wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-wallet.cpp?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -11,11 +11,13 @@\n #include <logging.h>\n #include <util/system.h>\n #include <util/translation.h>\n+#include <util/url.h>\n #include <wallet/wallettool.h>\n \n #include <functional>\n \n const std::function<std::string(const char*)> G_TRANSLATION_FUN = nullptr;\n+UrlDecodeFn* const URL_DECODE = nullptr;\n \n static void SetupWalletToolArgs()\n {"
      },
      {
        "sha": "f26eb45fcea74c7934e99674d22e321517b810c8",
        "filename": "src/bitcoind.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/bitcoind.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/bitcoind.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoind.cpp?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -20,10 +20,12 @@\n #include <util/system.h>\n #include <util/threadnames.h>\n #include <util/translation.h>\n+#include <util/url.h>\n \n #include <functional>\n \n const std::function<std::string(const char*)> G_TRANSLATION_FUN = nullptr;\n+UrlDecodeFn* const URL_DECODE = urlDecode;\n \n static void WaitForShutdown(NodeContext& node)\n {"
      },
      {
        "sha": "607cf9f9760d52e61919395347815da0bb2874cd",
        "filename": "src/qt/main.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/qt/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/qt/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/main.cpp?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -5,6 +5,7 @@\n #include <qt/bitcoin.h>\n \n #include <util/translation.h>\n+#include <util/url.h>\n \n #include <QCoreApplication>\n \n@@ -15,5 +16,6 @@\n extern const std::function<std::string(const char*)> G_TRANSLATION_FUN = [](const char* psz) {\n     return QCoreApplication::translate(\"bitcoin-core\", psz).toStdString();\n };\n+UrlDecodeFn* const URL_DECODE = urlDecode;\n \n int main(int argc, char* argv[]) { return GuiMain(argc, argv); }"
      },
      {
        "sha": "b7f5dcfe43b763b58abdc96d1e261dc6e497de3b",
        "filename": "src/test/util/setup_common.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/test/util/setup_common.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/test/util/setup_common.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/setup_common.cpp?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -27,12 +27,14 @@\n #include <util/string.h>\n #include <util/time.h>\n #include <util/translation.h>\n+#include <util/url.h>\n #include <validation.h>\n #include <validationinterface.h>\n \n #include <functional>\n \n const std::function<std::string(const char*)> G_TRANSLATION_FUN = nullptr;\n+UrlDecodeFn* const URL_DECODE = nullptr;\n \n FastRandomContext g_insecure_rand_ctx;\n /** Random context to get unique temp data dirs. Separate from g_insecure_rand_ctx, which can be seeded from a const env var */"
      },
      {
        "sha": "be9f1c9e8a77de2c9999303f533fb55b9af8cede",
        "filename": "src/util/url.h",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/util/url.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/util/url.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/url.h?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -7,6 +7,8 @@\n \n #include <string>\n \n-std::string urlDecode(const std::string &urlEncoded);\n+using UrlDecodeFn = std::string(const std::string& url_encoded);\n+UrlDecodeFn urlDecode;\n+extern UrlDecodeFn* const URL_DECODE;\n \n #endif // BITCOIN_UTIL_URL_H"
      },
      {
        "sha": "9dd684a94c0b134ebe309e4b96f5a816ae52fb4a",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01a3392b1b778fa4fcf568013326d6ea1de4fb3b/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=01a3392b1b778fa4fcf568013326d6ea1de4fb3b",
        "patch": "@@ -77,9 +77,9 @@ bool HaveKey(const SigningProvider& wallet, const CKey& key)\n \n bool GetWalletNameFromJSONRPCRequest(const JSONRPCRequest& request, std::string& wallet_name)\n {\n-    if (request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n+    if (URL_DECODE && request.URI.substr(0, WALLET_ENDPOINT_BASE.size()) == WALLET_ENDPOINT_BASE) {\n         // wallet endpoint was used\n-        wallet_name = urlDecode(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n+        wallet_name = URL_DECODE(request.URI.substr(WALLET_ENDPOINT_BASE.size()));\n         return true;\n     }\n     return false;"
      }
    ]
  }
]