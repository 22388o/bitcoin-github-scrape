gmaxwell,2017-05-06T08:16:12Z,Concept ACK.  I suppose this timeout could later be made dynamic like has been proposed block transfer timeouts.,https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-299624029,299624029,
sdaftuar,2017-05-08T18:33:11Z,Rebased after #10189.,https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-299951955,299951955,
jonasschnelli,2017-05-09T06:25:28Z,"utACK ca4aebd3c50bc424afd25a5611a6ea1e77429413\n\nFor the hybrid SPV mode (#9483), a fast headers sync is crucial and also for normal operations, someone could significant delay your initial sync.\nIf you connect to a malicious or just a very slow peer (It happened to me a couple of times), couldn't you  – in theory – spend a couple of hours syncing headers? Even after this PR, I guess a peer c",https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-300072776,300072776,
sdaftuar,2017-05-09T12:28:50Z,"> If you connect to a malicious or just a very slow peer (It happened to me a couple of times), couldn't you – in theory – spend a couple of hours syncing headers? Even after this PR, I guess a peer could serve you the 2k headers package every 10minutes (while pong accordingly) leading to a header sync of more then 30h.\n\n@jonasschnelli After this PR, if you have started syncing headers from yo",https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-300147692,300147692,
jonasschnelli,2017-05-09T12:34:50Z,"Thanks @sdaftuar for the explanation. Make sense.\nI thought the timer resets after each headers message. A 20min delay hurts but is probably unavoidable (the fact that we don't know the bandwidth limitations and potentials).",https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-300149090,300149090,
sdaftuar,2017-05-10T17:06:17Z,"Addressed @TheBlueMatt's nit in a fixup commit, let me know if I can squash.",https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-300548572,300548572,
jnewbery,2017-05-22T20:46:58Z,re-utACK https://github.com/bitcoin/bitcoin/commit/595d51c2b746c4473a02e0417dd42c840b1f589c,https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-303215506,303215506,
sdaftuar,2017-06-05T20:34:29Z,Squashed 65e300812 -> 76f74811c,https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-306297250,306297250,
laanwj,2017-06-06T10:23:36Z,utACK 76f7481,https://github.com/bitcoin/bitcoin/pull/10345#issuecomment-306444754,306444754,
MarcoFalke,2017-05-08T17:59:20Z,"```gcc\nerror: ‘const NodeId CNode::id’ is private within this context",https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115312237,115312237,src/net_processing.cpp
paveljanik,2017-05-08T18:56:09Z,It should be `pto->GetId()`.,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115325581,115325581,src/net_processing.cpp
jonasschnelli,2017-05-09T06:16:13Z,nit: `Once we've caught up once`,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115414242,115414242,src/net_processing.cpp
sdaftuar,2017-05-09T14:21:58Z,Improved the comment in 898fc2ac689aa77e74362aa27d12120256c1942e.,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115502373,115502373,src/net_processing.cpp
TheBlueMatt,2017-05-09T17:50:40Z,I believe usually its good practice to print if we would otherwise have disconnected a whitelisted peer.,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115555913,115555913,src/net_processing.cpp
TheBlueMatt,2017-05-09T17:54:14Z,If I can take this opportunity to bikeshed your constants - why even bother with a base timeout this high? maybe just a minute (to handle the really-close-to-done-dont-want-a-1ms-timeout case) and then double/tripple the TIMEOUT_PER_HEADER?,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115556822,115556822,src/net_processing.h
sdaftuar,2017-05-10T16:39:12Z,"I just wanted to do something clearly safe (it's easy to reason about booting your sync peer potentially every 15 minutes, but slightly scarier to think there could be a circumstance you'd boot that peer every 1 minute).\n\nAnyway I'd like to see what other opinions are, I'm fine adjusting them however people would like...",https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115791043,115791043,src/net_processing.h
sdaftuar,2017-05-10T17:05:04Z,Fixed in a27ff02f537a3225372e1e1286f0a93fb9037ba9,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r115796792,115796792,src/net_processing.cpp
jnewbery,2017-05-22T20:03:43Z,"`nPreferredDownload - state.fPreferredDownload >= 1` was slightly confusing for me. It's saying we should only timeout a peer if we have another peer which is preferred. This doesn't exactly match the logic in `SendMessages()` where we'll try to start block sync from a non-preferred peer if we don't have any better options.\n\nI think this is fine. It's not obvious that we should time out a peer",https://github.com/bitcoin/bitcoin/pull/10345#discussion_r117833095,117833095,src/net_processing.cpp
sdaftuar,2017-05-22T20:38:16Z,Added a comment in 595d51c,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r117839792,117839792,src/net_processing.cpp
TheBlueMatt,2017-06-01T15:01:30Z,"""downleading""",https://github.com/bitcoin/bitcoin/pull/10345#discussion_r119639235,119639235,src/net_processing.cpp
TheBlueMatt,2017-06-01T16:08:59Z,"Additionally, it would be nice to unset this peer as fSyncStarted so that we pick another peer to donwnload from, in case the whitelisted sync peer is broken.",https://github.com/bitcoin/bitcoin/pull/10345#discussion_r119658608,119658608,src/net_processing.cpp
sdaftuar,2017-06-01T17:45:41Z,Addressed both of these comments in https://github.com/bitcoin/bitcoin/pull/10345/commits/65e300812f7ebc10c80a625d31a2b55a89db4348,https://github.com/bitcoin/bitcoin/pull/10345#discussion_r119683082,119683082,src/net_processing.cpp
