[
  {
    "sha": "42071ca2640c6de156d72a32b52bff1020c4a38d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MjA3MWNhMjY0MGM2ZGUxNTZkNzJhMzJiNTJiZmYxMDIwYzRhMzhk",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T02:03:12Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T02:03:12Z"
      },
      "message": "Make fDisconnect an std::atomic",
      "tree": {
        "sha": "2b1eb4b2214ed1b489df5ee079c69a792998b75d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2b1eb4b2214ed1b489df5ee079c69a792998b75d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/42071ca2640c6de156d72a32b52bff1020c4a38d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42071ca2640c6de156d72a32b52bff1020c4a38d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/42071ca2640c6de156d72a32b52bff1020c4a38d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42071ca2640c6de156d72a32b52bff1020c4a38d/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bc121b0eb19713ec72002b5be03ba5ac35903a17",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bc121b0eb19713ec72002b5be03ba5ac35903a17",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bc121b0eb19713ec72002b5be03ba5ac35903a17"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "31385c231ec2ae1b3583257a17d5d3707e31874b",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/42071ca2640c6de156d72a32b52bff1020c4a38d/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/42071ca2640c6de156d72a32b52bff1020c4a38d/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=42071ca2640c6de156d72a32b52bff1020c4a38d",
        "patch": "@@ -630,7 +630,7 @@ class CNode\n     const bool fInbound;\n     bool fNetworkNode;\n     bool fSuccessfullyConnected;\n-    bool fDisconnect;\n+    std::atomic_bool fDisconnect;\n     // We use fRelayTxes for two purposes -\n     // a) it allows us to not relay tx invs before receiving the peer's version message\n     // b) the peer may tell us in its version message that we should not relay tx invs"
      }
    ]
  },
  {
    "sha": "047ea1052d4f20c762b1b75099c8421932021b8a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowNDdlYTEwNTJkNGYyMGM3NjJiMWI3NTA5OWM4NDIxOTMyMDIxYjhh",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T05:52:44Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T23:42:48Z"
      },
      "message": "Make fImporting an std::atomic",
      "tree": {
        "sha": "e1630aa6a723ffc27408f2612704c875743f715d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e1630aa6a723ffc27408f2612704c875743f715d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/047ea1052d4f20c762b1b75099c8421932021b8a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/047ea1052d4f20c762b1b75099c8421932021b8a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/047ea1052d4f20c762b1b75099c8421932021b8a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/047ea1052d4f20c762b1b75099c8421932021b8a/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "42071ca2640c6de156d72a32b52bff1020c4a38d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42071ca2640c6de156d72a32b52bff1020c4a38d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/42071ca2640c6de156d72a32b52bff1020c4a38d"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "d1ff8699e956c113f91b2fc2641064536cadb9a7",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/047ea1052d4f20c762b1b75099c8421932021b8a/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/047ea1052d4f20c762b1b75099c8421932021b8a/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=047ea1052d4f20c762b1b75099c8421932021b8a",
        "patch": "@@ -68,7 +68,7 @@ int64_t nTimeBestReceived = 0; // Used only to inform the wallet of when we last\n CWaitableCriticalSection csBestBlock;\n CConditionVariable cvBlockChange;\n int nScriptCheckThreads = 0;\n-bool fImporting = false;\n+std::atomic_bool fImporting(false);\n bool fReindex = false;\n bool fTxIndex = false;\n bool fHavePruned = false;"
      },
      {
        "sha": "c98ed057262db65ffa7f3cebc9290241feeae9db",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/047ea1052d4f20c762b1b75099c8421932021b8a/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/047ea1052d4f20c762b1b75099c8421932021b8a/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=047ea1052d4f20c762b1b75099c8421932021b8a",
        "patch": "@@ -165,7 +165,7 @@ extern uint64_t nLastBlockWeight;\n extern const std::string strMessageMagic;\n extern CWaitableCriticalSection csBestBlock;\n extern CConditionVariable cvBlockChange;\n-extern bool fImporting;\n+extern std::atomic_bool fImporting;\n extern bool fReindex;\n extern int nScriptCheckThreads;\n extern bool fTxIndex;"
      }
    ]
  },
  {
    "sha": "dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYmZhYWRlNzJhOWQ5YzFlNTAzYzQ3ZjhlMTJkMjZiMTU0MGE5MjFi",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T02:11:25Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T23:42:55Z"
      },
      "message": "Fix AddrMan locking",
      "tree": {
        "sha": "9236d5480ab521555e3729446b4f4c57ba243883",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9236d5480ab521555e3729446b4f4c57ba243883"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbfaade72a9d9c1e503c47f8e12d26b1540a921b/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "047ea1052d4f20c762b1b75099c8421932021b8a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/047ea1052d4f20c762b1b75099c8421932021b8a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/047ea1052d4f20c762b1b75099c8421932021b8a"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 10,
      "deletions": 13
    },
    "files": [
      {
        "sha": "d466eefb82e52ba7f85bbcb05dd5abd5c5ba5368",
        "filename": "src/addrman.h",
        "status": "modified",
        "additions": 10,
        "deletions": 13,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbfaade72a9d9c1e503c47f8e12d26b1540a921b/src/addrman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbfaade72a9d9c1e503c47f8e12d26b1540a921b/src/addrman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.h?ref=dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
        "patch": "@@ -482,6 +482,7 @@ class CAddrMan\n     //! Return the number of (unique) addresses in all tables.\n     size_t size() const\n     {\n+        LOCK(cs); // TODO: Cache this in an atomic to avoid this overhead\n         return vRandom.size();\n     }\n \n@@ -501,13 +502,11 @@ class CAddrMan\n     //! Add a single address.\n     bool Add(const CAddress &addr, const CNetAddr& source, int64_t nTimePenalty = 0)\n     {\n+        LOCK(cs);\n         bool fRet = false;\n-        {\n-            LOCK(cs);\n-            Check();\n-            fRet |= Add_(addr, source, nTimePenalty);\n-            Check();\n-        }\n+        Check();\n+        fRet |= Add_(addr, source, nTimePenalty);\n+        Check();\n         if (fRet)\n             LogPrint(\"addrman\", \"Added %s from %s: %i tried, %i new\\n\", addr.ToStringIPPort(), source.ToString(), nTried, nNew);\n         return fRet;\n@@ -516,14 +515,12 @@ class CAddrMan\n     //! Add multiple addresses.\n     bool Add(const std::vector<CAddress> &vAddr, const CNetAddr& source, int64_t nTimePenalty = 0)\n     {\n+        LOCK(cs);\n         int nAdd = 0;\n-        {\n-            LOCK(cs);\n-            Check();\n-            for (std::vector<CAddress>::const_iterator it = vAddr.begin(); it != vAddr.end(); it++)\n-                nAdd += Add_(*it, source, nTimePenalty) ? 1 : 0;\n-            Check();\n-        }\n+        Check();\n+        for (std::vector<CAddress>::const_iterator it = vAddr.begin(); it != vAddr.end(); it++)\n+            nAdd += Add_(*it, source, nTimePenalty) ? 1 : 0;\n+        Check();\n         if (nAdd)\n             LogPrint(\"addrman\", \"Added %i addresses from %s: %i tried, %i new\\n\", nAdd, source.ToString(), nTried, nNew);\n         return nAdd > 0;"
      }
    ]
  },
  {
    "sha": "303352286f2af0f12fd5ae7f65ad48330b5a00ec",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMDMzNTIyODZmMmFmMGYxMmZkNWFlN2Y2NWFkNDgzMzBiNWEwMGVj",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T02:13:48Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T23:42:55Z"
      },
      "message": "Remove double brackets in addrman",
      "tree": {
        "sha": "3cc87b312389d039b05debfc8ba3837963d4f81c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3cc87b312389d039b05debfc8ba3837963d4f81c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/303352286f2af0f12fd5ae7f65ad48330b5a00ec",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/303352286f2af0f12fd5ae7f65ad48330b5a00ec",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/303352286f2af0f12fd5ae7f65ad48330b5a00ec",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/303352286f2af0f12fd5ae7f65ad48330b5a00ec/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbfaade72a9d9c1e503c47f8e12d26b1540a921b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dbfaade72a9d9c1e503c47f8e12d26b1540a921b"
      }
    ],
    "stats": {
      "total": 30,
      "additions": 12,
      "deletions": 18
    },
    "files": [
      {
        "sha": "76e7b210f7c3404f37568c6df8bf300958957d9e",
        "filename": "src/addrman.h",
        "status": "modified",
        "additions": 12,
        "deletions": 18,
        "changes": 30,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/303352286f2af0f12fd5ae7f65ad48330b5a00ec/src/addrman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/303352286f2af0f12fd5ae7f65ad48330b5a00ec/src/addrman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.h?ref=303352286f2af0f12fd5ae7f65ad48330b5a00ec",
        "patch": "@@ -529,23 +529,19 @@ class CAddrMan\n     //! Mark an entry as accessible.\n     void Good(const CService &addr, int64_t nTime = GetAdjustedTime())\n     {\n-        {\n-            LOCK(cs);\n-            Check();\n-            Good_(addr, nTime);\n-            Check();\n-        }\n+        LOCK(cs);\n+        Check();\n+        Good_(addr, nTime);\n+        Check();\n     }\n \n     //! Mark an entry as connection attempted to.\n     void Attempt(const CService &addr, bool fCountFailure, int64_t nTime = GetAdjustedTime())\n     {\n-        {\n-            LOCK(cs);\n-            Check();\n-            Attempt_(addr, fCountFailure, nTime);\n-            Check();\n-        }\n+        LOCK(cs);\n+        Check();\n+        Attempt_(addr, fCountFailure, nTime);\n+        Check();\n     }\n \n     /**\n@@ -579,12 +575,10 @@ class CAddrMan\n     //! Mark an entry as currently-connected-to.\n     void Connected(const CService &addr, int64_t nTime = GetAdjustedTime())\n     {\n-        {\n-            LOCK(cs);\n-            Check();\n-            Connected_(addr, nTime);\n-            Check();\n-        }\n+        LOCK(cs);\n+        Check();\n+        Connected_(addr, nTime);\n+        Check();\n     }\n \n     void SetServices(const CService &addr, ServiceFlags nServices)"
      }
    ]
  },
  {
    "sha": "dfed983f19e7b61da243362f00fa3a14c92dae45",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZmVkOTgzZjE5ZTdiNjFkYTI0MzM2MmYwMGZhM2ExNGM5MmRhZTQ1",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T03:29:55Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2016-11-26T23:42:55Z"
      },
      "message": "Fix unlocked access to vNodes.size()",
      "tree": {
        "sha": "3b4a4a38751cb63e48a9a02e0c3637c5c539e813",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3b4a4a38751cb63e48a9a02e0c3637c5c539e813"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dfed983f19e7b61da243362f00fa3a14c92dae45",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dfed983f19e7b61da243362f00fa3a14c92dae45",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dfed983f19e7b61da243362f00fa3a14c92dae45",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dfed983f19e7b61da243362f00fa3a14c92dae45/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "303352286f2af0f12fd5ae7f65ad48330b5a00ec",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/303352286f2af0f12fd5ae7f65ad48330b5a00ec",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/303352286f2af0f12fd5ae7f65ad48330b5a00ec"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 7,
      "deletions": 2
    },
    "files": [
      {
        "sha": "233c0fbc807bcb01422ff179c5f1f08d7764b021",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 2,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dfed983f19e7b61da243362f00fa3a14c92dae45/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dfed983f19e7b61da243362f00fa3a14c92dae45/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=dfed983f19e7b61da243362f00fa3a14c92dae45",
        "patch": "@@ -1103,8 +1103,13 @@ void CConnman::ThreadSocketHandler()\n                 }\n             }\n         }\n-        if(vNodes.size() != nPrevNodeCount) {\n-            nPrevNodeCount = vNodes.size();\n+        size_t vNodesSize;\n+        {\n+            LOCK(cs_vNodes);\n+            vNodesSize = vNodes.size();\n+        }\n+        if(vNodesSize != nPrevNodeCount) {\n+            nPrevNodeCount = vNodesSize;\n             if(clientInterface)\n                 clientInterface->NotifyNumConnectionsChanged(nPrevNodeCount);\n         }"
      }
    ]
  }
]