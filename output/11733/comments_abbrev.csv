fanquake,2017-11-20T13:28:01Z,"The changes to net.cpp remove 2/3 LOCKs introduced in 3c37dc40d39e1a1e56b6b0d3e660626a78656d4f, part of #9626.\n\n""This also ensures that if we return a CNode* from FindNode, we are still holding cs_vNodes if we use it for anything aside from existance-checking, fixing a stupid-unlikely race where it might be deleted out from under us.""",https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-345695069,345695069,
practicalswift,2017-11-20T13:52:28Z,@fanquake Thanks for reviewing. Good point. Would it be possible to state that locking requirement more explicitly using annotations (see #11226)? Perhaps one way to do it would be if the two uses were separated: `CNode* FindNode(â€¦)` would require holding `cs_vNodes` (which would be clearly stated using `EXCLUSIVE_LOCKS_REQUIRED(cs_vNodes)`) whereas say `bool NodeExists(â€¦)` wouldn't? Worth doing?,https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-345701383,345701383,
practicalswift,2017-11-21T09:18:43Z,@fanquake @promag Please re-review :-),https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-345964574,345964574,
practicalswift,2018-01-31T12:55:36Z,Anyone willing to review? :-),https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-361923893,361923893,
MarcoFalke,2018-01-31T14:45:27Z,Any measurable speedup by removing those? Just asking.,https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-361953381,361953381,
practicalswift,2018-01-31T15:06:21Z,"@MarcoFalke I would assume no. My goal with this PR was to achieve correct locking, so any measurable speed-up would be an unintended bonus :-)",https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-361960055,361960055,
laanwj,2018-02-14T16:26:45Z,"utACK d6f3a73, indeed makes no sense to do this locking internally as well as externally, and having the locking contained internally is better.",https://github.com/bitcoin/bitcoin/pull/11733#issuecomment-365662190,365662190,
promag,2017-11-20T15:35:17Z,I think this is necessary. cc @theuni ,https://github.com/bitcoin/bitcoin/pull/11733#discussion_r152024003,152024003,src/net.cpp
promag,2017-11-20T15:36:23Z,Same as above.,https://github.com/bitcoin/bitcoin/pull/11733#discussion_r152024315,152024315,src/net.cpp
practicalswift,2017-11-20T15:48:34Z,"Yes, see @fanquake's comment above regarding 3c37dc4 :-)",https://github.com/bitcoin/bitcoin/pull/11733#discussion_r152028211,152028211,src/net.cpp
promag,2017-11-20T15:52:40Z,Alright ðŸ˜„ ,https://github.com/bitcoin/bitcoin/pull/11733#discussion_r152029535,152029535,src/net.cpp
