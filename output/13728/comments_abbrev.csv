Empact,2018-07-20T22:35:57Z,Inspired by and built on #13720,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-406743489,406743489,
practicalswift,2018-07-21T17:59:54Z,"Concept ACK\n\nNit: macOS ships with GNU bash, albeit an ancient version. Please change ""helps ensure ongoing compatibility with BSD bash as well as GNU bash"" to something along the lines of ""helps ensure ongoing compatibility with the macOS BSD user land and the ancient version of GNU bash shipped with macOS"".\n",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-406813137,406813137,
sipa,2018-07-21T21:10:26Z,"```\n/usr/local/Homebrew/Library/Homebrew/brew.rb:12:in `<main>': Homebrew must be run under Ruby 2.3! You're running 2.0.0. (RuntimeError)\n```\n",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-406823758,406823758,
Empact,2018-07-22T01:07:36Z,~wip: Iâ€™m rolling back to 10.10~,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-406833772,406833772,
DrahtBot,2018-07-22T13:18:01Z,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-406865997,406865997,
MarcoFalke,2018-07-24T12:50:23Z,Might as well do a full depends and bitcoind build when pulling in macos anyway?,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-407395027,407395027,
scravy,2018-08-01T15:41:20Z,ACK d5d76655105d6d338dbc367ae0b54b7433ffeb38,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-409620179,409620179,
practicalswift,2018-08-06T15:31:08Z,"utACK d5d7665\n\nClosing my PR #13720 in favour of this one.",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-410748982,410748982,
MarcoFalke,2018-08-27T11:56:16Z,"There are some non-travis related changes here, which should be submitted independently, imo.\n\nI.e. all commits to b24ee7680cd1b5932cd3092113bcef2fe2db5d19 might go to a separate pull.",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-416202724,416202724,
Empact,2018-08-27T17:21:55Z,"@MarcoFalke FYI those changes are required to make the lint stage pass when also run on Mac, so I included them to make this PR green. Will extract a second PR for them in case that's helpful.",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-416300684,416300684,
Empact,2018-08-27T18:47:45Z,"~On second thought I instead set up CI runs against this PR with each of the prior commits excluded, to demonstrate the associated failure:\nsans 4874450 / empty subexpressions: https://travis-ci.org/Empact/bitcoin/builds/421218998\nsans 28d520b / SC1087: https://travis-ci.org/Empact/bitcoin/builds/421219652\nsans a442c33 / SC1117: https://travis-ci.org/Empact/bitcoin/jobs/421201432\nsans 21ff",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-416328198,416328198,
Empact,2018-09-15T16:53:50Z,Rebased for #14115. This now only adds the mac-based lint run to CI. ,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-421598766,421598766,
ken2812221,2018-09-15T17:54:23Z,"utACK 453daa0.\nMaybe put it in test stage. It takes 3 minutes to boot and 4 minutes to run the script.",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-421607498,421607498,
practicalswift,2018-09-15T18:06:09Z,"utACK 453daa0e24ae441175f413dd03460417eb4f4ee5\n\nWill be great to have this in Travis!\n\nnit: Remove Linux in PR title? :-)",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-421609148,421609148,
Empact,2018-09-16T23:14:50Z,"Moved it into a 3rd/final ""Compat"" stage. Sound good?",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-421850619,421850619,
MarcoFalke,2018-10-26T15:41:00Z,"Should be marked ""up for grabs""?",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-433451509,433451509,
fanquake,2018-10-28T09:30:17Z,"@Empact Looks like you've rebased since Marco's comment? Travis had errored out, so I restarted, but it now seems to be stalled while installing dependencies with `brew`?",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-433689504,433689504,
Empact,2019-06-09T16:27:24Z,@fanquake FYI I'm picking this back up.,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-500226303,500226303,
Empact,2019-06-09T17:03:02Z,~Currently based on #15257 in order to give myself a clean build locally. Happy to base otherwise.~,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-500228753,500228753,
Empact,2019-06-09T17:43:10Z,"~Outstanding work: need to install git with USE_LIBPCRE~\n\n> ~fatal: cannot use Perl-compatible regexes when not compiled with USE_LIBPCRE~\n\n(done)",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-500231434,500231434,
Sjors,2019-08-13T16:55:27Z,ACK eefbc9d. Looking forward to seeing more stuff tested on the macOS native build. ,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-520917697,520917697,
DrahtBot,2019-09-18T17:20:19Z,<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-532782270,532782270,
MarcoFalke,2019-10-09T18:29:53Z,"I am going to merge this under the ""experimental umbrella"", as it might be needed for  #16597",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-540129688,540129688,
MarcoFalke,2019-10-09T18:33:27Z,"It takes about 10 minutes to boot the macOS on travis. If that is too long, we can revert this.\n\nACK cd82f75a431967030d25bcfe7c4aaefe5b345a99\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nACK cd82f75a431967030d25bcfe7c4aaefe5b345a99\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9s",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-540131222,540131222,
fanquake,2019-10-09T18:34:45Z,"> It takes about 10 minutes to boot the macOS on travis.\n\n@MarcoFalke Any idea why it takes that long?\n",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-540131796,540131796,
MarcoFalke,2019-10-09T18:36:19Z,"> @MarcoFalke Any idea why it takes that long?\n\nbecause travis ðŸ¤·",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-540132392,540132392,
MarcoFalke,2019-10-10T16:34:40Z,"The backlog for macOS can be seen here: https://www.traviscistatus.com/\n\nnote to myself: It failed here: https://travis-ci.org/bitcoin/bitcoin/jobs/595893060#L2470",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-540669193,540669193,
ryanofsky,2019-10-17T02:50:05Z,"I think it's bad that this change seems to now require scripted diffs to run in the macos unix environment. It makes me less inclined to write scripted diffs if I have to somehow get them them to work in macos when I don't use the operating system, and don't have the hardware, and all the unix tools are strange and old.\n\nAlso, does this scripted-diff checking script itself not function on maco",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-542973824,542973824,
Sjors,2019-10-17T08:18:25Z,There are some tools / homebrew packages to make macOS scripts behave more like Linux. E.g. https://formulae.brew.sh/formula/gnu-sed,https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-543062234,543062234,
MarcoFalke,2019-10-17T14:34:29Z,"Ok, then lets remove this and macOS users should use the gnu utils that are provided by brew",https://github.com/bitcoin/bitcoin/pull/13728#issuecomment-543204005,543204005,
fanquake,2018-07-21T04:38:58Z,"If you mean our next supported minimum macOS version, shouldn't this be 10.10?",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r204202037,204202037,.travis.yml
Empact,2018-07-21T17:06:31Z,Thanks - was relying on faulty memory. Also it happens to be the earliest version supported by Travis. Updated. #13617,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r204215894,204215894,.travis.yml
scravy,2018-08-01T14:00:43Z,AFAIK it is not required to enumerate `osx` here.,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r206890554,206890554,.travis.yml
scravy,2018-08-01T14:01:13Z,"you can use the same stage `lint` - it will have this stage with two jobs, one in linux, one in macOS",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r206890743,206890743,.travis.yml
scravy,2018-08-01T14:01:34Z,this would not be required either if not mentioning it in the `os` section globally,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r206890862,206890862,.travis.yml
scravy,2018-08-01T14:01:46Z,this `osx` suffices,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r206890939,206890939,.travis.yml
scravy,2018-08-01T14:02:00Z,this could be `lint` as mentioned above,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r206891027,206891027,.travis.yml
scravy,2018-09-17T06:52:31Z,It says `osx_image: xcode7.3` and at the same time `could not get this working with xcode7.3`,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r217962883,217962883,.travis.yml
Empact,2018-09-19T04:21:48Z,"That's correct - I could not get the `rvm: 2.3.7` setting working in the version used here, so had to use `brew update` in the install script. Updated the comment to clarify what ""this"" is.",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r218664204,218664204,.travis.yml
MarcoFalke,2018-11-07T16:58:44Z,This command requires a formula,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r231590940,231590940,.travis/lint_04_install.sh
Empact,2018-11-09T00:24:04Z,"Yeah, sorry this is WIP. I pulled the `brew install` command from some defunct docs I think.",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r232108235,232108235,.travis/lint_04_install.sh
fanquake,2019-08-14T08:24:10Z,I'm pretty sure you can drop sudo here.,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r313758212,313758212,.travis.yml
fanquake,2019-08-14T08:32:00Z,I don't think `--with-pcre2` is a `git` install option anymore? Or is this being passed because we're using an old version of `brew` or something?,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r313761376,313761376,.travis/lint_04_install.sh
jonasschnelli,2019-10-09T13:56:21Z,Probably a good idea to add a `travis_retry` here as well,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333027510,333027510,ci/lint/04_install.sh
MarcoFalke,2019-10-09T14:03:54Z,"This has been removed, no?",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333031882,333031882,ci/lint/04_install.sh
MarcoFalke,2019-10-09T14:08:00Z,"style-nit: If you feel like running `source ./ci/test/00_setup_env.sh`, you can use `${CI_RETRY_EXE}` instead, which should also work on non travis hosts (theoretically), obviously not yet in practise. ",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333034194,333034194,ci/lint/04_install.sh
fanquake,2019-10-09T14:20:18Z,Indeed. Removed in #16961.,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333041410,333041410,ci/lint/04_install.sh
Empact,2019-10-09T14:46:49Z,[This build](https://travis-ci.org/bitcoin/bitcoin/jobs/595626506) demonstrates `--with-pcre2` is needed to run `git grep --perl-regexp` in `test/link/check-doc.py`.,https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333057211,333057211,.travis/lint_04_install.sh
Empact,2019-10-09T14:51:55Z,"Indeed, removed in #16961, and here now too. :P",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333060390,333060390,ci/lint/04_install.sh
Empact,2019-10-09T14:56:10Z,"Added `travis_retry` and switched `-s` to `--silent` for clarity.\n\n@MarcoFalke will plan on a follow-up converting the lint scripts: https://github.com/Empact/bitcoin/tree/travis-retry-lint",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333062923,333062923,ci/lint/04_install.sh
MarcoFalke,2019-10-09T18:35:07Z,"Ah, looks like setup_env is already running (because the `before_install` step is inherited.\n\nhttps://travis-ci.org/bitcoin/bitcoin/jobs/595662274#L125",https://github.com/bitcoin/bitcoin/pull/13728#discussion_r333169064,333169064,ci/lint/04_install.sh
