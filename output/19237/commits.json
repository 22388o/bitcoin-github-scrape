[
  {
    "sha": "9b8907faded8e4ec312c0dd4b4b15e1793876acd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5Yjg5MDdmYWRlZDhlNGVjMzEyYzBkZDRiNGIxNWUxNzkzODc2YWNk",
    "commit": {
      "author": {
        "name": "Elichai Turkel",
        "email": "elichai.turkel@gmail.com",
        "date": "2020-06-10T14:34:28Z"
      },
      "committer": {
        "name": "Elichai Turkel",
        "email": "elichai.turkel@gmail.com",
        "date": "2020-06-10T14:35:43Z"
      },
      "message": "Check size after Unserializing CPubKey",
      "tree": {
        "sha": "5ceaef9f84225fa096caa708ec6674964d185a6c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5ceaef9f84225fa096caa708ec6674964d185a6c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9b8907faded8e4ec312c0dd4b4b15e1793876acd",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJNBAABCAA3FiEEC5PUstyhDoo+NyfXk4PN6ejman8FAl7g778ZHGVsaWNoYWku\ndHVya2VsQGdtYWlsLmNvbQAKCRCTg83p6OZqf8l+D/wJeU63egwVuI0ZJ7bw48Q8\n7ysJq2PPCWOJal87bs+1qgIx7b0vx/5umpIPCtzsSfmN8DN4Kaaekgzsm4VMjjnh\nda029Pv+bjrSwhr2hgAl/YwKFB066eYTz+uisH32PBXVMSb6DboAkDe/TCS6K/RJ\n3Mq2H6wFV0HktPCRxg6sNRh2HZDVL7Ol0oHT6lqNm9MkNISfl3Gdf93E/f7WpFxM\nqMexmFRpuXw5q/+yN5r02nmi5j2kyHLQbzEpzsZA/jZYTjoEEknVwqZmfThLQ40n\nvSpgU0ex7IQqRm35sxGtEfJlusQyZGWtQjtZqxzQYmEHqWYpLbrS4wbIe9dAtiZJ\n/ppZtLcjtX/0Ahv3mJhzIn4FcFLCnXrjIlrKCLMUlDm/d8cQhy+n5khaIbaa79FX\nxB+vF6vzCX0TJZryxoow9VzglXpcDjnxVkgjxbLOKDUXyU1MlOkT7jRfNQfpEJ/5\nmX+JKvnKF1aHBXXm45Ed+MpfGkzwRoR3ckTbV1oBSK/KhT1Tj95JQU7posmuY4yN\n1RirtPnBiBI3W3uj1uGqsUj70DabKpAZMv+Q9vPilRj4mmi5K9DZJOIcDpZLZGHe\nnCeF/402t/XjQ5TI4cnD03qS5W0DtFGt6i8ko1XB1ZGa76TVojs3wv2j4H6DVRdZ\nqu6PRh3onYglTNKs4kwO1Q==\n=AD7x\n-----END PGP SIGNATURE-----",
        "payload": "tree 5ceaef9f84225fa096caa708ec6674964d185a6c\nparent 6762a627ecb89ba8d4ed81a049a5d802e6dd75c2\nauthor Elichai Turkel <elichai.turkel@gmail.com> 1591799668 +0300\ncommitter Elichai Turkel <elichai.turkel@gmail.com> 1591799743 +0300\n\nCheck size after Unserializing CPubKey\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9b8907faded8e4ec312c0dd4b4b15e1793876acd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9b8907faded8e4ec312c0dd4b4b15e1793876acd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9b8907faded8e4ec312c0dd4b4b15e1793876acd/comments",
    "author": {
      "login": "elichai",
      "id": 2167860,
      "node_id": "MDQ6VXNlcjIxNjc4NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2167860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elichai",
      "html_url": "https://github.com/elichai",
      "followers_url": "https://api.github.com/users/elichai/followers",
      "following_url": "https://api.github.com/users/elichai/following{/other_user}",
      "gists_url": "https://api.github.com/users/elichai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elichai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elichai/subscriptions",
      "organizations_url": "https://api.github.com/users/elichai/orgs",
      "repos_url": "https://api.github.com/users/elichai/repos",
      "events_url": "https://api.github.com/users/elichai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elichai/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "elichai",
      "id": 2167860,
      "node_id": "MDQ6VXNlcjIxNjc4NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2167860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elichai",
      "html_url": "https://github.com/elichai",
      "followers_url": "https://api.github.com/users/elichai/followers",
      "following_url": "https://api.github.com/users/elichai/following{/other_user}",
      "gists_url": "https://api.github.com/users/elichai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elichai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elichai/subscriptions",
      "organizations_url": "https://api.github.com/users/elichai/orgs",
      "repos_url": "https://api.github.com/users/elichai/repos",
      "events_url": "https://api.github.com/users/elichai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elichai/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6762a627ecb89ba8d4ed81a049a5d802e6dd75c2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6762a627ecb89ba8d4ed81a049a5d802e6dd75c2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6762a627ecb89ba8d4ed81a049a5d802e6dd75c2"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 3,
      "deletions": 0
    },
    "files": [
      {
        "sha": "4c28af4a4df29d77ef98f72a1d8e038ee7b68ec6",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9b8907faded8e4ec312c0dd4b4b15e1793876acd/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9b8907faded8e4ec312c0dd4b4b15e1793876acd/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=9b8907faded8e4ec312c0dd4b4b15e1793876acd",
        "patch": "@@ -142,6 +142,9 @@ class CPubKey\n         unsigned int len = ::ReadCompactSize(s);\n         if (len <= SIZE) {\n             s.read((char*)vch, len);\n+            if (len != size()) {\n+                Invalidate();\n+            }\n         } else {\n             // invalid pubkey, skip available data\n             char dummy;"
      }
    ]
  },
  {
    "sha": "37ae687f95c82f2d64ed880533d158060d4fc3de",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozN2FlNjg3Zjk1YzgyZjJkNjRlZDg4MDUzM2QxNTgwNjBkNGZjM2Rl",
    "commit": {
      "author": {
        "name": "Elichai Turkel",
        "email": "elichai.turkel@gmail.com",
        "date": "2020-06-15T12:28:15Z"
      },
      "committer": {
        "name": "Elichai Turkel",
        "email": "elichai.turkel@gmail.com",
        "date": "2020-06-17T11:59:36Z"
      },
      "message": "Add tests for CPubKey serialization/unserialization",
      "tree": {
        "sha": "fee66d12ac7c83369d71b4deda8a490b25d1886f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fee66d12ac7c83369d71b4deda8a490b25d1886f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/37ae687f95c82f2d64ed880533d158060d4fc3de",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQJNBAABCAA3FiEEC5PUstyhDoo+NyfXk4PN6ejman8FAl7qBagZHGVsaWNoYWku\ndHVya2VsQGdtYWlsLmNvbQAKCRCTg83p6OZqf5SdEAC9pxH/0PHPc+dxJ2lBbdT9\nJimaJB3xDnZV96JQq3Tjtt7mWZZDXrXtxrrbxTo3cVyxhkpmQzLvHSi6OnN6Uzrj\nh5xU9XpF8XE4m7/7JiPLBWkVix1evYpBu+XhClI1c359nepkOa5wT1cubOU/M6bW\nzAbMzzpYU813WlGtYL6RfmIjRqSLbakqSBYc6LT0U9rzHkWj3ur57ryi4FpUfPPa\nc+Q3gcNnFJo3UHQiNIPXq1nKgOpbwCdxWC0evoHry9gw1f9GnkAFqz4NhddqzvYh\ndhePbYhwOye4xCIiXjGd8jnUQn3Vt5G/uhMssZoLxb7hOpbsQuhHH/rXvoB9+Vr4\nWvjQYBSwRKz6BqOlnudtbaDiQ01dRzleuLR3aUVu+tN+6qXyYHSxjFCUH+xmNSnr\nCettTeR8yAmB5prkWfnaErAspD4iW89a0ztAdWxVOpGySWELWASE+0BELj2NwoMg\ni9NRToby7Mtd+PbuOW67v5UzIE2czYiMg2HGWZ1ur7RhpVMS2m/EPPasT5Ar13nA\nzLa0VS1t+mn9LkjALV5JrfW4uJN/2IoToybliN41uFgE+lguPg/o1dWdUBU6Xda5\nCd2GwmurxXxG6kJ3EYSoGfGAwVkNiXVweTy+UCt3TvLTAmjb57moOcwioHCg/+Qc\nXghZnvJ4I6+va04D7cdiXQ==\n=iTFt\n-----END PGP SIGNATURE-----",
        "payload": "tree fee66d12ac7c83369d71b4deda8a490b25d1886f\nparent 9b8907faded8e4ec312c0dd4b4b15e1793876acd\nauthor Elichai Turkel <elichai.turkel@gmail.com> 1592224095 +0300\ncommitter Elichai Turkel <elichai.turkel@gmail.com> 1592395176 +0300\n\nAdd tests for CPubKey serialization/unserialization\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/37ae687f95c82f2d64ed880533d158060d4fc3de",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/37ae687f95c82f2d64ed880533d158060d4fc3de",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/37ae687f95c82f2d64ed880533d158060d4fc3de/comments",
    "author": {
      "login": "elichai",
      "id": 2167860,
      "node_id": "MDQ6VXNlcjIxNjc4NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2167860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elichai",
      "html_url": "https://github.com/elichai",
      "followers_url": "https://api.github.com/users/elichai/followers",
      "following_url": "https://api.github.com/users/elichai/following{/other_user}",
      "gists_url": "https://api.github.com/users/elichai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elichai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elichai/subscriptions",
      "organizations_url": "https://api.github.com/users/elichai/orgs",
      "repos_url": "https://api.github.com/users/elichai/repos",
      "events_url": "https://api.github.com/users/elichai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elichai/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "elichai",
      "id": 2167860,
      "node_id": "MDQ6VXNlcjIxNjc4NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2167860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elichai",
      "html_url": "https://github.com/elichai",
      "followers_url": "https://api.github.com/users/elichai/followers",
      "following_url": "https://api.github.com/users/elichai/following{/other_user}",
      "gists_url": "https://api.github.com/users/elichai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elichai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elichai/subscriptions",
      "organizations_url": "https://api.github.com/users/elichai/orgs",
      "repos_url": "https://api.github.com/users/elichai/repos",
      "events_url": "https://api.github.com/users/elichai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elichai/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9b8907faded8e4ec312c0dd4b4b15e1793876acd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9b8907faded8e4ec312c0dd4b4b15e1793876acd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9b8907faded8e4ec312c0dd4b4b15e1793876acd"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 44,
      "deletions": 0
    },
    "files": [
      {
        "sha": "fd35537c7761b433c9982ccbdce79640a136b1d9",
        "filename": "src/test/key_tests.cpp",
        "status": "modified",
        "additions": 44,
        "deletions": 0,
        "changes": 44,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/37ae687f95c82f2d64ed880533d158060d4fc3de/src/test/key_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/37ae687f95c82f2d64ed880533d158060d4fc3de/src/test/key_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/key_tests.cpp?ref=37ae687f95c82f2d64ed880533d158060d4fc3de",
        "patch": "@@ -5,6 +5,7 @@\n #include <key.h>\n \n #include <key_io.h>\n+#include <streams.h>\n #include <test/util/setup_common.h>\n #include <uint256.h>\n #include <util/strencodings.h>\n@@ -220,4 +221,47 @@ BOOST_AUTO_TEST_CASE(key_key_negation)\n     BOOST_CHECK(key.GetPubKey().data()[0] == 0x03);\n }\n \n+static CPubKey UnserializePubkey(const std::vector<uint8_t>& data)\n+{\n+    CDataStream stream{SER_NETWORK, INIT_PROTO_VERSION};\n+    stream << data;\n+    CPubKey pubkey;\n+    stream >> pubkey;\n+    return pubkey;\n+}\n+\n+static unsigned int GetLen(unsigned char chHeader)\n+{\n+    if (chHeader == 2 || chHeader == 3)\n+        return CPubKey::COMPRESSED_SIZE;\n+    if (chHeader == 4 || chHeader == 6 || chHeader == 7)\n+        return CPubKey::SIZE;\n+    return 0;\n+}\n+\n+static void CmpSerializationPubkey(const CPubKey& pubkey)\n+{\n+    CDataStream stream{SER_NETWORK, INIT_PROTO_VERSION};\n+    stream << pubkey;\n+    CPubKey pubkey2;\n+    stream >> pubkey2;\n+    BOOST_CHECK(pubkey == pubkey2);\n+}\n+\n+BOOST_AUTO_TEST_CASE(pubkey_unserialize)\n+{\n+    for (uint8_t i = 2; i <= 7; ++i) {\n+        CPubKey key = UnserializePubkey({0x02});\n+        BOOST_CHECK(!key.IsValid());\n+        CmpSerializationPubkey(key);\n+        key = UnserializePubkey(std::vector<uint8_t>(GetLen(i), i));\n+        CmpSerializationPubkey(key);\n+        if (i == 5) {\n+            BOOST_CHECK(!key.IsValid());\n+        } else {\n+            BOOST_CHECK(key.IsValid());\n+        }\n+    }\n+}\n+\n BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  }
]