practicalswift,2021-05-24 19:49:33,"Personally I find the existing version easier to reason about. I think I'd prefer leaving this as-is, especially considering that this is consensus critical code :)",https://github.com/bitcoin/bitcoin/pull/22046#issuecomment-847292108,847292108,
MarcoFalke,2021-05-25 07:47:12,Does this improve IBD speed significantly? Otherwise it might not be worth it the review effort.,https://github.com/bitcoin/bitcoin/pull/22046#issuecomment-847634497,847634497,
zefir-k,2021-05-25 08:39:26,"> Does this improve IBD speed significantly? Otherwise it might not be worth it the review effort.\n\nI reduced the change to the relevant (one-line) part, which should be trivial to review.\n\nMaybe the overall speed improvement is not significant, but the local is obvious: if the rightest-most bottom-leaf is a copy, the flag becomes true immediately, but the (then waste) checks continue for ",https://github.com/bitcoin/bitcoin/pull/22046#issuecomment-847674273,847674273,
zefir-k,2021-05-25 13:52:05,"> I don't see significant gains. I've even tried other tweaks with the same result:\n> \n\n\nThanks, the hashing cost in fact is so dominant that the comparison operation remains below measurement accuracy:\n```\n|             ns/leaf |              leaf/s |    err% |     total | benchmark\n|--------------------:|--------------------:|--------:|----------:|:----------\n|               60.8",https://github.com/bitcoin/bitcoin/pull/22046#issuecomment-847888756,847888756,
promag,2021-05-24 20:53:55,Just `&& !mutation` here?,https://github.com/bitcoin/bitcoin/pull/22046#discussion_r638264272,638264272,src/consensus/merkle.cpp
zefir-k,2021-05-25 07:33:55,"There are two optimizations included here:\n1. stop wasting computation time once mutated gets set\n2. use the parameter value directly instead of local copy\n\nWhile the second saves one compare+assign operation and might be insignificant, the first effectively saves useless processing as the result is already known.\n\nTo me it is not only optimization but causing a trigger that something ",https://github.com/bitcoin/bitcoin/pull/22046#discussion_r638529865,638529865,src/consensus/merkle.cpp
