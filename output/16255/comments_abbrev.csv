MarcoFalke,2019-06-20 18:09:04,Will reopen after #16252,https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-504127025,504127025,
laanwj,2019-06-25 09:18:08,Concept ACK,https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-505361060,505361060,
DrahtBot,2019-06-25 17:08:44,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16273](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16273.html) (refactor: Remove unused includes by practic",https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-505536000,505536000,
laanwj,2019-06-27 11:09:22,"A side-effect of caching was that this code was only run the first call to `GetDataDir`.  Right now, it will try to create the data directory every time:\n```c++\n    if (fs::create_directories(path)) {\n        // This is the first run, create wallets subdirectory too\n        fs::create_directories(path / ""wallets"");\n    }\n```\n(this not only results in system call spam, but also a chan",https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506302568,506302568,
promag,2019-06-27 11:19:21,"> but also a change in behavior if, for some reason, the datadir disappears\n\nthat's good?\n\n@laanwj wouldn't it be better to just call `create_directories` as soon as possible, like it should belong to the startup? Currently is kind of hard to know when directories are actually created.",https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506305329,506305329,
laanwj,2019-06-27 11:51:29,"> that's good?\n\nThat definitely isn't good, if the datadir disappears while running you want the process to die as soon as possible and not mess with creating directories.\n\n> @laanwj wouldn't it be better to just call create_directories  as soon as possible, like it should belong to the startup? Currently is  kind of hard to know when directories are actually created.\n\nYes that would b",https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506314245,506314245,
MarcoFalke,2019-06-27 16:19:27,"It is indeed weird to write to disk in a method, whose name implies it is a simple getter.\n\nAdded a guard to the disk access for now, but this should be improved in the future. (See also ""Fix datadir handling"" #15864)",https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506414868,506414868,
MarcoFalke,2019-06-27 18:10:57,"I  think this is not worth it, so giving up on this for now. Someone should move out the `fs::create_directories` first.",https://github.com/bitcoin/bitcoin/pull/16255#issuecomment-506453257,506453257,
laanwj,2019-06-25 10:20:43,"happy to see this code simplified, it has been a frequent source of errors in the past",https://github.com/bitcoin/bitcoin/pull/16255#discussion_r297114457,297114457,src/util/system.cpp
