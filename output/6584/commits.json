[
  {
    "sha": "52279bc40d9754af4793ed5617e1912d37d3f7e3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1MjI3OWJjNDBkOTc1NGFmNDc5M2VkNTYxN2UxOTEyZDM3ZDNmN2Uz",
    "commit": {
      "author": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-07-15T23:24:26Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-08-24T00:45:52Z"
      },
      "message": "Optimizations: Consensus: In main::AcceptToMemoryPool, main::ConnectBlock, and miner::CreateNewBlock and\n\nIn all of them, reject transactions creating new money earlier.\nConsensus::CheckTxInputs gets nTxFee as output parameter and is separated from main::CheckInputs [renamed CheckInputsScripts]\n\n- Consensus::CheckTxInputs (called by the rest):\n\nDon't calculate nValueOut twice\nDon't check nFees < 0 twice\n\n- main::AcceptToMemoryPool:\n\nDon't call CCoinsViewCache::HaveInputs twice\nDon't calculate nValueIn 3 times\nDon't calculate nValueOut 5 times\n\n- miner::CreateNewBlock:\n\nDon't call CCoinsViewCache::HaveInputs twice\nDon't calculate nValueIn twice\nDon't calculate nValueOut 3 times\n\n- main::ConnectBlock:\n\nStill call CCoinsViewCache::HaveInputs twice\nDon't calculate nValueIn twice\nDon't calculate nValueOut 3 times",
      "tree": {
        "sha": "7a35abb2586b6d4d32fb32f42aa09cefdf998c3f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7a35abb2586b6d4d32fb32f42aa09cefdf998c3f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/52279bc40d9754af4793ed5617e1912d37d3f7e3",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52279bc40d9754af4793ed5617e1912d37d3f7e3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/52279bc40d9754af4793ed5617e1912d37d3f7e3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52279bc40d9754af4793ed5617e1912d37d3f7e3/comments",
    "author": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "49793fbb097e9f00149a054adeddad07f0444c12",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/49793fbb097e9f00149a054adeddad07f0444c12",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/49793fbb097e9f00149a054adeddad07f0444c12"
      }
    ],
    "stats": {
      "total": 107,
      "additions": 58,
      "deletions": 49
    },
    "files": [
      {
        "sha": "a6301d700f20035982a4bc9ed6ee742a8e886105",
        "filename": "src/consensus/consensus.h",
        "status": "modified",
        "additions": 23,
        "deletions": 0,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/consensus/consensus.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/consensus/consensus.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/consensus/consensus.h?ref=52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "patch": "@@ -6,11 +6,34 @@\n #ifndef BITCOIN_CONSENSUS_CONSENSUS_H\n #define BITCOIN_CONSENSUS_CONSENSUS_H\n \n+#include \"amount.h\"\n+\n+class CCoinsViewCache;\n+class CTransaction;\n+class CValidationState;\n+\n /** The maximum allowed size for a serialized block, in bytes (network rule) */\n static const unsigned int MAX_BLOCK_SIZE = 1000000;\n /** The maximum allowed number of signature check operations in a block (network rule) */\n static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Coinbase transaction outputs can only be spent after this number of new blocks (network rule) */\n static const int COINBASE_MATURITY = 100;\n \n+/**\n+ * Consensus validations:\n+ * Check_ means checking everything possible with the data provided\n+ * (that has not been checked in previous cheaper functions for the same data structure).\n+ * Verify_ means all data provided was enough for this level and its \"consensus-verified\".\n+ */\n+namespace Consensus {\n+\n+/**\n+ * Check whether all inputs of this transaction are valid (no double spends and amounts)\n+ * This does not modify the UTXO set. This does not check scripts and sigs.\n+ * Preconditions: tx.IsCoinBase() is false.\n+ */\n+bool CheckTxInputs(const CTransaction& tx, CValidationState& state, const CCoinsViewCache& inputs, int nSpendHeight, CAmount& nTxFee);\n+\n+} // namespace Consensus\n+\n #endif // BITCOIN_CONSENSUS_CONSENSUS_H"
      },
      {
        "sha": "2b875e8ac4ca484b9ddf3b251cb29b6c9ba4f7b0",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 29,
        "deletions": 40,
        "changes": 69,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "patch": "@@ -825,8 +825,6 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n     {\n         CCoinsView dummy;\n         CCoinsViewCache view(&dummy);\n-\n-        CAmount nValueIn = 0;\n         {\n         LOCK(pool.cs);\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n@@ -847,19 +845,17 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n             }\n         }\n \n-        // are the actual inputs available?\n-        if (!view.HaveInputs(tx))\n-            return state.Invalid(false, REJECT_DUPLICATE, \"bad-txns-inputs-spent\");\n-\n         // Bring the best block into scope\n         view.GetBestBlock();\n \n-        nValueIn = view.GetValueIn(tx);\n-\n         // we have all inputs cached now, so switch back to dummy, so we don't need to keep lock on mempool\n         view.SetBackend(dummy);\n         }\n \n+        CAmount nFees;\n+        if (!Consensus::CheckTxInputs(tx, state, view, GetSpendHeight(view), nFees))\n+            return error(\"%s: Consensus::CheckTxInputs: %s\", __func__, state.GetRejectReason());\n+\n         // Check for non-standard pay-to-script-hash in inputs\n         if (fRequireStandard && !AreInputsStandard(tx, view))\n             return state.Invalid(false, REJECT_NONSTANDARD, \"bad-txns-nonstandard-inputs\");\n@@ -875,10 +871,7 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n             return state.DoS(0, false, REJECT_NONSTANDARD, \"bad-txns-too-many-sigops\", false,\n                 strprintf(\"%d > %d\", nSigOps, MAX_STANDARD_TX_SIGOPS));\n \n-        CAmount nValueOut = tx.GetValueOut();\n-        CAmount nFees = nValueIn-nValueOut;\n         double dPriority = view.GetPriority(tx, chainActive.Height());\n-\n         CTxMemPoolEntry entry(tx, nFees, GetTime(), dPriority, chainActive.Height(), mempool.HasNoInputsOf(tx));\n         unsigned int nSize = entry.GetTxSize();\n \n@@ -923,7 +916,7 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n \n         // Check against previous transactions\n         // This is done last to help prevent CPU exhaustion denial-of-service attacks.\n-        if (!CheckInputs(tx, state, view, true, STANDARD_SCRIPT_VERIFY_FLAGS, true))\n+        if (!CheckInputsScripts(tx, state, view, STANDARD_SCRIPT_VERIFY_FLAGS, true))\n             return false;\n \n         // Check again against just the consensus-critical mandatory script\n@@ -935,11 +928,9 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         // There is a similar check in CreateNewBlock() to prevent creating\n         // invalid blocks, however allowing such transactions into the mempool\n         // can be exploited as a DoS attack.\n-        if (!CheckInputs(tx, state, view, true, MANDATORY_SCRIPT_VERIFY_FLAGS, true))\n-        {\n+        if (!CheckInputsScripts(tx, state, view, MANDATORY_SCRIPT_VERIFY_FLAGS, true))\n             return error(\"%s: BUG! PLEASE REPORT THIS! ConnectInputs failed against MANDATORY but not STANDARD flags %s, %s\",\n                 __func__, hash.ToString(), FormatStateMessage(state));\n-        }\n \n         // Store transaction in memory\n         pool.addUnchecked(hash, entry, !IsInitialBlockDownload());\n@@ -1293,15 +1284,14 @@ int GetSpendHeight(const CCoinsViewCache& inputs)\n }\n \n namespace Consensus {\n-bool CheckTxInputs(const CTransaction& tx, CValidationState& state, const CCoinsViewCache& inputs, int nSpendHeight)\n+bool CheckTxInputs(const CTransaction& tx, CValidationState& state, const CCoinsViewCache& inputs, int nSpendHeight, CAmount& nTxFee)\n {\n         // This doesn't trigger the DoS code on purpose; if it did, it would make it easier\n         // for an attacker to attempt to split the network.\n         if (!inputs.HaveInputs(tx))\n-            return state.Invalid(false, 0, \"\", \"Inputs unavailable\");\n+            return state.Invalid(false, REJECT_DUPLICATE, \"bad-txns-inputs-spent\");\n \n         CAmount nValueIn = 0;\n-        CAmount nFees = 0;\n         for (unsigned int i = 0; i < tx.vin.size(); i++)\n         {\n             const COutPoint &prevout = tx.vin[i].prevout;\n@@ -1323,28 +1313,24 @@ bool CheckTxInputs(const CTransaction& tx, CValidationState& state, const CCoins\n \n         }\n \n-        if (nValueIn < tx.GetValueOut())\n+        // Tally transaction fees\n+        CAmount nValueOut = tx.GetValueOut();\n+        if (nValueIn < nValueOut)\n             return state.DoS(100, false, REJECT_INVALID, \"bad-txns-in-belowout\", false,\n-                strprintf(\"value in (%s) < value out (%s)\", FormatMoney(nValueIn), FormatMoney(tx.GetValueOut())));\n+                strprintf(\"value in (%s) < value out (%s)\", FormatMoney(nValueIn), FormatMoney(nValueOut)));\n \n-        // Tally transaction fees\n-        CAmount nTxFee = nValueIn - tx.GetValueOut();\n-        if (nTxFee < 0)\n-            return state.DoS(100, false, REJECT_INVALID, \"bad-txns-fee-negative\");\n-        nFees += nTxFee;\n-        if (!MoneyRange(nFees))\n+        nTxFee = nValueIn - nValueOut;\n+        if (!MoneyRange(nTxFee))\n             return state.DoS(100, false, REJECT_INVALID, \"bad-txns-fee-outofrange\");\n+\n     return true;\n }\n }// namespace Consensus\n \n-bool CheckInputs(const CTransaction& tx, CValidationState &state, const CCoinsViewCache &inputs, bool fScriptChecks, unsigned int flags, bool cacheStore, std::vector<CScriptCheck> *pvChecks)\n+bool CheckInputsScripts(const CTransaction& tx, CValidationState &state, const CCoinsViewCache &inputs, unsigned int flags, bool cacheStore, std::vector<CScriptCheck> *pvChecks)\n {\n     if (!tx.IsCoinBase())\n     {\n-        if (!Consensus::CheckTxInputs(tx, state, inputs, GetSpendHeight(inputs)))\n-            return false;\n-\n         if (pvChecks)\n             pvChecks->reserve(tx.vin.size());\n \n@@ -1355,7 +1341,6 @@ bool CheckInputs(const CTransaction& tx, CValidationState &state, const CCoinsVi\n         // Skip ECDSA signature verification when connecting blocks\n         // before the last block chain checkpoint. This is safe because block merkle hashes are\n         // still computed and checked, and any change will be caught at the next checkpoint.\n-        if (fScriptChecks) {\n             for (unsigned int i = 0; i < tx.vin.size(); i++) {\n                 const COutPoint &prevout = tx.vin[i].prevout;\n                 const CCoins* coins = inputs.AccessCoins(prevout.hash);\n@@ -1389,7 +1374,6 @@ bool CheckInputs(const CTransaction& tx, CValidationState &state, const CCoinsVi\n                     return state.DoS(100,false, REJECT_INVALID, strprintf(\"mandatory-script-verify-flag-failed (%s)\", ScriptErrorString(check.GetScriptError())));\n                 }\n             }\n-        }\n     }\n \n     return true;\n@@ -1760,10 +1744,15 @@ bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pin\n \n         if (!tx.IsCoinBase())\n         {\n-            if (!view.HaveInputs(tx))\n+            if (!view.HaveInputs(tx)) // Redundant check with different DoS score\n                 return state.DoS(100, error(\"ConnectBlock(): inputs missing/spent\"),\n                                  REJECT_INVALID, \"bad-txns-inputs-missingorspent\");\n \n+            CAmount nTxFees;\n+            if (!Consensus::CheckTxInputs(tx, state, view, GetSpendHeight(view), nTxFees))\n+                return error(\"%s: Consensus::CheckTxInputs on %s: %s\", __func__, tx.GetHash().ToString(), FormatStateMessage(state));\n+            nFees += nTxFees;\n+\n             if (fStrictPayToScriptHash)\n             {\n                 // Add in sigops done by pay-to-script-hash inputs;\n@@ -1775,13 +1764,13 @@ bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pin\n                                      REJECT_INVALID, \"bad-blk-sigops\");\n             }\n \n-            nFees += view.GetValueIn(tx)-tx.GetValueOut();\n-\n-            std::vector<CScriptCheck> vChecks;\n-            if (!CheckInputs(tx, state, view, fScriptChecks, flags, false, nScriptCheckThreads ? &vChecks : NULL))\n-                return error(\"ConnectBlock(): CheckInputs on %s failed with %s\",\n-                    tx.GetHash().ToString(), FormatStateMessage(state));\n-            control.Add(vChecks);\n+            if (fScriptChecks) {\n+                std::vector<CScriptCheck> vChecks;\n+                if (!CheckInputsScripts(tx, state, view, flags, false, nScriptCheckThreads ? &vChecks : NULL))\n+                    return error(\"ConnectBlock(): CheckInputs on %s failed with %s\",\n+                                 tx.GetHash().ToString(), FormatStateMessage(state));\n+                control.Add(vChecks);\n+            }\n         }\n \n         CTxUndo undoDummy;"
      },
      {
        "sha": "72f7477610247d5b7f0cb576fbddd89843b9cf26",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "patch": "@@ -277,7 +277,7 @@ unsigned int GetP2SHSigOpCount(const CTransaction& tx, const CCoinsViewCache& ma\n  * This does not modify the UTXO set. If pvChecks is not NULL, script checks are pushed onto it\n  * instead of being performed inline.\n  */\n-bool CheckInputs(const CTransaction& tx, CValidationState &state, const CCoinsViewCache &view, bool fScriptChecks,\n+bool CheckInputsScripts(const CTransaction& tx, CValidationState &state, const CCoinsViewCache &view,\n                  unsigned int flags, bool cacheStore, std::vector<CScriptCheck> *pvChecks = NULL);\n \n /** Apply the effects of this transaction on the UTXO set represented by view */"
      },
      {
        "sha": "c2a883947bdf726564155a7e6b31649a71ef2a6d",
        "filename": "src/miner.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 5,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/miner.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/miner.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/miner.cpp?ref=52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "patch": "@@ -102,6 +102,7 @@ int64_t UpdateTime(CBlockHeader* pblock, const Consensus::Params& consensusParam\n CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n {\n     const CChainParams& chainparams = Params();\n+    CValidationState state;\n     // Create new block\n     auto_ptr<CBlockTemplate> pblocktemplate(new CBlockTemplate());\n     if(!pblocktemplate.get())\n@@ -276,20 +277,18 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n                 std::make_heap(vecPriority.begin(), vecPriority.end(), comparer);\n             }\n \n-            if (!view.HaveInputs(tx))\n+            CAmount nTxFees;\n+            if (!Consensus::CheckTxInputs(tx, state, view, GetSpendHeight(view), nTxFees))\n                 continue;\n \n-            CAmount nTxFees = view.GetValueIn(tx)-tx.GetValueOut();\n-\n             nTxSigOps += GetP2SHSigOpCount(tx, view);\n             if (nBlockSigOps + nTxSigOps >= MAX_BLOCK_SIGOPS)\n                 continue;\n \n             // Note that flags: we don't want to set mempool/IsStandard()\n             // policy here, but we still have to ensure that the block we\n             // create only contains transactions that are valid in new blocks.\n-            CValidationState state;\n-            if (!CheckInputs(tx, state, view, true, MANDATORY_SCRIPT_VERIFY_FLAGS, true))\n+            if (!CheckInputsScripts(tx, state, view, MANDATORY_SCRIPT_VERIFY_FLAGS, true))\n                 continue;\n \n             UpdateCoins(tx, state, view, nHeight);"
      },
      {
        "sha": "9966eab08bc5bdbb4e2b8bb69d50b6468cfbd47e",
        "filename": "src/script/standard.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/script/standard.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/script/standard.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/standard.h?ref=52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "patch": "@@ -34,7 +34,7 @@ extern unsigned nMaxDatacarrierBytes;\n  * but in the future other flags may be added, such as a soft-fork to enforce\n  * strict DER encoding.\n  * \n- * Failing one of these tests may trigger a DoS ban - see CheckInputs() for\n+ * Failing one of these tests may trigger a DoS ban - see CheckInputsScripts() for\n  * details.\n  */\n static const unsigned int MANDATORY_SCRIPT_VERIFY_FLAGS = SCRIPT_VERIFY_P2SH;"
      },
      {
        "sha": "4e664199ad1fa5213605d3fda045090e35cb8775",
        "filename": "src/txmempool.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/txmempool.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52279bc40d9754af4793ed5617e1912d37d3f7e3/src/txmempool.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.cpp?ref=52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "patch": "@@ -275,7 +275,6 @@ void CTxMemPool::check(const CCoinsViewCache *pcoins) const\n             waitingOnDependants.push_back(&it->second);\n         else {\n             CValidationState state;\n-            assert(CheckInputs(tx, state, mempoolDuplicate, false, 0, false, NULL));\n             UpdateCoins(tx, state, mempoolDuplicate, 1000000);\n         }\n     }\n@@ -289,7 +288,6 @@ void CTxMemPool::check(const CCoinsViewCache *pcoins) const\n             stepsSinceLastRemove++;\n             assert(stepsSinceLastRemove < waitingOnDependants.size());\n         } else {\n-            assert(CheckInputs(entry->GetTx(), state, mempoolDuplicate, false, 0, false, NULL));\n             UpdateCoins(entry->GetTx(), state, mempoolDuplicate, 1000000);\n             stepsSinceLastRemove = 0;\n         }"
      }
    ]
  },
  {
    "sha": "a7db703647b7f6a2c1e828e7cc98736f61ca914a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphN2RiNzAzNjQ3YjdmNmEyYzFlODI4ZTdjYzk4NzM2ZjYxY2E5MTRh",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2015-07-09T00:19:08Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-08-24T01:01:54Z"
      },
      "message": "miner: remove prio calculations and dPriority from TxPriority tuple",
      "tree": {
        "sha": "9dac0b3e1662fec615d9c9075fafff78ecd1d2f0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9dac0b3e1662fec615d9c9075fafff78ecd1d2f0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a7db703647b7f6a2c1e828e7cc98736f61ca914a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a7db703647b7f6a2c1e828e7cc98736f61ca914a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a7db703647b7f6a2c1e828e7cc98736f61ca914a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a7db703647b7f6a2c1e828e7cc98736f61ca914a/comments",
    "author": null,
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52279bc40d9754af4793ed5617e1912d37d3f7e3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/52279bc40d9754af4793ed5617e1912d37d3f7e3"
      }
    ],
    "stats": {
      "total": 55,
      "additions": 11,
      "deletions": 44
    },
    "files": [
      {
        "sha": "532750f6cae69e954b4fa954e6982f29166b9263",
        "filename": "src/miner.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 44,
        "changes": 55,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a7db703647b7f6a2c1e828e7cc98736f61ca914a/src/miner.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a7db703647b7f6a2c1e828e7cc98736f61ca914a/src/miner.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/miner.cpp?ref=a7db703647b7f6a2c1e828e7cc98736f61ca914a",
        "patch": "@@ -48,9 +48,8 @@ class COrphan\n     const CTransaction* ptx;\n     set<uint256> setDependsOn;\n     CFeeRate feeRate;\n-    double dPriority;\n \n-    COrphan(const CTransaction* ptxIn) : ptx(ptxIn), feeRate(0), dPriority(0)\n+    COrphan(const CTransaction* ptxIn) : ptx(ptxIn), feeRate(0)\n     {\n     }\n };\n@@ -59,28 +58,15 @@ uint64_t nLastBlockTx = 0;\n uint64_t nLastBlockSize = 0;\n \n // We want to sort transactions by priority and fee rate, so:\n-typedef boost::tuple<double, CFeeRate, const CTransaction*> TxPriority;\n+typedef boost::tuple<CFeeRate, const CTransaction*> TxPriority;\n class TxPriorityCompare\n {\n-    bool byFee;\n-\n public:\n-    TxPriorityCompare(bool _byFee) : byFee(_byFee) { }\n+    TxPriorityCompare(bool _byFee) { }\n \n     bool operator()(const TxPriority& a, const TxPriority& b)\n     {\n-        if (byFee)\n-        {\n-            if (a.get<1>() == b.get<1>())\n-                return a.get<0>() < b.get<0>();\n-            return a.get<1>() < b.get<1>();\n-        }\n-        else\n-        {\n-            if (a.get<0>() == b.get<0>())\n-                return a.get<1>() < b.get<1>();\n-            return a.get<0>() < b.get<0>();\n-        }\n+        return a.get<0>() < b.get<0>();\n     }\n };\n \n@@ -131,11 +117,6 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n     // Limit to betweeen 1K and MAX_BLOCK_SIZE-1K for sanity:\n     nBlockMaxSize = std::max((unsigned int)1000, std::min((unsigned int)(MAX_BLOCK_SIZE-1000), nBlockMaxSize));\n \n-    // How much of the block should be dedicated to high-priority transactions,\n-    // included regardless of the fees they pay\n-    unsigned int nBlockPrioritySize = GetArg(\"-blockprioritysize\", DEFAULT_BLOCK_PRIORITY_SIZE);\n-    nBlockPrioritySize = std::min(nBlockMaxSize, nBlockPrioritySize);\n-\n     // Minimum block size you want to create; block will be filled with free transactions\n     // until there are no more or the block reaches this size:\n     unsigned int nBlockMinSize = GetArg(\"-blockminsize\", DEFAULT_BLOCK_MIN_SIZE);\n@@ -222,29 +203,25 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n             CFeeRate feeRate(nTotalIn-tx.GetValueOut(), nTxSize);\n \n             if (porphan)\n-            {\n-                porphan->dPriority = dPriority;\n                 porphan->feeRate = feeRate;\n-            }\n             else\n-                vecPriority.push_back(TxPriority(dPriority, feeRate, &mi->second.GetTx()));\n+                vecPriority.push_back(TxPriority(feeRate, &mi->second.GetTx()));\n         }\n \n         // Collect transactions into block\n         uint64_t nBlockSize = 1000;\n         uint64_t nBlockTx = 0;\n         int nBlockSigOps = 100;\n-        bool fSortedByFee = (nBlockPrioritySize <= 0);\n \n-        TxPriorityCompare comparer(fSortedByFee);\n+        TxPriorityCompare comparer(true);\n         std::make_heap(vecPriority.begin(), vecPriority.end(), comparer);\n \n         while (!vecPriority.empty())\n         {\n             // Take highest priority transaction off the priority queue:\n-            double dPriority = vecPriority.front().get<0>();\n-            CFeeRate feeRate = vecPriority.front().get<1>();\n-            const CTransaction& tx = *(vecPriority.front().get<2>());\n+            double dPriority = 0;\n+            CFeeRate feeRate = vecPriority.front().get<0>();\n+            const CTransaction& tx = *(vecPriority.front().get<1>());\n \n             std::pop_heap(vecPriority.begin(), vecPriority.end(), comparer);\n             vecPriority.pop_back();\n@@ -264,19 +241,9 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n             double dPriorityDelta = 0;\n             CAmount nFeeDelta = 0;\n             mempool.ApplyDeltas(hash, dPriorityDelta, nFeeDelta);\n-            if (fSortedByFee && (dPriorityDelta <= 0) && (nFeeDelta <= 0) && (feeRate < ::minRelayTxFee) && (nBlockSize + nTxSize >= nBlockMinSize))\n+            if ((dPriorityDelta <= 0) && (nFeeDelta <= 0) && (feeRate < ::minRelayTxFee) && (nBlockSize + nTxSize >= nBlockMinSize))\n                 continue;\n \n-            // Prioritise by fee once past the priority size or we run out of high-priority\n-            // transactions:\n-            if (!fSortedByFee &&\n-                ((nBlockSize + nTxSize >= nBlockPrioritySize) || !AllowFree(dPriority)))\n-            {\n-                fSortedByFee = true;\n-                comparer = TxPriorityCompare(fSortedByFee);\n-                std::make_heap(vecPriority.begin(), vecPriority.end(), comparer);\n-            }\n-\n             CAmount nTxFees;\n             if (!Consensus::CheckTxInputs(tx, state, view, GetSpendHeight(view), nTxFees))\n                 continue;\n@@ -318,7 +285,7 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n                         porphan->setDependsOn.erase(hash);\n                         if (porphan->setDependsOn.empty())\n                         {\n-                            vecPriority.push_back(TxPriority(porphan->dPriority, porphan->feeRate, porphan->ptx));\n+                            vecPriority.push_back(TxPriority(porphan->feeRate, porphan->ptx));\n                             std::push_heap(vecPriority.begin(), vecPriority.end(), comparer);\n                         }\n                     }"
      }
    ]
  },
  {
    "sha": "19391192fcc9c5628b08687e085ff314291f67fb",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxOTM5MTE5MmZjYzljNTYyOGIwODY4N2UwODVmZjMxNDI5MWY2N2Zi",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2015-07-09T04:03:57Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-08-24T01:17:53Z"
      },
      "message": "mempool: remove priority from memory pool per-entry container",
      "tree": {
        "sha": "95adf0356fc7d418b46a50198889d68c911ccd8f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/95adf0356fc7d418b46a50198889d68c911ccd8f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/19391192fcc9c5628b08687e085ff314291f67fb",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/19391192fcc9c5628b08687e085ff314291f67fb",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/19391192fcc9c5628b08687e085ff314291f67fb",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/19391192fcc9c5628b08687e085ff314291f67fb/comments",
    "author": null,
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a7db703647b7f6a2c1e828e7cc98736f61ca914a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a7db703647b7f6a2c1e828e7cc98736f61ca914a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a7db703647b7f6a2c1e828e7cc98736f61ca914a"
      }
    ],
    "stats": {
      "total": 177,
      "additions": 20,
      "deletions": 157
    },
    "files": [
      {
        "sha": "61d5ef3db33acc4bf0f17f762437b926c0046ede",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -871,8 +871,7 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n             return state.DoS(0, false, REJECT_NONSTANDARD, \"bad-txns-too-many-sigops\", false,\n                 strprintf(\"%d > %d\", nSigOps, MAX_STANDARD_TX_SIGOPS));\n \n-        double dPriority = view.GetPriority(tx, chainActive.Height());\n-        CTxMemPoolEntry entry(tx, nFees, GetTime(), dPriority, chainActive.Height(), mempool.HasNoInputsOf(tx));\n+        CTxMemPoolEntry entry(tx, nFees, GetTime(), chainActive.Height(), mempool.HasNoInputsOf(tx));\n         unsigned int nSize = entry.GetTxSize();\n \n         // Don't accept it if it can't get into a block"
      },
      {
        "sha": "e8a30b06044047a9ad5aa20d476bc5bf9d2333d9",
        "filename": "src/policy/fees.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 59,
        "changes": 64,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/policy/fees.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/policy/fees.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/policy/fees.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -309,33 +309,13 @@ CBlockPolicyEstimator::CBlockPolicyEstimator(const CFeeRate& _minRelayFee)\n     vfeelist.push_back(INF_FEERATE);\n     feeStats.Initialize(vfeelist, MAX_BLOCK_CONFIRMS, DEFAULT_DECAY, \"FeeRate\");\n \n-    minTrackedPriority = AllowFreeThreshold() < MIN_PRIORITY ? MIN_PRIORITY : AllowFreeThreshold();\n-    std::vector<double> vprilist;\n-    for (double bucketBoundary = minTrackedPriority; bucketBoundary <= MAX_PRIORITY; bucketBoundary *= PRI_SPACING) {\n-        vprilist.push_back(bucketBoundary);\n-    }\n-    vprilist.push_back(INF_PRIORITY);\n-    priStats.Initialize(vprilist, MAX_BLOCK_CONFIRMS, DEFAULT_DECAY, \"Priority\");\n-\n     feeUnlikely = CFeeRate(0);\n     feeLikely = CFeeRate(INF_FEERATE);\n-    priUnlikely = 0;\n-    priLikely = INF_PRIORITY;\n }\n \n-bool CBlockPolicyEstimator::isFeeDataPoint(const CFeeRate &fee, double pri)\n+bool CBlockPolicyEstimator::isFeeDataPoint(const CFeeRate &fee)\n {\n-    if ((pri < minTrackedPriority && fee >= minTrackedFee) ||\n-        (pri < priUnlikely && fee > feeLikely)) {\n-        return true;\n-    }\n-    return false;\n-}\n-\n-bool CBlockPolicyEstimator::isPriDataPoint(const CFeeRate &fee, double pri)\n-{\n-    if ((fee < minTrackedFee && pri >= minTrackedPriority) ||\n-        (fee < feeUnlikely && pri > priLikely)) {\n+    if ((fee >= minTrackedFee) || (fee > feeLikely)) {\n         return true;\n     }\n     return false;\n@@ -348,7 +328,7 @@ void CBlockPolicyEstimator::processTransaction(const CTxMemPoolEntry& entry, boo\n     if (mapMemPoolTxs[hash].stats != NULL) {\n         LogPrint(\"estimatefee\", \"Blockpolicy error mempool tx %s already being tracked\\n\",\n                  hash.ToString().c_str());\n-\treturn;\n+        return;\n     }\n \n     if (txHeight < nBestSeenHeight) {\n@@ -375,17 +355,11 @@ void CBlockPolicyEstimator::processTransaction(const CTxMemPoolEntry& entry, boo\n     // Want the priority of the tx at confirmation. However we don't know\n     // what that will be and its too hard to continue updating it\n     // so use starting priority as a proxy\n-    double curPri = entry.GetPriority(txHeight);\n     mapMemPoolTxs[hash].blockHeight = txHeight;\n \n     LogPrint(\"estimatefee\", \"Blockpolicy mempool tx %s \", hash.ToString().substr(0,10));\n-    // Record this as a priority estimate\n-    if (entry.GetFee() == 0 || isPriDataPoint(feeRate, curPri)) {\n-        mapMemPoolTxs[hash].stats = &priStats;\n-        mapMemPoolTxs[hash].bucketIndex =  priStats.NewTx(txHeight, curPri);\n-    }\n     // Record this as a fee estimate\n-    else if (isFeeDataPoint(feeRate, curPri)) {\n+    if (isFeeDataPoint(feeRate)) {\n         mapMemPoolTxs[hash].stats = &feeStats;\n         mapMemPoolTxs[hash].bucketIndex = feeStats.NewTx(txHeight, (double)feeRate.GetFeePerK());\n     }\n@@ -418,16 +392,8 @@ void CBlockPolicyEstimator::processBlockTx(unsigned int nBlockHeight, const CTxM\n     // Fees are stored and reported as BTC-per-kb:\n     CFeeRate feeRate(entry.GetFee(), entry.GetTxSize());\n \n-    // Want the priority of the tx at confirmation.  The priority when it\n-    // entered the mempool could easily be very small and change quickly\n-    double curPri = entry.GetPriority(nBlockHeight);\n-\n-    // Record this as a priority estimate\n-    if (entry.GetFee() == 0 || isPriDataPoint(feeRate, curPri)) {\n-        priStats.Record(blocksToConfirm, curPri);\n-    }\n     // Record this as a fee estimate\n-    else if (isFeeDataPoint(feeRate, curPri)) {\n+    if (isFeeDataPoint(feeRate)) {\n         feeStats.Record(blocksToConfirm, (double)feeRate.GetFeePerK());\n     }\n }\n@@ -454,20 +420,13 @@ void CBlockPolicyEstimator::processBlock(unsigned int nBlockHeight,\n     // a fee/priority is \"likely\" the reason your tx was included in a block if >85% of such tx's\n     // were confirmed in 2 blocks and is \"unlikely\" if <50% were confirmed in 10 blocks\n     LogPrint(\"estimatefee\", \"Blockpolicy recalculating dynamic cutoffs:\\n\");\n-    priLikely = priStats.EstimateMedianVal(2, SUFFICIENT_PRITXS, MIN_SUCCESS_PCT, true, nBlockHeight);\n-    if (priLikely == -1)\n-        priLikely = INF_PRIORITY;\n \n     double feeLikelyEst = feeStats.EstimateMedianVal(2, SUFFICIENT_FEETXS, MIN_SUCCESS_PCT, true, nBlockHeight);\n     if (feeLikelyEst == -1)\n         feeLikely = CFeeRate(INF_FEERATE);\n     else\n         feeLikely = CFeeRate(feeLikelyEst);\n \n-    priUnlikely = priStats.EstimateMedianVal(10, SUFFICIENT_PRITXS, UNLIKELY_PCT, false, nBlockHeight);\n-    if (priUnlikely == -1)\n-        priUnlikely = 0;\n-\n     double feeUnlikelyEst = feeStats.EstimateMedianVal(10, SUFFICIENT_FEETXS, UNLIKELY_PCT, false, nBlockHeight);\n     if (feeUnlikelyEst == -1)\n         feeUnlikely = CFeeRate(0);\n@@ -476,15 +435,13 @@ void CBlockPolicyEstimator::processBlock(unsigned int nBlockHeight,\n \n     // Clear the current block states\n     feeStats.ClearCurrent(nBlockHeight);\n-    priStats.ClearCurrent(nBlockHeight);\n \n     // Repopulate the current block states\n     for (unsigned int i = 0; i < entries.size(); i++)\n         processBlockTx(nBlockHeight, entries[i]);\n \n     // Update all exponential averages with the current block states\n     feeStats.UpdateMovingAverages();\n-    priStats.UpdateMovingAverages();\n \n     LogPrint(\"estimatefee\", \"Blockpolicy after updating estimates for %u confirmed entries, new mempool map size %u\\n\",\n              entries.size(), mapMemPoolTxs.size());\n@@ -504,27 +461,16 @@ CFeeRate CBlockPolicyEstimator::estimateFee(int confTarget)\n     return CFeeRate(median);\n }\n \n-double CBlockPolicyEstimator::estimatePriority(int confTarget)\n-{\n-    // Return failure if trying to analyze a target we're not tracking\n-    if (confTarget <= 0 || (unsigned int)confTarget > priStats.GetMaxConfirms())\n-        return -1;\n-\n-    return priStats.EstimateMedianVal(confTarget, SUFFICIENT_PRITXS, MIN_SUCCESS_PCT, true, nBestSeenHeight);\n-}\n-\n void CBlockPolicyEstimator::Write(CAutoFile& fileout)\n {\n     fileout << nBestSeenHeight;\n     feeStats.Write(fileout);\n-    priStats.Write(fileout);\n }\n \n void CBlockPolicyEstimator::Read(CAutoFile& filein)\n {\n     int nFileBestSeenHeight;\n     filein >> nFileBestSeenHeight;\n     feeStats.Read(filein);\n-    priStats.Read(filein);\n     nBestSeenHeight = nFileBestSeenHeight;\n }"
      },
      {
        "sha": "37fc591cba5bde9e829f7aecd2eea83e4bd1d68c",
        "filename": "src/policy/fees.h",
        "status": "modified",
        "additions": 1,
        "deletions": 6,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/policy/fees.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/policy/fees.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/policy/fees.h?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -234,10 +234,7 @@ class CBlockPolicyEstimator\n     void removeTx(uint256 hash);\n \n     /** Is this transaction likely included in a block because of its fee?*/\n-    bool isFeeDataPoint(const CFeeRate &fee, double pri);\n-\n-    /** Is this transaction likely included in a block because of its priority?*/\n-    bool isPriDataPoint(const CFeeRate &fee, double pri);\n+    bool isFeeDataPoint(const CFeeRate &fee);\n \n     /** Return a fee estimate */\n     CFeeRate estimateFee(int confTarget);\n@@ -253,7 +250,6 @@ class CBlockPolicyEstimator\n \n private:\n     CFeeRate minTrackedFee; //! Passed to constructor to avoid dependency on main\n-    double minTrackedPriority; //! Set to AllowFreeThreshold\n     unsigned int nBestSeenHeight;\n     struct TxStatsInfo\n     {\n@@ -271,6 +267,5 @@ class CBlockPolicyEstimator\n \n     /** Breakpoints to help determine whether a transaction was confirmed by priority or Fee */\n     CFeeRate feeLikely, feeUnlikely;\n-    double priLikely, priUnlikely;\n };\n #endif /*BITCOIN_POLICYESTIMATOR_H */"
      },
      {
        "sha": "1e1e38624467f2c910d8ce5b582c97b687e024de",
        "filename": "src/qt/coincontroldialog.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 11,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/qt/coincontroldialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/qt/coincontroldialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/coincontroldialog.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -538,8 +538,8 @@ void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n         nBytes = nBytesInputs + ((CoinControlDialog::payAmounts.size() > 0 ? CoinControlDialog::payAmounts.size() + 1 : 2) * 34) + 10; // always assume +1 output for change here\n \n         // Priority\n-        double mempoolEstimatePriority = mempool.estimatePriority(nTxConfirmTarget);\n-        dPriority = dPriorityInputs / (nBytes - nBytesInputs + (nQuantityUncompressed * 29)); // 29 = 180 - 151 (uncompressed public keys are over the limit. max 151 bytes of the input are ignored for priority)\n+        double mempoolEstimatePriority = 0;\n+        dPriority = 0;\n         sPriorityLabel = CoinControlDialog::getPriorityLabel(dPriority, mempoolEstimatePriority);\n \n         // in the subtract fee from amount case, we can tell if zero change already and subtract the bytes, so that fee calculation afterwards is accurate\n@@ -551,14 +551,7 @@ void CoinControlDialog::updateLabels(WalletModel *model, QDialog* dialog)\n         nPayFee = CWallet::GetMinimumFee(nBytes, nTxConfirmTarget, mempool);\n \n         // Allow free?\n-        double dPriorityNeeded = mempoolEstimatePriority;\n-        if (dPriorityNeeded <= 0)\n-            dPriorityNeeded = AllowFreeThreshold(); // not enough data, back to hard-coded\n-        fAllowFree = (dPriority >= dPriorityNeeded);\n-\n-        if (fSendFreeTransactions)\n-            if (fAllowFree && nBytes <= MAX_FREE_TRANSACTION_CREATE_SIZE)\n-                nPayFee = 0;\n+        fAllowFree = false;\n \n         if (nPayAmount > 0)\n         {\n@@ -686,7 +679,7 @@ void CoinControlDialog::updateView()\n     QFlags<Qt::ItemFlag> flgTristate = Qt::ItemIsSelectable | Qt::ItemIsEnabled | Qt::ItemIsUserCheckable | Qt::ItemIsTristate;\n \n     int nDisplayUnit = model->getOptionsModel()->getDisplayUnit();\n-    double mempoolEstimatePriority = mempool.estimatePriority(nTxConfirmTarget);\n+    double mempoolEstimatePriority = 0;\n \n     std::map<QString, std::vector<COutput> > mapCoins;\n     model->listCoins(mapCoins);"
      },
      {
        "sha": "383e0337b492344c1993aa860b9e2ef4c33d2928",
        "filename": "src/rpcmining.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 27,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/rpcmining.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/rpcmining.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcmining.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -698,30 +698,3 @@ UniValue estimatefee(const UniValue& params, bool fHelp)\n \n     return ValueFromAmount(feeRate.GetFeePerK());\n }\n-\n-UniValue estimatepriority(const UniValue& params, bool fHelp)\n-{\n-    if (fHelp || params.size() != 1)\n-        throw runtime_error(\n-            \"estimatepriority nblocks\\n\"\n-            \"\\nEstimates the approximate priority a zero-fee transaction needs to begin\\n\"\n-            \"confirmation within nblocks blocks.\\n\"\n-            \"\\nArguments:\\n\"\n-            \"1. nblocks     (numeric)\\n\"\n-            \"\\nResult:\\n\"\n-            \"n              (numeric) estimated priority\\n\"\n-            \"\\n\"\n-            \"A negative value is returned if not enough transactions and blocks\\n\"\n-            \"have been observed to make an estimate.\\n\"\n-            \"\\nExample:\\n\"\n-            + HelpExampleCli(\"estimatepriority\", \"6\")\n-            );\n-\n-    RPCTypeCheck(params, boost::assign::list_of(UniValue::VNUM));\n-\n-    int nBlocks = params[0].get_int();\n-    if (nBlocks < 1)\n-        nBlocks = 1;\n-\n-    return mempool.estimatePriority(nBlocks);\n-}"
      },
      {
        "sha": "2097dcb3bd560da103cb2da7ac6955bf92d1e9d9",
        "filename": "src/rpcserver.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/rpcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/rpcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcserver.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -332,7 +332,6 @@ static const CRPCCommand vRPCCommands[] =\n     { \"util\",               \"validateaddress\",        &validateaddress,        true  }, /* uses wallet if enabled */\n     { \"util\",               \"verifymessage\",          &verifymessage,          true  },\n     { \"util\",               \"estimatefee\",            &estimatefee,            true  },\n-    { \"util\",               \"estimatepriority\",       &estimatepriority,       true  },\n \n     /* Not shown in help */\n     { \"hidden\",             \"invalidateblock\",        &invalidateblock,        true  },"
      },
      {
        "sha": "fcd2f821e55dc07a813ec34dd3b0c18eb56295e0",
        "filename": "src/rpcserver.h",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/rpcserver.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/rpcserver.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcserver.h?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -174,7 +174,6 @@ extern UniValue prioritisetransaction(const UniValue& params, bool fHelp);\n extern UniValue getblocktemplate(const UniValue& params, bool fHelp);\n extern UniValue submitblock(const UniValue& params, bool fHelp);\n extern UniValue estimatefee(const UniValue& params, bool fHelp);\n-extern UniValue estimatepriority(const UniValue& params, bool fHelp);\n \n extern UniValue getnewaddress(const UniValue& params, bool fHelp); // in rpcwallet.cpp\n extern UniValue getaccountaddress(const UniValue& params, bool fHelp);"
      },
      {
        "sha": "6892494ffd3e8a156c45d445babd6d84552488d8",
        "filename": "src/test/policyestimator_tests.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 18,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/test/policyestimator_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/test/policyestimator_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/policyestimator_tests.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -17,20 +17,15 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n {\n     CTxMemPool mpool(CFeeRate(1000));\n     CAmount basefee(2000);\n-    double basepri = 1e6;\n     CAmount deltaFee(100);\n-    double deltaPri=5e5;\n     std::vector<CAmount> feeV[2];\n-    std::vector<double> priV[2];\n \n     // Populate vectors of increasing fees or priorities\n     for (int j = 0; j < 10; j++) {\n         //V[0] is for fee transactions\n         feeV[0].push_back(basefee * (j+1));\n-        priV[0].push_back(0);\n         //V[1] is for priority transactions\n         feeV[1].push_back(CAmount(0));\n-        priV[1].push_back(basepri * pow(10, j+1));\n     }\n \n     // Store the hashes of transactions that have been\n@@ -63,7 +58,7 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n             for (int k = 0; k < 5; k++) { // add 4 fee txs for every priority tx\n                 tx.vin[0].prevout.n = 10000*blocknum+100*j+k; // make transaction unique\n                 uint256 hash = tx.GetHash();\n-                mpool.addUnchecked(hash, CTxMemPoolEntry(tx, feeV[k/4][j], GetTime(), priV[k/4][j], blocknum, mpool.HasNoInputsOf(tx)));\n+                mpool.addUnchecked(hash, CTxMemPoolEntry(tx, feeV[k/4][j], GetTime(), blocknum, mpool.HasNoInputsOf(tx)));\n                 txHashes[j].push_back(hash);\n             }\n         }\n@@ -92,7 +87,6 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n     }\n \n     std::vector<CAmount> origFeeEst;\n-    std::vector<double> origPriEst;\n     // Highest feerate is 10*baseRate and gets in all blocks,\n     // second highest feerate is 9*baseRate and gets in 9/10 blocks = 90%,\n     // third highest feerate is 8*base rate, and gets in 8/10 blocks = 80%,\n@@ -101,15 +95,11 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n     // so estimateFee(2) should return 8*baseRate etc...\n     for (int i = 1; i < 10;i++) {\n         origFeeEst.push_back(mpool.estimateFee(i).GetFeePerK());\n-        origPriEst.push_back(mpool.estimatePriority(i));\n         if (i > 1) { // Fee estimates should be monotonically decreasing\n             BOOST_CHECK(origFeeEst[i-1] <= origFeeEst[i-2]);\n-            BOOST_CHECK(origPriEst[i-1] <= origPriEst[i-2]);\n         }\n         BOOST_CHECK(origFeeEst[i-1] < (10-i)*baseRate.GetFeePerK() + deltaFee);\n         BOOST_CHECK(origFeeEst[i-1] > (10-i)*baseRate.GetFeePerK() - deltaFee);\n-        BOOST_CHECK(origPriEst[i-1] < pow(10,10-i) * basepri + deltaPri);\n-        BOOST_CHECK(origPriEst[i-1] > pow(10,10-i) * basepri - deltaPri);\n     }\n \n     // Mine 50 more blocks with no transactions happening, estimates shouldn't change\n@@ -120,8 +110,6 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n     for (int i = 1; i < 10;i++) {\n         BOOST_CHECK(mpool.estimateFee(i).GetFeePerK() < origFeeEst[i-1] + deltaFee);\n         BOOST_CHECK(mpool.estimateFee(i).GetFeePerK() > origFeeEst[i-1] - deltaFee);\n-        BOOST_CHECK(mpool.estimatePriority(i) < origPriEst[i-1] + deltaPri);\n-        BOOST_CHECK(mpool.estimatePriority(i) > origPriEst[i-1] - deltaPri);\n     }\n \n \n@@ -132,7 +120,7 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n             for (int k = 0; k < 5; k++) { // add 4 fee txs for every priority tx\n                 tx.vin[0].prevout.n = 10000*blocknum+100*j+k;\n                 uint256 hash = tx.GetHash();\n-                mpool.addUnchecked(hash, CTxMemPoolEntry(tx, feeV[k/4][j], GetTime(), priV[k/4][j], blocknum, mpool.HasNoInputsOf(tx)));\n+                mpool.addUnchecked(hash, CTxMemPoolEntry(tx, feeV[k/4][j], GetTime(), blocknum, mpool.HasNoInputsOf(tx)));\n                 txHashes[j].push_back(hash);\n             }\n         }\n@@ -141,7 +129,6 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n \n     for (int i = 1; i < 10;i++) {\n         BOOST_CHECK(mpool.estimateFee(i).GetFeePerK() > origFeeEst[i-1] - deltaFee);\n-        BOOST_CHECK(mpool.estimatePriority(i) > origPriEst[i-1] - deltaPri);\n     }\n \n     // Mine all those transactions\n@@ -158,7 +145,6 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n     block.clear();\n     for (int i = 1; i < 10;i++) {\n         BOOST_CHECK(mpool.estimateFee(i).GetFeePerK() > origFeeEst[i-1] - deltaFee);\n-        BOOST_CHECK(mpool.estimatePriority(i) > origPriEst[i-1] - deltaPri);\n     }\n \n     // Mine 100 more blocks where everything is mined every block\n@@ -168,7 +154,7 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n             for (int k = 0; k < 5; k++) { // add 4 fee txs for every priority tx\n                 tx.vin[0].prevout.n = 10000*blocknum+100*j+k;\n                 uint256 hash = tx.GetHash();\n-                mpool.addUnchecked(hash, CTxMemPoolEntry(tx, feeV[k/4][j], GetTime(), priV[k/4][j], blocknum, mpool.HasNoInputsOf(tx)));\n+                mpool.addUnchecked(hash, CTxMemPoolEntry(tx, feeV[k/4][j], GetTime(), blocknum, mpool.HasNoInputsOf(tx)));\n                 CTransaction btx;\n                 if (mpool.lookup(hash, btx))\n                     block.push_back(btx);\n@@ -179,7 +165,6 @@ BOOST_AUTO_TEST_CASE(BlockPolicyEstimates)\n     }\n     for (int i = 1; i < 9; i++) {\n         BOOST_CHECK(mpool.estimateFee(i).GetFeePerK() < origFeeEst[i-1] - deltaFee);\n-        BOOST_CHECK(mpool.estimatePriority(i) < origPriEst[i-1] - deltaPri);\n     }\n }\n "
      },
      {
        "sha": "8aec68dea25c59e74862303ad1019ae8818d070f",
        "filename": "src/txmempool.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 10,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/txmempool.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/txmempool.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -18,15 +18,15 @@\n using namespace std;\n \n CTxMemPoolEntry::CTxMemPoolEntry():\n-    nFee(0), nTxSize(0), nModSize(0), nUsageSize(0), nTime(0), dPriority(0.0), hadNoDependencies(false)\n+    nFee(0), nTxSize(0), nModSize(0), nUsageSize(0), nTime(0), hadNoDependencies(false)\n {\n     nHeight = MEMPOOL_HEIGHT;\n }\n \n CTxMemPoolEntry::CTxMemPoolEntry(const CTransaction& _tx, const CAmount& _nFee,\n-                                 int64_t _nTime, double _dPriority,\n+                                 int64_t _nTime,\n                                  unsigned int _nHeight, bool poolHasNoInputsOf):\n-    tx(_tx), nFee(_nFee), nTime(_nTime), dPriority(_dPriority), nHeight(_nHeight),\n+    tx(_tx), nFee(_nFee), nTime(_nTime), nHeight(_nHeight),\n     hadNoDependencies(poolHasNoInputsOf)\n {\n     nTxSize = ::GetSerializeSize(tx, SER_NETWORK, PROTOCOL_VERSION);\n@@ -44,8 +44,7 @@ CTxMemPoolEntry::GetPriority(unsigned int currentHeight) const\n {\n     CAmount nValueIn = tx.GetValueOut()+nFee;\n     double deltaPriority = ((double)(currentHeight-nHeight)*nValueIn)/nModSize;\n-    double dResult = dPriority + deltaPriority;\n-    return dResult;\n+    return deltaPriority;\n }\n \n CTxMemPool::CTxMemPool(const CFeeRate& _minRelayFee) :\n@@ -330,11 +329,6 @@ CFeeRate CTxMemPool::estimateFee(int nBlocks) const\n     LOCK(cs);\n     return minerPolicyEstimator->estimateFee(nBlocks);\n }\n-double CTxMemPool::estimatePriority(int nBlocks) const\n-{\n-    LOCK(cs);\n-    return minerPolicyEstimator->estimatePriority(nBlocks);\n-}\n \n bool\n CTxMemPool::WriteFeeEstimates(CAutoFile& fileout) const"
      },
      {
        "sha": "bb5ea8593272ee457cd4528c41ca9014fe62ea6a",
        "filename": "src/txmempool.h",
        "status": "modified",
        "additions": 2,
        "deletions": 8,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/txmempool.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/txmempool.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.h?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -22,9 +22,7 @@ inline double AllowFreeThreshold()\n \n inline bool AllowFree(double dPriority)\n {\n-    // Large (in bytes) low-priority (new, small-coin) transactions\n-    // need a fee.\n-    return dPriority > AllowFreeThreshold();\n+    return false;\n }\n \n /** Fake height value used in CCoins to signify they are only in the memory pool (since 0.8) */\n@@ -42,13 +40,12 @@ class CTxMemPoolEntry\n     size_t nModSize; //! ... and modified size for priority\n     size_t nUsageSize; //! ... and total memory usage\n     int64_t nTime; //! Local time when entering the mempool\n-    double dPriority; //! Priority when entering the mempool\n     unsigned int nHeight; //! Chain height when entering the mempool\n     bool hadNoDependencies; //! Not dependent on any other txs when it entered the mempool\n \n public:\n     CTxMemPoolEntry(const CTransaction& _tx, const CAmount& _nFee,\n-                    int64_t _nTime, double _dPriority, unsigned int _nHeight, bool poolHasNoInputsOf = false);\n+                    int64_t _nTime, unsigned int _nHeight, bool poolHasNoInputsOf = false);\n     CTxMemPoolEntry();\n     CTxMemPoolEntry(const CTxMemPoolEntry& other);\n \n@@ -161,9 +158,6 @@ class CTxMemPool\n     /** Estimate fee rate needed to get into the next nBlocks */\n     CFeeRate estimateFee(int nBlocks) const;\n \n-    /** Estimate priority needed to get into the next nBlocks */\n-    double estimatePriority(int nBlocks) const;\n-    \n     /** Write/Read estimates to disk */\n     bool WriteFeeEstimates(CAutoFile& fileout) const;\n     bool ReadFeeEstimates(CAutoFile& filein);"
      },
      {
        "sha": "5af991bddcdca28e041aa8e81177ae8ed1f262ad",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 14,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19391192fcc9c5628b08687e085ff314291f67fb/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19391192fcc9c5628b08687e085ff314291f67fb/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=19391192fcc9c5628b08687e085ff314291f67fb",
        "patch": "@@ -2035,20 +2035,6 @@ bool CWallet::CreateTransaction(const vector<CRecipient>& vecSend, CWalletTx& wt\n \n                 dPriority = wtxNew.ComputePriority(dPriority, nBytes);\n \n-                // Can we complete this as a free transaction?\n-                if (fSendFreeTransactions && nBytes <= MAX_FREE_TRANSACTION_CREATE_SIZE)\n-                {\n-                    // Not enough fee: enough priority?\n-                    double dPriorityNeeded = mempool.estimatePriority(nTxConfirmTarget);\n-                    // Not enough mempool history to estimate: use hard-coded AllowFree.\n-                    if (dPriorityNeeded <= 0 && AllowFree(dPriority))\n-                        break;\n-\n-                    // Small enough, and priority high enough, to send for free\n-                    if (dPriorityNeeded > 0 && dPriority >= dPriorityNeeded)\n-                        break;\n-                }\n-\n                 CAmount nFeeNeeded = GetMinimumFee(nBytes, nTxConfirmTarget, mempool);\n \n                 // If we made it here and we aren't even able to meet the relay fee on the next pass, give up"
      }
    ]
  },
  {
    "sha": "48abd4a9162804a73550d533fd364c65ff123640",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0OGFiZDRhOTE2MjgwNGE3MzU1MGQ1MzNmZDM2NGM2NWZmMTIzNjQw",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2015-07-09T05:46:45Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-08-24T01:47:14Z"
      },
      "message": "mempool, miner, qt, main: remove uses of priority, free transactions",
      "tree": {
        "sha": "d26cdac84d25edf78d80486e41e8cd260d91d634",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d26cdac84d25edf78d80486e41e8cd260d91d634"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/48abd4a9162804a73550d533fd364c65ff123640",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/48abd4a9162804a73550d533fd364c65ff123640",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/48abd4a9162804a73550d533fd364c65ff123640",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/48abd4a9162804a73550d533fd364c65ff123640/comments",
    "author": null,
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "19391192fcc9c5628b08687e085ff314291f67fb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/19391192fcc9c5628b08687e085ff314291f67fb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/19391192fcc9c5628b08687e085ff314291f67fb"
      }
    ],
    "stats": {
      "total": 229,
      "additions": 39,
      "deletions": 190
    },
    "files": [
      {
        "sha": "887eda6303c354c6c1985b954a375b0cf256ad3e",
        "filename": "src/coins.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 17,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/coins.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/coins.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/coins.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -229,23 +229,6 @@ bool CCoinsViewCache::HaveInputs(const CTransaction& tx) const\n     return true;\n }\n \n-double CCoinsViewCache::GetPriority(const CTransaction &tx, int nHeight) const\n-{\n-    if (tx.IsCoinBase())\n-        return 0.0;\n-    double dResult = 0.0;\n-    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n-    {\n-        const CCoins* coins = AccessCoins(txin.prevout.hash);\n-        assert(coins);\n-        if (!coins->IsAvailable(txin.prevout.n)) continue;\n-        if (coins->nHeight < nHeight) {\n-            dResult += coins->vout[txin.prevout.n].nValue * (nHeight-coins->nHeight);\n-        }\n-    }\n-    return tx.ComputePriority(dResult);\n-}\n-\n CCoinsModifier::CCoinsModifier(CCoinsViewCache& cache_, CCoinsMap::iterator it_, size_t usage) : cache(cache_), it(it_), cachedCoinUsage(usage) {\n     assert(!cache.hasModifier);\n     cache.hasModifier = true;"
      },
      {
        "sha": "e4b583fff748cfecd22f4ee4501949829f4248f2",
        "filename": "src/coins.h",
        "status": "modified",
        "additions": 0,
        "deletions": 3,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/coins.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/coins.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/coins.h?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -445,9 +445,6 @@ class CCoinsViewCache : public CCoinsViewBacked\n     //! Check whether all prevouts of the transaction are present in the UTXO set represented by this view\n     bool HaveInputs(const CTransaction& tx) const;\n \n-    //! Return priority of tx at height nHeight\n-    double GetPriority(const CTransaction &tx, int nHeight) const;\n-\n     const CTxOut &GetOutputFor(const CTxIn& input) const;\n \n     friend class CCoinsModifier;"
      },
      {
        "sha": "47b53cf7d6b8d3def938838be365511ba8f8a9f9",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 4,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -348,7 +348,6 @@ std::string HelpMessage(HelpMessageMode mode)\n         CURRENCY_UNIT, FormatMoney(payTxFee.GetFeePerK())));\n     strUsage += HelpMessageOpt(\"-rescan\", _(\"Rescan the block chain for missing wallet transactions\") + \" \" + _(\"on startup\"));\n     strUsage += HelpMessageOpt(\"-salvagewallet\", _(\"Attempt to recover private keys from a corrupt wallet.dat\") + \" \" + _(\"on startup\"));\n-    strUsage += HelpMessageOpt(\"-sendfreetransactions\", strprintf(_(\"Send transactions as zero-fee transactions if possible (default: %u)\"), 0));\n     strUsage += HelpMessageOpt(\"-spendzeroconfchange\", strprintf(_(\"Spend unconfirmed change when sending transactions (default: %u)\"), 1));\n     strUsage += HelpMessageOpt(\"-txconfirmtarget=<n>\", strprintf(_(\"If paytxfee is not set, include enough fee so transactions begin confirmation on average within n blocks (default: %u)\"), DEFAULT_TX_CONFIRM_TARGET));\n     strUsage += HelpMessageOpt(\"-maxtxfee=<amt>\", strprintf(_(\"Maximum total fees (in %s) to use in a single wallet transaction; setting this too low may abort large transactions (default: %s)\"),\n@@ -385,8 +384,6 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += HelpMessageOpt(\"-logtimestamps\", strprintf(_(\"Prepend debug output with timestamp (default: %u)\"), 1));\n     if (showDebug)\n     {\n-        strUsage += HelpMessageOpt(\"-limitfreerelay=<n>\", strprintf(\"Continuously rate-limit free transactions to <n>*1000 bytes per minute (default: %u)\", 15));\n-        strUsage += HelpMessageOpt(\"-relaypriority\", strprintf(\"Require high priority for relaying free or low-fee transactions (default: %u)\", 1));\n         strUsage += HelpMessageOpt(\"-maxsigcachesize=<n>\", strprintf(\"Limit size of signature cache to <n> entries (default: %u)\", 50000));\n     }\n     strUsage += HelpMessageOpt(\"-minrelaytxfee=<amt>\", strprintf(_(\"Fees (in %s/kB) smaller than this are considered zero fee for relaying (default: %s)\"),\n@@ -908,7 +905,6 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n     }\n     nTxConfirmTarget = GetArg(\"-txconfirmtarget\", DEFAULT_TX_CONFIRM_TARGET);\n     bSpendZeroConfChange = GetBoolArg(\"-spendzeroconfchange\", true);\n-    fSendFreeTransactions = GetBoolArg(\"-sendfreetransactions\", false);\n \n     std::string strWalletFile = GetArg(\"-wallet\", \"wallet.dat\");\n #endif // ENABLE_WALLET"
      },
      {
        "sha": "ab903759427139d6dce2d1641c609dc1c75d7751",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 65,
        "changes": 71,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -740,35 +740,6 @@ bool CheckTransaction(const CTransaction& tx, CValidationState &state)\n     return true;\n }\n \n-CAmount GetMinRelayFee(const CTransaction& tx, unsigned int nBytes, bool fAllowFree)\n-{\n-    {\n-        LOCK(mempool.cs);\n-        uint256 hash = tx.GetHash();\n-        double dPriorityDelta = 0;\n-        CAmount nFeeDelta = 0;\n-        mempool.ApplyDeltas(hash, dPriorityDelta, nFeeDelta);\n-        if (dPriorityDelta > 0 || nFeeDelta > 0)\n-            return 0;\n-    }\n-\n-    CAmount nMinFee = ::minRelayTxFee.GetFee(nBytes);\n-\n-    if (fAllowFree)\n-    {\n-        // There is a free transaction area in blocks created by most miners,\n-        // * If we are relaying we allow transactions up to DEFAULT_BLOCK_PRIORITY_SIZE - 1000\n-        //   to be considered to fall into this category. We don't want to encourage sending\n-        //   multiple transactions instead of one big transaction to avoid fees.\n-        if (nBytes < (DEFAULT_BLOCK_PRIORITY_SIZE - 1000))\n-            nMinFee = 0;\n-    }\n-\n-    if (!MoneyRange(nMinFee))\n-        nMinFee = MAX_MONEY;\n-    return nMinFee;\n-}\n-\n /** Convert CValidationState to a human-readable message for logging */\n static std::string FormatStateMessage(const CValidationState &state)\n {\n@@ -778,7 +749,7 @@ static std::string FormatStateMessage(const CValidationState &state)\n         state.GetRejectCode());\n }\n \n-bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransaction &tx, bool fLimitFree,\n+bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransaction &tx,\n                         bool* pfMissingInputs, bool fRejectAbsurdFee)\n {\n     AssertLockHeld(cs_main);\n@@ -874,39 +845,9 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         CTxMemPoolEntry entry(tx, nFees, GetTime(), chainActive.Height(), mempool.HasNoInputsOf(tx));\n         unsigned int nSize = entry.GetTxSize();\n \n-        // Don't accept it if it can't get into a block\n-        CAmount txMinFee = GetMinRelayFee(tx, nSize, true);\n-        if (fLimitFree && nFees < txMinFee)\n+        if (nFees < ::minRelayTxFee.GetFee(nSize))\n             return state.DoS(0, false, REJECT_INSUFFICIENTFEE, \"insufficient fee\", false,\n-                strprintf(\"%d < %d\", nFees, txMinFee));\n-\n-        // Require that free transactions have sufficient priority to be mined in the next block.\n-        if (GetBoolArg(\"-relaypriority\", true) && nFees < ::minRelayTxFee.GetFee(nSize) && !AllowFree(view.GetPriority(tx, chainActive.Height() + 1))) {\n-            return state.DoS(0, false, REJECT_INSUFFICIENTFEE, \"insufficient priority\");\n-        }\n-\n-        // Continuously rate-limit free (really, very-low-fee) transactions\n-        // This mitigates 'penny-flooding' -- sending thousands of free transactions just to\n-        // be annoying or make others' transactions take longer to confirm.\n-        if (fLimitFree && nFees < ::minRelayTxFee.GetFee(nSize))\n-        {\n-            static CCriticalSection csFreeLimiter;\n-            static double dFreeCount;\n-            static int64_t nLastTime;\n-            int64_t nNow = GetTime();\n-\n-            LOCK(csFreeLimiter);\n-\n-            // Use an exponentially decaying ~10-minute window:\n-            dFreeCount *= pow(1.0 - 1.0/600.0, (double)(nNow - nLastTime));\n-            nLastTime = nNow;\n-            // -limitfreerelay unit is thousand-bytes-per-minute\n-            // At default rate it would take over a month to fill 1GB\n-            if (dFreeCount >= GetArg(\"-limitfreerelay\", 15)*10*1000)\n-                return state.DoS(0, false, REJECT_INSUFFICIENTFEE, \"rate limited free transaction\");\n-            LogPrint(\"mempool\", \"Rate limit dFreeCount: %g => %g\\n\", dFreeCount, dFreeCount+nSize);\n-            dFreeCount += nSize;\n-        }\n+                             strprintf(\"%d < %d\", nFees, ::minRelayTxFee.GetFee(nSize)));\n \n         if (fRejectAbsurdFee && nFees > ::minRelayTxFee.GetFee(nSize) * 10000)\n             return state.Invalid(false,\n@@ -2025,7 +1966,7 @@ bool static DisconnectTip(CValidationState &state) {\n         // ignore validation errors in resurrected transactions\n         list<CTransaction> removed;\n         CValidationState stateDummy;\n-        if (tx.IsCoinBase() || !AcceptToMemoryPool(mempool, stateDummy, tx, false, NULL))\n+        if (tx.IsCoinBase() || !AcceptToMemoryPool(mempool, stateDummy, tx, NULL))\n             mempool.remove(tx, removed, true);\n     }\n     mempool.removeCoinbaseSpends(pcoinsTip, pindexDelete->nHeight);\n@@ -4236,7 +4177,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n \n         mapAlreadyAskedFor.erase(inv);\n \n-        if (AcceptToMemoryPool(mempool, state, tx, true, &fMissingInputs))\n+        if (AcceptToMemoryPool(mempool, state, tx, &fMissingInputs))\n         {\n             mempool.check(pcoinsTip);\n             RelayTransaction(tx);\n@@ -4270,7 +4211,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n \n                     if (setMisbehaving.count(fromPeer))\n                         continue;\n-                    if (AcceptToMemoryPool(mempool, stateDummy, orphanTx, true, &fMissingInputs2))\n+                    if (AcceptToMemoryPool(mempool, stateDummy, orphanTx, &fMissingInputs2))\n                     {\n                         LogPrint(\"mempool\", \"   accepted orphan tx %s\\n\", orphanHash.ToString());\n                         RelayTransaction(orphanTx);"
      },
      {
        "sha": "de0e863b686b32eb670f8757e8d1befeacd19639",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -216,7 +216,7 @@ void FlushStateToDisk();\n void PruneAndFlush();\n \n /** (try to) add transaction to memory pool **/\n-bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransaction &tx, bool fLimitFree,\n+bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransaction &tx,\n                         bool* pfMissingInputs, bool fRejectAbsurdFee=false);\n \n \n@@ -253,7 +253,7 @@ struct CDiskTxPos : public CDiskBlockPos\n };\n \n \n-CAmount GetMinRelayFee(const CTransaction& tx, unsigned int nBytes, bool fAllowFree);\n+CAmount GetMinRelayFee(const CTransaction& tx, unsigned int nBytes);\n \n /** \n  * Count ECDSA signature operations the old-fashioned (pre-0.6) way"
      },
      {
        "sha": "d4ac0efb48bf74e7f34eff3548933f7e21ba84f9",
        "filename": "src/miner.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 19,
        "changes": 25,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/miner.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/miner.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/miner.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -117,11 +117,6 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n     // Limit to betweeen 1K and MAX_BLOCK_SIZE-1K for sanity:\n     nBlockMaxSize = std::max((unsigned int)1000, std::min((unsigned int)(MAX_BLOCK_SIZE-1000), nBlockMaxSize));\n \n-    // Minimum block size you want to create; block will be filled with free transactions\n-    // until there are no more or the block reaches this size:\n-    unsigned int nBlockMinSize = GetArg(\"-blockminsize\", DEFAULT_BLOCK_MIN_SIZE);\n-    nBlockMinSize = std::min(nBlockMaxSize, nBlockMinSize);\n-\n     // Collect memory pool transactions into the block\n     CAmount nFees = 0;\n \n@@ -148,7 +143,6 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n                 continue;\n \n             COrphan* porphan = NULL;\n-            double dPriority = 0;\n             CAmount nTotalIn = 0;\n             bool fMissingInputs = false;\n             BOOST_FOREACH(const CTxIn& txin, tx.vin)\n@@ -186,19 +180,14 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n \n                 CAmount nValueIn = coins->vout[txin.prevout.n].nValue;\n                 nTotalIn += nValueIn;\n-\n-                int nConf = nHeight - coins->nHeight;\n-\n-                dPriority += (double)nValueIn * nConf;\n             }\n             if (fMissingInputs) continue;\n \n             // Priority is sum(valuein * age) / modified_txsize\n             unsigned int nTxSize = ::GetSerializeSize(tx, SER_NETWORK, PROTOCOL_VERSION);\n-            dPriority = tx.ComputePriority(dPriority, nTxSize);\n \n             uint256 hash = tx.GetHash();\n-            mempool.ApplyDeltas(hash, dPriority, nTotalIn);\n+            mempool.ApplyDeltas(hash, nTotalIn);\n \n             CFeeRate feeRate(nTotalIn-tx.GetValueOut(), nTxSize);\n \n@@ -219,7 +208,6 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n         while (!vecPriority.empty())\n         {\n             // Take highest priority transaction off the priority queue:\n-            double dPriority = 0;\n             CFeeRate feeRate = vecPriority.front().get<0>();\n             const CTransaction& tx = *(vecPriority.front().get<1>());\n \n@@ -236,12 +224,11 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n             if (nBlockSigOps + nTxSigOps >= MAX_BLOCK_SIGOPS)\n                 continue;\n \n-            // Skip free transactions if we're past the minimum block size:\n+            // Skip low-fee transactions\n             const uint256& hash = tx.GetHash();\n-            double dPriorityDelta = 0;\n             CAmount nFeeDelta = 0;\n-            mempool.ApplyDeltas(hash, dPriorityDelta, nFeeDelta);\n-            if ((dPriorityDelta <= 0) && (nFeeDelta <= 0) && (feeRate < ::minRelayTxFee) && (nBlockSize + nTxSize >= nBlockMinSize))\n+            mempool.ApplyDeltas(hash, nFeeDelta);\n+            if ((nFeeDelta <= 0) && (feeRate < ::minRelayTxFee))\n                 continue;\n \n             CAmount nTxFees;\n@@ -271,8 +258,8 @@ CBlockTemplate* CreateNewBlock(const CScript& scriptPubKeyIn)\n \n             if (fPrintPriority)\n             {\n-                LogPrintf(\"priority %.1f fee %s txid %s\\n\",\n-                    dPriority, feeRate.ToString(), tx.GetHash().ToString());\n+                LogPrintf(\"fee %s txid %s\\n\",\n+                    feeRate.ToString(), tx.GetHash().ToString());\n             }\n \n             // Add transactions that depend on this one to the priority queue"
      },
      {
        "sha": "51766706a3374b0631d0f16b693159deddc4d94a",
        "filename": "src/qt/coincontroldialog.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 14,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/qt/coincontroldialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/qt/coincontroldialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/coincontroldialog.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -424,20 +424,7 @@ void CoinControlDialog::viewItemChanged(QTreeWidgetItem* item, int column)\n // return human readable label for priority number\n QString CoinControlDialog::getPriorityLabel(double dPriority, double mempoolEstimatePriority)\n {\n-    double dPriorityMedium = mempoolEstimatePriority;\n-\n-    if (dPriorityMedium <= 0)\n-        dPriorityMedium = AllowFreeThreshold(); // not enough data, back to hard-coded\n-\n-    if      (dPriority / 1000000 > dPriorityMedium) return tr(\"highest\");\n-    else if (dPriority / 100000 > dPriorityMedium)  return tr(\"higher\");\n-    else if (dPriority / 10000 > dPriorityMedium)   return tr(\"high\");\n-    else if (dPriority / 1000 > dPriorityMedium)    return tr(\"medium-high\");\n-    else if (dPriority > dPriorityMedium)           return tr(\"medium\");\n-    else if (dPriority * 10 > dPriorityMedium)      return tr(\"low-medium\");\n-    else if (dPriority * 100 > dPriorityMedium)     return tr(\"low\");\n-    else if (dPriority * 1000 > dPriorityMedium)    return tr(\"lower\");\n-    else                                            return tr(\"lowest\");\n+    return tr(\"medium\");\n }\n \n // shows count of locked unspent outputs"
      },
      {
        "sha": "1e9a7df461443c59f9f6980ac7467dbe5ce9dfe6",
        "filename": "src/qt/forms/sendcoinsdialog.ui",
        "status": "modified",
        "additions": 0,
        "deletions": 17,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/qt/forms/sendcoinsdialog.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/qt/forms/sendcoinsdialog.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/sendcoinsdialog.ui?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -1175,23 +1175,6 @@\n              <property name=\"bottomMargin\">\n               <number>4</number>\n              </property>\n-             <item>\n-              <widget class=\"QCheckBox\" name=\"checkBoxFreeTx\">\n-               <property name=\"text\">\n-                <string>Send as zero-fee transaction if possible</string>\n-               </property>\n-              </widget>\n-             </item>\n-             <item>\n-              <widget class=\"QLabel\" name=\"labelFreeTx\">\n-               <property name=\"text\">\n-                <string>(confirmation may take longer)</string>\n-               </property>\n-               <property name=\"margin\">\n-                <number>5</number>\n-               </property>\n-              </widget>\n-             </item>\n              <item>\n               <spacer name=\"horizontalSpacerFee5\">\n                <property name=\"orientation\">"
      },
      {
        "sha": "3048bdb4977e44b6b710f3f7dda6105693d069df",
        "filename": "src/qt/sendcoinsdialog.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 8,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/qt/sendcoinsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/qt/sendcoinsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsdialog.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -104,8 +104,6 @@ SendCoinsDialog::SendCoinsDialog(const PlatformStyle *platformStyle, QWidget *pa\n         settings.setValue(\"nTransactionFee\", (qint64)DEFAULT_TRANSACTION_FEE);\n     if (!settings.contains(\"fPayOnlyMinFee\"))\n         settings.setValue(\"fPayOnlyMinFee\", false);\n-    if (!settings.contains(\"fSendFreeTransactions\"))\n-        settings.setValue(\"fSendFreeTransactions\", false);\n     ui->groupFee->setId(ui->radioSmartFee, 0);\n     ui->groupFee->setId(ui->radioCustomFee, 1);\n     ui->groupFee->button((int)std::max(0, std::min(1, settings.value(\"nFeeRadio\").toInt())))->setChecked(true);\n@@ -115,7 +113,6 @@ SendCoinsDialog::SendCoinsDialog(const PlatformStyle *platformStyle, QWidget *pa\n     ui->sliderSmartFee->setValue(settings.value(\"nSmartFeeSliderPosition\").toInt());\n     ui->customFee->setValue(settings.value(\"nTransactionFee\").toLongLong());\n     ui->checkBoxMinimumFee->setChecked(settings.value(\"fPayOnlyMinFee\").toBool());\n-    ui->checkBoxFreeTx->setChecked(settings.value(\"fSendFreeTransactions\").toBool());\n     minimizeFeeSection(settings.value(\"fFeeSectionMinimized\").toBool());\n }\n \n@@ -170,8 +167,6 @@ void SendCoinsDialog::setModel(WalletModel *model)\n         connect(ui->checkBoxMinimumFee, SIGNAL(stateChanged(int)), this, SLOT(updateFeeSectionControls()));\n         connect(ui->checkBoxMinimumFee, SIGNAL(stateChanged(int)), this, SLOT(updateGlobalFeeVariables()));\n         connect(ui->checkBoxMinimumFee, SIGNAL(stateChanged(int)), this, SLOT(coinControlUpdateLabels()));\n-        connect(ui->checkBoxFreeTx, SIGNAL(stateChanged(int)), this, SLOT(updateGlobalFeeVariables()));\n-        connect(ui->checkBoxFreeTx, SIGNAL(stateChanged(int)), this, SLOT(coinControlUpdateLabels()));\n         ui->customFee->setSingleStep(CWallet::minTxFee.GetFeePerK());\n         updateFeeSectionControls();\n         updateMinFeeLabel();\n@@ -189,7 +184,6 @@ SendCoinsDialog::~SendCoinsDialog()\n     settings.setValue(\"nSmartFeeSliderPosition\", ui->sliderSmartFee->value());\n     settings.setValue(\"nTransactionFee\", (qint64)ui->customFee->value());\n     settings.setValue(\"fPayOnlyMinFee\", ui->checkBoxMinimumFee->isChecked());\n-    settings.setValue(\"fSendFreeTransactions\", ui->checkBoxFreeTx->isChecked());\n \n     delete ui;\n }\n@@ -601,8 +595,6 @@ void SendCoinsDialog::updateGlobalFeeVariables()\n         payTxFee = CFeeRate(ui->customFee->value());\n         fPayAtLeastCustomFee = ui->radioCustomAtLeast->isChecked();\n     }\n-\n-    fSendFreeTransactions = ui->checkBoxFreeTx->isChecked();\n }\n \n void SendCoinsDialog::updateFeeMinimizedLabel()"
      },
      {
        "sha": "58a8245dffd339a461f2d15f24b4128197ed1dee",
        "filename": "src/rpcmining.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 9,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/rpcmining.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/rpcmining.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcmining.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -273,29 +273,26 @@ UniValue prioritisetransaction(const UniValue& params, bool fHelp)\n {\n     if (fHelp || params.size() != 3)\n         throw runtime_error(\n-            \"prioritisetransaction <txid> <priority delta> <fee delta>\\n\"\n+            \"prioritisetransaction <txid> <fee delta>\\n\"\n             \"Accepts the transaction into mined blocks at a higher (or lower) priority\\n\"\n             \"\\nArguments:\\n\"\n             \"1. \\\"txid\\\"       (string, required) The transaction id.\\n\"\n-            \"2. priority delta (numeric, required) The priority to add or subtract.\\n\"\n-            \"                  The transaction selection algorithm considers the tx as it would have a higher priority.\\n\"\n-            \"                  (priority of a transaction is calculated: coinage * value_in_satoshis / txsize) \\n\"\n-            \"3. fee delta      (numeric, required) The fee value (in satoshis) to add (or subtract, if negative).\\n\"\n+            \"2. fee delta      (numeric, required) The fee value (in satoshis) to add (or subtract, if negative).\\n\"\n             \"                  The fee is not actually paid, only the algorithm for selecting transactions into a block\\n\"\n             \"                  considers the transaction as it would have paid a higher (or lower) fee.\\n\"\n             \"\\nResult\\n\"\n             \"true              (boolean) Returns true\\n\"\n             \"\\nExamples:\\n\"\n-            + HelpExampleCli(\"prioritisetransaction\", \"\\\"txid\\\" 0.0 10000\")\n-            + HelpExampleRpc(\"prioritisetransaction\", \"\\\"txid\\\", 0.0, 10000\")\n+            + HelpExampleCli(\"prioritisetransaction\", \"\\\"txid\\\" 10000\")\n+            + HelpExampleRpc(\"prioritisetransaction\", \"\\\"txid\\\", 10000\")\n         );\n \n     LOCK(cs_main);\n \n     uint256 hash = ParseHashStr(params[0].get_str(), \"txid\");\n-    CAmount nAmount = params[2].get_int64();\n+    CAmount nAmount = params[1].get_int64();\n \n-    mempool.PrioritiseTransaction(hash, params[0].get_str(), params[1].get_real(), nAmount);\n+    mempool.PrioritiseTransaction(hash, params[0].get_str(), nAmount);\n     return true;\n }\n "
      },
      {
        "sha": "ce284c1421e14c253c4b5fa49771f64677a67367",
        "filename": "src/rpcmisc.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/rpcmisc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/rpcmisc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcmisc.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -61,7 +61,7 @@ UniValue getinfo(const UniValue& params, bool fHelp)\n             \"  \\\"keypoolsize\\\": xxxx,        (numeric) how many new keys are pre-generated\\n\"\n             \"  \\\"unlocked_until\\\": ttt,      (numeric) the timestamp in seconds since epoch (midnight Jan 1 1970 GMT) that the wallet is unlocked for transfers, or 0 if the wallet is locked\\n\"\n             \"  \\\"paytxfee\\\": x.xxxx,         (numeric) the transaction fee set in \" + CURRENCY_UNIT + \"/kB\\n\"\n-            \"  \\\"relayfee\\\": x.xxxx,         (numeric) minimum relay fee for non-free transactions in \" + CURRENCY_UNIT + \"/kB\\n\"\n+            \"  \\\"relayfee\\\": x.xxxx,         (numeric) minimum relay fee, transactions in \" + CURRENCY_UNIT + \"/kB\\n\"\n             \"  \\\"errors\\\": \\\"...\\\"           (string) any error messages\\n\"\n             \"}\\n\"\n             \"\\nExamples:\\n\""
      },
      {
        "sha": "6c893a28d5e13e1bc5eb9e776f4d41c1cfafade8",
        "filename": "src/rpcnet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/rpcnet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/rpcnet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcnet.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -423,7 +423,7 @@ UniValue getnetworkinfo(const UniValue& params, bool fHelp)\n             \"  }\\n\"\n             \"  ,...\\n\"\n             \"  ],\\n\"\n-            \"  \\\"relayfee\\\": x.xxxxxxxx,                (numeric) minimum relay fee for non-free transactions in \" + CURRENCY_UNIT + \"/kB\\n\"\n+            \"  \\\"relayfee\\\": x.xxxxxxxx,                (numeric) minimum relay fee, in \" + CURRENCY_UNIT + \"/kB\\n\"\n             \"  \\\"localaddresses\\\": [                    (array) list of local addresses\\n\"\n             \"  {\\n\"\n             \"    \\\"address\\\": \\\"xxxx\\\",                 (string) network address\\n\""
      },
      {
        "sha": "c3272cf908abc2d33b5d3a79d4522be10650ef6c",
        "filename": "src/rpcrawtransaction.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/rpcrawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/rpcrawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcrawtransaction.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -809,7 +809,7 @@ UniValue sendrawtransaction(const UniValue& params, bool fHelp)\n         // push to local node and sync with wallets\n         CValidationState state;\n         bool fMissingInputs;\n-        if (!AcceptToMemoryPool(mempool, state, tx, false, &fMissingInputs, !fOverrideFees)) {\n+        if (!AcceptToMemoryPool(mempool, state, tx, &fMissingInputs, !fOverrideFees)) {\n             if (state.IsInvalid()) {\n                 throw JSONRPCError(RPC_TRANSACTION_REJECTED, strprintf(\"%i: %s\", state.GetRejectCode(), state.GetRejectReason()));\n             } else {"
      },
      {
        "sha": "1217f373caa5ab547df50c165a6bd4f305f3b22f",
        "filename": "src/test/txvalidationcache_tests.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/test/txvalidationcache_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/test/txvalidationcache_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/txvalidationcache_tests.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -23,7 +23,7 @@ ToMemPool(CMutableTransaction& tx)\n     LOCK(cs_main);\n \n     CValidationState state;\n-    return AcceptToMemoryPool(mempool, state, tx, false, NULL, false);\n+    return AcceptToMemoryPool(mempool, state, tx, NULL, false);\n }\n \n BOOST_FIXTURE_TEST_CASE(tx_mempool_block_doublespend, TestChain100Setup)"
      },
      {
        "sha": "5e3ccb543dcb3365eeff3d4f68e1ddf1d5fd1c0b",
        "filename": "src/txmempool.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 10,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/txmempool.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/txmempool.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -365,26 +365,24 @@ CTxMemPool::ReadFeeEstimates(CAutoFile& filein)\n     return true;\n }\n \n-void CTxMemPool::PrioritiseTransaction(const uint256 hash, const string strHash, double dPriorityDelta, const CAmount& nFeeDelta)\n+void CTxMemPool::PrioritiseTransaction(const uint256 hash, const string strHash, const CAmount& nFeeDelta)\n {\n     {\n         LOCK(cs);\n-        std::pair<double, CAmount> &deltas = mapDeltas[hash];\n-        deltas.first += dPriorityDelta;\n-        deltas.second += nFeeDelta;\n+        CAmount &delta = mapDeltas[hash];\n+        delta += nFeeDelta;\n     }\n-    LogPrintf(\"PrioritiseTransaction: %s priority += %f, fee += %d\\n\", strHash, dPriorityDelta, FormatMoney(nFeeDelta));\n+    LogPrintf(\"PrioritiseTransaction: %s fee += %d\\n\", strHash, FormatMoney(nFeeDelta));\n }\n \n-void CTxMemPool::ApplyDeltas(const uint256 hash, double &dPriorityDelta, CAmount &nFeeDelta)\n+void CTxMemPool::ApplyDeltas(const uint256 hash, CAmount &nFeeDelta)\n {\n     LOCK(cs);\n-    std::map<uint256, std::pair<double, CAmount> >::iterator pos = mapDeltas.find(hash);\n+    std::map<uint256, CAmount>::iterator pos = mapDeltas.find(hash);\n     if (pos == mapDeltas.end())\n         return;\n-    const std::pair<double, CAmount> &deltas = pos->second;\n-    dPriorityDelta += deltas.first;\n-    nFeeDelta += deltas.second;\n+    const CAmount &delta = pos->second;\n+    nFeeDelta += delta;\n }\n \n void CTxMemPool::ClearPrioritisation(const uint256 hash)"
      },
      {
        "sha": "53bcb50144ad16f1827abcff14198e49d0aa06cd",
        "filename": "src/txmempool.h",
        "status": "modified",
        "additions": 3,
        "deletions": 13,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/txmempool.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/txmempool.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.h?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -15,16 +15,6 @@\n \n class CAutoFile;\n \n-inline double AllowFreeThreshold()\n-{\n-    return COIN * 144 / 250;\n-}\n-\n-inline bool AllowFree(double dPriority)\n-{\n-    return false;\n-}\n-\n /** Fake height value used in CCoins to signify they are only in the memory pool (since 0.8) */\n static const unsigned int MEMPOOL_HEIGHT = 0x7FFFFFFF;\n \n@@ -99,7 +89,7 @@ class CTxMemPool\n     mutable CCriticalSection cs;\n     std::map<uint256, CTxMemPoolEntry> mapTx;\n     std::map<COutPoint, CInPoint> mapNextTx;\n-    std::map<uint256, std::pair<double, CAmount> > mapDeltas;\n+    std::map<uint256, CAmount> mapDeltas;\n \n     CTxMemPool(const CFeeRate& _minRelayFee);\n     ~CTxMemPool();\n@@ -131,8 +121,8 @@ class CTxMemPool\n     bool HasNoInputsOf(const CTransaction& tx) const;\n \n     /** Affect CreateNewBlock prioritisation of transactions */\n-    void PrioritiseTransaction(const uint256 hash, const std::string strHash, double dPriorityDelta, const CAmount& nFeeDelta);\n-    void ApplyDeltas(const uint256 hash, double &dPriorityDelta, CAmount &nFeeDelta);\n+    void PrioritiseTransaction(const uint256 hash, const std::string strHash, const CAmount& nFeeDelta);\n+    void ApplyDeltas(const uint256 hash, CAmount &nFeeDelta);\n     void ClearPrioritisation(const uint256 hash);\n \n     unsigned long size()"
      },
      {
        "sha": "00036195a963cbb4040ca090d79997a61056346a",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 3,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -40,7 +40,6 @@ CFeeRate payTxFee(DEFAULT_TRANSACTION_FEE);\n CAmount maxTxFee = DEFAULT_TRANSACTION_MAXFEE;\n unsigned int nTxConfirmTarget = DEFAULT_TX_CONFIRM_TARGET;\n bool bSpendZeroConfChange = true;\n-bool fSendFreeTransactions = false;\n bool fPayAtLeastCustomFee = true;\n \n /**\n@@ -2862,9 +2861,9 @@ int CMerkleTx::GetBlocksToMaturity() const\n }\n \n \n-bool CMerkleTx::AcceptToMemoryPool(bool fLimitFree, bool fRejectAbsurdFee)\n+bool CMerkleTx::AcceptToMemoryPool(bool fRejectAbsurdFee)\n {\n     CValidationState state;\n-    return ::AcceptToMemoryPool(mempool, state, *this, fLimitFree, NULL, fRejectAbsurdFee);\n+    return ::AcceptToMemoryPool(mempool, state, *this, NULL, fRejectAbsurdFee);\n }\n "
      },
      {
        "sha": "8c63159d07f8cfc1c4e0c55cbaa0e167446b2095",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/48abd4a9162804a73550d533fd364c65ff123640/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/48abd4a9162804a73550d533fd364c65ff123640/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=48abd4a9162804a73550d533fd364c65ff123640",
        "patch": "@@ -34,7 +34,6 @@ extern CFeeRate payTxFee;\n extern CAmount maxTxFee;\n extern unsigned int nTxConfirmTarget;\n extern bool bSpendZeroConfChange;\n-extern bool fSendFreeTransactions;\n extern bool fPayAtLeastCustomFee;\n \n //! -paytxfee default\n@@ -199,7 +198,7 @@ class CMerkleTx : public CTransaction\n     int GetDepthInMainChain() const { const CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }\n     bool IsInMainChain() const { const CBlockIndex *pindexRet; return GetDepthInMainChainINTERNAL(pindexRet) > 0; }\n     int GetBlocksToMaturity() const;\n-    bool AcceptToMemoryPool(bool fLimitFree=true, bool fRejectAbsurdFee=true);\n+    bool AcceptToMemoryPool(bool fRejectAbsurdFee=true);\n };\n \n /** "
      }
    ]
  },
  {
    "sha": "442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NDI4MDhlNjVmYmZjOTJhY2Q1NzA0ZjBiNmYwMDVjMmNhMGJhNWI5",
    "commit": {
      "author": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-08-25T22:06:28Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-08-25T22:06:28Z"
      },
      "message": "Policy: Remove free transactions from python tests",
      "tree": {
        "sha": "b33b89ee039bbc5fd5ae412af41dba1897cb44eb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b33b89ee039bbc5fd5ae412af41dba1897cb44eb"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/comments",
    "author": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "48abd4a9162804a73550d533fd364c65ff123640",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/48abd4a9162804a73550d533fd364c65ff123640",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/48abd4a9162804a73550d533fd364c65ff123640"
      }
    ],
    "stats": {
      "total": 39,
      "additions": 21,
      "deletions": 18
    },
    "files": [
      {
        "sha": "1b2b329a5cf06b5f2381e4bdd603c507ca94be32",
        "filename": "qa/rpc-tests/mempool_coinbase_spends.py",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/mempool_coinbase_spends.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/mempool_coinbase_spends.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/mempool_coinbase_spends.py?ref=442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
        "patch": "@@ -29,7 +29,7 @@ def setup_network(self):\n \n     def create_tx(self, from_txid, to_address, amount):\n         inputs = [{ \"txid\" : from_txid, \"vout\" : 0}]\n-        outputs = { to_address : amount }\n+        outputs = { to_address : amount - exampleFee}\n         rawtx = self.nodes[0].createrawtransaction(inputs, outputs)\n         signresult = self.nodes[0].signrawtransaction(rawtx)\n         assert_equal(signresult[\"complete\"], True)\n@@ -64,8 +64,8 @@ def run_test(self):\n         self.nodes[0].generate(1)\n \n         # Create 102_1 and 103_1:\n-        spend_102_1_raw = self.create_tx(spend_102_id, node1_address, 50)\n-        spend_103_1_raw = self.create_tx(spend_103_id, node1_address, 50)\n+        spend_102_1_raw = self.create_tx(spend_102_id, node1_address, 50 - exampleFee)\n+        spend_103_1_raw = self.create_tx(spend_103_id, node1_address, 50 - exampleFee)\n \n         # Broadcast and mine 103_1:\n         spend_103_1_id = self.nodes[0].sendrawtransaction(spend_103_1_raw)"
      },
      {
        "sha": "358ad1732e1632c714fc6ef98ac19d1a8edc27a0",
        "filename": "qa/rpc-tests/mempool_resurrect_test.py",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/mempool_resurrect_test.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/mempool_resurrect_test.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/mempool_resurrect_test.py?ref=442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
        "patch": "@@ -24,8 +24,9 @@ def setup_network(self):\n         self.is_network_split = False\n \n     def create_tx(self, from_txid, to_address, amount):\n+        amountSatoshis = int(amount * 100000000) - int(exampleFee * 100000000)\n         inputs = [{ \"txid\" : from_txid, \"vout\" : 0}]\n-        outputs = { to_address : amount }\n+        outputs = { to_address : float(amountSatoshis) / 100000000}\n         rawtx = self.nodes[0].createrawtransaction(inputs, outputs)\n         signresult = self.nodes[0].signrawtransaction(rawtx)\n         assert_equal(signresult[\"complete\"], True)"
      },
      {
        "sha": "0a85fa89b54c188b63de28a95c5ae7fd6804f9ce",
        "filename": "qa/rpc-tests/mempool_spendcoinbase.py",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/mempool_spendcoinbase.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/mempool_spendcoinbase.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/mempool_spendcoinbase.py?ref=442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
        "patch": "@@ -30,7 +30,7 @@ def setup_network(self):\n \n     def create_tx(self, from_txid, to_address, amount):\n         inputs = [{ \"txid\" : from_txid, \"vout\" : 0}]\n-        outputs = { to_address : amount }\n+        outputs = { to_address : amount - exampleFee}\n         rawtx = self.nodes[0].createrawtransaction(inputs, outputs)\n         signresult = self.nodes[0].signrawtransaction(rawtx)\n         assert_equal(signresult[\"complete\"], True)"
      },
      {
        "sha": "acc0e141b52953ce8ec1e99244d1761ae049c743",
        "filename": "qa/rpc-tests/merkle_blocks.py",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/merkle_blocks.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/merkle_blocks.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/merkle_blocks.py?ref=442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
        "patch": "@@ -44,9 +44,9 @@ def run_test(self):\n         assert_equal(self.nodes[2].getbalance(), 0)\n \n         node0utxos = self.nodes[0].listunspent(1)\n-        tx1 = self.nodes[0].createrawtransaction([node0utxos.pop()], {self.nodes[1].getnewaddress(): 50})\n+        tx1 = self.nodes[0].createrawtransaction([node0utxos.pop()], {self.nodes[1].getnewaddress(): 50 - exampleFee})\n         txid1 = self.nodes[0].sendrawtransaction(self.nodes[0].signrawtransaction(tx1)[\"hex\"])\n-        tx2 = self.nodes[0].createrawtransaction([node0utxos.pop()], {self.nodes[1].getnewaddress(): 50})\n+        tx2 = self.nodes[0].createrawtransaction([node0utxos.pop()], {self.nodes[1].getnewaddress(): 50 - exampleFee})\n         txid2 = self.nodes[0].sendrawtransaction(self.nodes[0].signrawtransaction(tx2)[\"hex\"])\n         assert_raises(JSONRPCException, self.nodes[0].gettxoutproof, [txid1])\n \n@@ -64,7 +64,7 @@ def run_test(self):\n         assert_equal(self.nodes[2].verifytxoutproof(self.nodes[2].gettxoutproof([txid1, txid2], blockhash)), txlist)\n \n         txin_spent = self.nodes[1].listunspent(1).pop()\n-        tx3 = self.nodes[1].createrawtransaction([txin_spent], {self.nodes[0].getnewaddress(): 50})\n+        tx3 = self.nodes[1].createrawtransaction([txin_spent], {self.nodes[0].getnewaddress(): 50 - 2 * exampleFee})\n         self.nodes[0].sendrawtransaction(self.nodes[1].signrawtransaction(tx3)[\"hex\"])\n         self.nodes[0].generate(1)\n         self.sync_all()"
      },
      {
        "sha": "00e867010f89bfecc502a9eb09029df6a00281a8",
        "filename": "qa/rpc-tests/test_framework/util.py",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/test_framework/util.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/test_framework/util.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/test_framework/util.py?ref=442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
        "patch": "@@ -20,6 +20,8 @@\n from authproxy import AuthServiceProxy, JSONRPCException\n from util import *\n \n+exampleFee = Decimal('0.001')\n+\n def p2p_port(n):\n     return 11000 + n + os.getpid()%999\n def rpc_port(n):"
      },
      {
        "sha": "bf9f3b0e6f52d7facd1810ec595bd69514e27415",
        "filename": "qa/rpc-tests/wallet.py",
        "status": "modified",
        "additions": 10,
        "deletions": 10,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/wallet.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/442808e65fbfc92acd5704f0b6f005c2ca0ba5b9/qa/rpc-tests/wallet.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/wallet.py?ref=442808e65fbfc92acd5704f0b6f005c2ca0ba5b9",
        "patch": "@@ -86,7 +86,7 @@ def run_test (self):\n             inputs = []\n             outputs = {}\n             inputs.append({ \"txid\" : utxo[\"txid\"], \"vout\" : utxo[\"vout\"]})\n-            outputs[self.nodes[2].getnewaddress(\"from1\")] = utxo[\"amount\"]\n+            outputs[self.nodes[2].getnewaddress(\"from1\")] = utxo[\"amount\"] - exampleFee\n             raw_tx = self.nodes[0].createrawtransaction(inputs, outputs)\n             txns_to_send.append(self.nodes[0].signrawtransaction(raw_tx))\n \n@@ -99,37 +99,37 @@ def run_test (self):\n         self.sync_all()\n \n         assert_equal(self.nodes[0].getbalance(), 0)\n-        assert_equal(self.nodes[2].getbalance(), 100)\n-        assert_equal(self.nodes[2].getbalance(\"from1\"), 100-21)\n+        assert_equal(self.nodes[2].getbalance(), 100 - (2 * exampleFee) )\n+        assert_equal(self.nodes[2].getbalance(\"from1\"), 100 - 21 - (2 * exampleFee))\n \n         # Send 10 BTC normal\n         address = self.nodes[0].getnewaddress(\"test\")\n         self.nodes[2].settxfee(Decimal('0.001'))\n         txid = self.nodes[2].sendtoaddress(address, 10, \"\", \"\", False)\n         self.nodes[2].generate(1)\n         self.sync_all()\n-        assert_equal(self.nodes[2].getbalance(), Decimal('89.99900000'))\n+        assert_equal(self.nodes[2].getbalance(), Decimal('89.99900000') - (2 * exampleFee))\n         assert_equal(self.nodes[0].getbalance(), Decimal('10.00000000'))\n \n         # Send 10 BTC with subtract fee from amount\n         txid = self.nodes[2].sendtoaddress(address, 10, \"\", \"\", True)\n         self.nodes[2].generate(1)\n         self.sync_all()\n-        assert_equal(self.nodes[2].getbalance(), Decimal('79.99900000'))\n+        assert_equal(self.nodes[2].getbalance(), Decimal('79.99900000') - (2 * exampleFee))\n         assert_equal(self.nodes[0].getbalance(), Decimal('19.99900000'))\n \n         # Sendmany 10 BTC\n         txid = self.nodes[2].sendmany('from1', {address: 10}, 0, \"\", [])\n         self.nodes[2].generate(1)\n         self.sync_all()\n-        assert_equal(self.nodes[2].getbalance(), Decimal('69.99800000'))\n+        assert_equal(self.nodes[2].getbalance(), Decimal('69.99800000') - (2 * exampleFee))\n         assert_equal(self.nodes[0].getbalance(), Decimal('29.99900000'))\n \n         # Sendmany 10 BTC with subtract fee from amount\n         txid = self.nodes[2].sendmany('from1', {address: 10}, 0, \"\", [address])\n         self.nodes[2].generate(1)\n         self.sync_all()\n-        assert_equal(self.nodes[2].getbalance(), Decimal('59.99800000'))\n+        assert_equal(self.nodes[2].getbalance(), Decimal('59.99800000') - (2 * exampleFee))\n         assert_equal(self.nodes[0].getbalance(), Decimal('39.99800000'))\n \n         # Test ResendWalletTransactions:\n@@ -191,14 +191,14 @@ def run_test (self):\n         txObjNotBroadcasted = self.nodes[0].gettransaction(txIdNotBroadcasted)\n         self.nodes[1].generate(1) #mine a block, tx should not be in there\n         self.sync_all()\n-        assert_equal(self.nodes[2].getbalance(), Decimal('59.99800000')); #should not be changed because tx was not broadcasted\n+        assert_equal(self.nodes[2].getbalance(), Decimal('59.99800000') - (2 * exampleFee)); #should not be changed because tx was not broadcasted\n \n         #now broadcast from another node, mine a block, sync, and check the balance\n         self.nodes[1].sendrawtransaction(txObjNotBroadcasted['hex'])\n         self.nodes[1].generate(1)\n         self.sync_all()\n         txObjNotBroadcasted = self.nodes[0].gettransaction(txIdNotBroadcasted)\n-        assert_equal(self.nodes[2].getbalance(), Decimal('61.99800000')); #should not be\n+        assert_equal(self.nodes[2].getbalance(), Decimal('61.99800000') - (2 * exampleFee)); #should not be\n \n         #create another tx\n         txIdNotBroadcasted  = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), 2);\n@@ -216,7 +216,7 @@ def run_test (self):\n         sync_blocks(self.nodes)\n \n         #tx should be added to balance because after restarting the nodes tx should be broadcastet\n-        assert_equal(self.nodes[2].getbalance(), Decimal('63.99800000')); #should not be\n+        assert_equal(self.nodes[2].getbalance(), Decimal('63.99800000') - (2 * exampleFee)); #should not be\n \n         #send a tx with value in a string (PR#6380 +)\n         txId  = self.nodes[0].sendtoaddress(self.nodes[2].getnewaddress(), \"2\")"
      }
    ]
  }
]