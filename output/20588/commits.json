[
  {
    "sha": "faac31521bb7ecbf999541cf918d3750ff589de4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWFjMzE1MjFiYjdlY2JmOTk5NTQxY2Y5MThkMzc1MGZmNTg5ZGU0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-07T10:31:28Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-07T13:59:33Z"
      },
      "message": "Remove unused and confusing CTransaction constructor",
      "tree": {
        "sha": "57527364e2c2440ef0f93b6f971b1baa573ab7a6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/57527364e2c2440ef0f93b6f971b1baa573ab7a6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faac31521bb7ecbf999541cf918d3750ff589de4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiQMwv+Or9plvCpt/jLYyXDq400/vUOegE91nseD7ENkVFlwl5FATrdiS5kCZcc\n85woXw6jJ+Ghs2rqp4BpjN44otQWxaSPYwQCX65kxDv+ct68oScev8yPaTI29mD1\nKXqqwVeJHzAfEhlMuCL9vNdhQixK72UKHW6QNZpBAQEDzMt3WOUGE0WSodXtGqvi\n8GeLusrghbYHVagu3qqzFOiFNtlYJCzJ5/QQteIB3+UuqtohBNuhmXG8obyoifah\nm/uDgSoaHlQ7M3EBqlXHGwAz8paZoGh60pZgxiz3caW6AfAWDQvUN7yTWD1LiM6P\nBrP0IICtdT/tW3CAE14FqR3S7DnBs8RoHJ5EF1l279SUeDS+LyVVaeptYiteJrsQ\n88KzV3k6CJSmLLtmF63nQ7px423d2DCbMQipMDJdN/xv/jQP94vyFZy/Z9+XwBAd\ngzNX8sG2mRHTyA2wCDoAdHJBqrhkwkrcyFo3SvKYFCXzsRlCa+/s8TEdBunt4kdK\nOhdAcSok\n=qVx6\n-----END PGP SIGNATURE-----",
        "payload": "tree 57527364e2c2440ef0f93b6f971b1baa573ab7a6\nparent eab63b971d5fc3408214a958678a235bf454af99\nauthor MarcoFalke <falke.marco@gmail.com> 1607337088 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1607349573 +0100\n\nRemove unused and confusing CTransaction constructor\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faac31521bb7ecbf999541cf918d3750ff589de4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faac31521bb7ecbf999541cf918d3750ff589de4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faac31521bb7ecbf999541cf918d3750ff589de4/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "eab63b971d5fc3408214a958678a235bf454af99",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eab63b971d5fc3408214a958678a235bf454af99",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/eab63b971d5fc3408214a958678a235bf454af99"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 5,
      "deletions": 11
    },
    "files": [
      {
        "sha": "245206b906345d81a0e9963aba675f4bf4e62183",
        "filename": "src/primitives/transaction.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faac31521bb7ecbf999541cf918d3750ff589de4/src/primitives/transaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faac31521bb7ecbf999541cf918d3750ff589de4/src/primitives/transaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/primitives/transaction.cpp?ref=faac31521bb7ecbf999541cf918d3750ff589de4",
        "patch": "@@ -77,8 +77,6 @@ uint256 CTransaction::ComputeWitnessHash() const\n     return SerializeHash(*this, SER_GETHASH, 0);\n }\n \n-/* For backward compatibility, the hash is initialized to 0. TODO: remove the need for this default constructor entirely. */\n-CTransaction::CTransaction() : vin(), vout(), nVersion(CTransaction::CURRENT_VERSION), nLockTime(0), hash{}, m_witness_hash{} {}\n CTransaction::CTransaction(const CMutableTransaction& tx) : vin(tx.vin), vout(tx.vout), nVersion(tx.nVersion), nLockTime(tx.nLockTime), hash{ComputeHash()}, m_witness_hash{ComputeWitnessHash()} {}\n CTransaction::CTransaction(CMutableTransaction&& tx) : vin(std::move(tx.vin)), vout(std::move(tx.vout)), nVersion(tx.nVersion), nLockTime(tx.nLockTime), hash{ComputeHash()}, m_witness_hash{ComputeWitnessHash()} {}\n "
      },
      {
        "sha": "c1e9f0af2140cc171dc4af187a33566335b77c8c",
        "filename": "src/primitives/transaction.h",
        "status": "modified",
        "additions": 2,
        "deletions": 6,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faac31521bb7ecbf999541cf918d3750ff589de4/src/primitives/transaction.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faac31521bb7ecbf999541cf918d3750ff589de4/src/primitives/transaction.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/primitives/transaction.h?ref=faac31521bb7ecbf999541cf918d3750ff589de4",
        "patch": "@@ -287,12 +287,9 @@ class CTransaction\n     uint256 ComputeWitnessHash() const;\n \n public:\n-    /** Construct a CTransaction that qualifies as IsNull() */\n-    CTransaction();\n-\n     /** Convert a CMutableTransaction into a CTransaction. */\n-    explicit CTransaction(const CMutableTransaction &tx);\n-    CTransaction(CMutableTransaction &&tx);\n+    explicit CTransaction(const CMutableTransaction& tx);\n+    CTransaction(CMutableTransaction&& tx);\n \n     template <typename Stream>\n     inline void Serialize(Stream& s) const {\n@@ -393,7 +390,6 @@ struct CMutableTransaction\n };\n \n typedef std::shared_ptr<const CTransaction> CTransactionRef;\n-static inline CTransactionRef MakeTransactionRef() { return std::make_shared<const CTransaction>(); }\n template <typename Tx> static inline CTransactionRef MakeTransactionRef(Tx&& txIn) { return std::make_shared<const CTransaction>(std::forward<Tx>(txIn)); }\n \n /** A generic txid reference (txid or wtxid). */"
      },
      {
        "sha": "d67654bde3c9b0b6117aa873f6e08ac5f4b9e6e7",
        "filename": "src/test/fuzz/script_sigcache.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faac31521bb7ecbf999541cf918d3750ff589de4/src/test/fuzz/script_sigcache.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faac31521bb7ecbf999541cf918d3750ff589de4/src/test/fuzz/script_sigcache.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script_sigcache.cpp?ref=faac31521bb7ecbf999541cf918d3750ff589de4",
        "patch": "@@ -29,7 +29,7 @@ void test_one_input(const std::vector<uint8_t>& buffer)\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n \n     const std::optional<CMutableTransaction> mutable_transaction = ConsumeDeserializable<CMutableTransaction>(fuzzed_data_provider);\n-    const CTransaction tx = mutable_transaction ? CTransaction{*mutable_transaction} : CTransaction{};\n+    const CTransaction tx{mutable_transaction ? *mutable_transaction : CMutableTransaction{}};\n     const unsigned int n_in = fuzzed_data_provider.ConsumeIntegral<unsigned int>();\n     const CAmount amount = ConsumeMoney(fuzzed_data_provider);\n     const bool store = fuzzed_data_provider.ConsumeBool();"
      },
      {
        "sha": "9e4088370912b429ce6186d0cad9bbd4e3329355",
        "filename": "src/test/fuzz/transaction.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faac31521bb7ecbf999541cf918d3750ff589de4/src/test/fuzz/transaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faac31521bb7ecbf999541cf918d3750ff589de4/src/test/fuzz/transaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/transaction.cpp?ref=faac31521bb7ecbf999541cf918d3750ff589de4",
        "patch": "@@ -42,7 +42,7 @@ void test_one_input(const std::vector<uint8_t>& buffer)\n             return CTransaction(deserialize, ds);\n         } catch (const std::ios_base::failure&) {\n             valid_tx = false;\n-            return CTransaction();\n+            return CTransaction{CMutableTransaction{}};\n         }\n     }();\n     bool valid_mutable_tx = true;"
      },
      {
        "sha": "1bbfa197d753e824a2c8998a13abb947c43cefa4",
        "filename": "src/wallet/feebumper.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faac31521bb7ecbf999541cf918d3750ff589de4/src/wallet/feebumper.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faac31521bb7ecbf999541cf918d3750ff589de4/src/wallet/feebumper.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/feebumper.cpp?ref=faac31521bb7ecbf999541cf918d3750ff589de4",
        "patch": "@@ -215,7 +215,7 @@ Result CreateRateBumpTransaction(CWallet& wallet, const uint256& txid, const CCo\n     // We cannot source new unconfirmed inputs(bip125 rule 2)\n     new_coin_control.m_min_depth = 1;\n \n-    CTransactionRef tx_new = MakeTransactionRef();\n+    CTransactionRef tx_new;\n     CAmount fee_ret;\n     int change_pos_in_out = -1; // No requested location for change\n     bilingual_str fail_reason;"
      }
    ]
  },
  {
    "sha": "fac39c198324715565897f4240709340477af0bf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWMzOWMxOTgzMjQ3MTU1NjU4OTdmNDI0MDcwOTM0MDQ3N2FmMGJm",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-07T14:37:24Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-07T14:02:55Z"
      },
      "message": "wallet: document that tx in CreateTransaction is purely an out-param",
      "tree": {
        "sha": "9a29a3664fca0867fd1ed2126031e9aae95c22df",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9a29a3664fca0867fd1ed2126031e9aae95c22df"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fac39c198324715565897f4240709340477af0bf",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhiYgwAt9/tmruOumHhFEhRHdEzdpFB23/mMs+SGBAgHqmsKe52PeP2R8Qn8ZY1\nYpleq5edxx3B3sAHfXAcKLOhl/Z2UoZQ6+9/TKmg1llgh6g1cJMyIgp0ejSKt3dp\nkiRdx8CyA7uQVppMHoG7hc9DYy+j7I9lK6wqkAVvYNq6QNuizcRLyZpskXSIwvxO\ncnRDGYKoELSwoB9wYafsroTx2Rvnyiu4CTdz4tCzdNt3LE36FOkK86yk7H1RvQC/\n24DVHHfgXVPylbwLF4sdKcM8FDiS8lFa9fM7Pw1QptT/8CdxJRmdRtN0ZHNXprNz\nu7dmdGcfEwjJnE/J2g9Iz/swXh7mMah5vi+o8PBioicOiTVYavEfNbUKJQRqo3Om\nsGCHxP+LIXQPQUxG/XP63sglE0Afo22Lpw6OsWDV9gfRhkJ9UVgsjnTx3ysiEpJW\nEeRoUASb3lZ/4U/Vw3W2W96K42ODt5dETHuQCT+DCrof+isLom2o5Xc43+n3tjwx\nb3LWPMkp\n=FRC0\n-----END PGP SIGNATURE-----",
        "payload": "tree 9a29a3664fca0867fd1ed2126031e9aae95c22df\nparent faac31521bb7ecbf999541cf918d3750ff589de4\nauthor MarcoFalke <falke.marco@gmail.com> 1607351844 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1607349775 +0100\n\nwallet: document that tx in CreateTransaction is purely an out-param\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fac39c198324715565897f4240709340477af0bf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fac39c198324715565897f4240709340477af0bf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fac39c198324715565897f4240709340477af0bf/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "faac31521bb7ecbf999541cf918d3750ff589de4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faac31521bb7ecbf999541cf918d3750ff589de4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/faac31521bb7ecbf999541cf918d3750ff589de4"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "330559d0ddb9779369fbd64af3be68d8093bd3c9",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fac39c198324715565897f4240709340477af0bf/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fac39c198324715565897f4240709340477af0bf/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=fac39c198324715565897f4240709340477af0bf",
        "patch": "@@ -3109,13 +3109,14 @@ bool CWallet::CreateTransaction(\n         bool sign)\n {\n     int nChangePosIn = nChangePosInOut;\n-    CTransactionRef tx2 = tx;\n+    Assert(!tx); // tx is an out-param. TODO change the return type from bool to tx (or nullptr)\n     bool res = CreateTransactionInternal(vecSend, tx, nFeeRet, nChangePosInOut, error, coin_control, fee_calc_out, sign);\n     // try with avoidpartialspends unless it's enabled already\n     if (res && nFeeRet > 0 /* 0 means non-functional fee rate estimation */ && m_max_aps_fee > -1 && !coin_control.m_avoid_partial_spends) {\n         CCoinControl tmp_cc = coin_control;\n         tmp_cc.m_avoid_partial_spends = true;\n         CAmount nFeeRet2;\n+        CTransactionRef tx2;\n         int nChangePosInOut2 = nChangePosIn;\n         bilingual_str error2; // fired and forgotten; if an error occurs, we discard the results\n         if (CreateTransactionInternal(vecSend, tx2, nFeeRet2, nChangePosInOut2, error2, tmp_cc, fee_calc_out, sign)) {"
      }
    ]
  }
]