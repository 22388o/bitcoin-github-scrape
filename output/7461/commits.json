[
  {
    "sha": "671b81950b4e5047bcc48a3ffac56be3f5539d75",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NzFiODE5NTBiNGU1MDQ3YmNjNDhhM2ZmYWM1NmJlM2Y1NTM5ZDc1",
    "commit": {
      "author": {
        "name": "Tom Zander",
        "email": "tomz@freedommail.ch",
        "date": "2016-02-03T11:07:44Z"
      },
      "committer": {
        "name": "Tom Zander",
        "email": "tomz@freedommail.ch",
        "date": "2016-02-03T14:54:57Z"
      },
      "message": "Make internal (core) errors show up in the Qt client.",
      "tree": {
        "sha": "a1d3feff0abc5f0150e2f0608d1c2376039a1550",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a1d3feff0abc5f0150e2f0608d1c2376039a1550"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/671b81950b4e5047bcc48a3ffac56be3f5539d75",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/671b81950b4e5047bcc48a3ffac56be3f5539d75",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/671b81950b4e5047bcc48a3ffac56be3f5539d75",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/671b81950b4e5047bcc48a3ffac56be3f5539d75/comments",
    "author": {
      "login": "zander",
      "id": 63063,
      "node_id": "MDQ6VXNlcjYzMDYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/63063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zander",
      "html_url": "https://github.com/zander",
      "followers_url": "https://api.github.com/users/zander/followers",
      "following_url": "https://api.github.com/users/zander/following{/other_user}",
      "gists_url": "https://api.github.com/users/zander/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zander/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zander/subscriptions",
      "organizations_url": "https://api.github.com/users/zander/orgs",
      "repos_url": "https://api.github.com/users/zander/repos",
      "events_url": "https://api.github.com/users/zander/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zander/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "zander",
      "id": 63063,
      "node_id": "MDQ6VXNlcjYzMDYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/63063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zander",
      "html_url": "https://github.com/zander",
      "followers_url": "https://api.github.com/users/zander/followers",
      "following_url": "https://api.github.com/users/zander/following{/other_user}",
      "gists_url": "https://api.github.com/users/zander/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zander/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zander/subscriptions",
      "organizations_url": "https://api.github.com/users/zander/orgs",
      "repos_url": "https://api.github.com/users/zander/repos",
      "events_url": "https://api.github.com/users/zander/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zander/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5fd95b4490a9eeb0575702c8137a5f2619f2e6c6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5fd95b4490a9eeb0575702c8137a5f2619f2e6c6",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5fd95b4490a9eeb0575702c8137a5f2619f2e6c6"
      }
    ],
    "stats": {
      "total": 26,
      "additions": 20,
      "deletions": 6
    },
    "files": [
      {
        "sha": "61020d040d8b26cde04e83b0b39b4c5172169d74",
        "filename": "src/alert.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 2,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/671b81950b4e5047bcc48a3ffac56be3f5539d75/src/alert.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/671b81950b4e5047bcc48a3ffac56be3f5539d75/src/alert.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/alert.cpp?ref=671b81950b4e5047bcc48a3ffac56be3f5539d75",
        "patch": "@@ -27,6 +27,8 @@ using namespace std;\n map<uint256, CAlert> mapAlerts;\n CCriticalSection cs_mapAlerts;\n \n+static void Notify(const std::string& strMessage, bool fThread);\n+\n void CUnsignedAlert::SetNull()\n {\n     nVersion = 1;\n@@ -245,8 +247,20 @@ bool CAlert::ProcessAlert(const std::vector<unsigned char>& alertKey, bool fThre\n     return true;\n }\n \n-void\n-CAlert::Notify(const std::string& strMessage, bool fThread)\n+// static\n+void CAlert::NotifyInternal(const std::string& strMessage)\n+{\n+    static CAlert internalAlert;\n+    internalAlert.vchMsg = std::vector<unsigned char>(strMessage.begin(), strMessage.end());\n+    uint256 zero;\n+    LOCK(cs_mapAlerts);\n+    mapAlerts[zero] = internalAlert;\n+    uiInterface.NotifyAlertChanged(zero, CT_NEW);\n+\n+    Notify(strMessage, true);\n+}\n+\n+static void Notify(const std::string& strMessage, bool fThread)\n {\n     std::string strCmd = GetArg(\"-alertnotify\", \"\");\n     if (strCmd.empty()) return;"
      },
      {
        "sha": "68ea0c24c7b0ff3179791aa30d75441c351ae51b",
        "filename": "src/alert.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/671b81950b4e5047bcc48a3ffac56be3f5539d75/src/alert.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/671b81950b4e5047bcc48a3ffac56be3f5539d75/src/alert.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/alert.h?ref=671b81950b4e5047bcc48a3ffac56be3f5539d75",
        "patch": "@@ -102,7 +102,7 @@ class CAlert : public CUnsignedAlert\n     bool RelayTo(CNode* pnode) const;\n     bool CheckSignature(const std::vector<unsigned char>& alertKey) const;\n     bool ProcessAlert(const std::vector<unsigned char>& alertKey, bool fThread = true); // fThread means run -alertnotify in a free-running thread\n-    static void Notify(const std::string& strMessage, bool fThread);\n+    static void NotifyInternal(const std::string& strMessage);\n \n     /*\n      * Get copy of (active) alert object by hash. Returns a null alert if it is not found."
      },
      {
        "sha": "c2c5c0f0ad8548cb0ba1ff57500e884a3b38bdd9",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/671b81950b4e5047bcc48a3ffac56be3f5539d75/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/671b81950b4e5047bcc48a3ffac56be3f5539d75/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=671b81950b4e5047bcc48a3ffac56be3f5539d75",
        "patch": "@@ -1411,7 +1411,7 @@ void CheckForkWarningConditions()\n         {\n             std::string warning = std::string(\"'Warning: Large-work fork detected, forking after block \") +\n                 pindexBestForkBase->phashBlock->ToString() + std::string(\"'\");\n-            CAlert::Notify(warning, true);\n+            CAlert::NotifyInternal(warning);\n         }\n         if (pindexBestForkTip && pindexBestForkBase)\n         {\n@@ -1942,7 +1942,7 @@ void PartitionCheck(bool (*initialDownloadCheck)(), CCriticalSection& cs, const\n     if (!strWarning.empty())\n     {\n         strMiscWarning = strWarning;\n-        CAlert::Notify(strWarning, true);\n+        CAlert::NotifyInternal(strWarning);\n         lastAlertTime = now;\n     }\n }\n@@ -2316,7 +2316,7 @@ void static UpdateTip(CBlockIndex *pindexNew) {\n         {\n             // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user:\n             strMiscWarning = _(\"Warning: This version is obsolete; upgrade required!\");\n-            CAlert::Notify(strMiscWarning, true);\n+            CAlert::NotifyInternal(strMiscWarning);\n             fWarned = true;\n         }\n     }"
      }
    ]
  },
  {
    "sha": "b36b0d573aaf4bfb94964d032d575abf2be105a6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMzZiMGQ1NzNhYWY0YmZiOTQ5NjRkMDMyZDU3NWFiZjJiZTEwNWE2",
    "commit": {
      "author": {
        "name": "Tom Zander",
        "email": "tomz@freedommail.ch",
        "date": "2016-02-03T15:38:57Z"
      },
      "committer": {
        "name": "Tom Zander",
        "email": "tomz@freedommail.ch",
        "date": "2016-02-04T16:04:29Z"
      },
      "message": "Scope it\n\nLOCK is a wrapper around boost::recursive_mutex, but it can't hurt\nto unlock before we pass it on.",
      "tree": {
        "sha": "6d09e88ea7041e8171006e5101bd43969fde0e19",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6d09e88ea7041e8171006e5101bd43969fde0e19"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b36b0d573aaf4bfb94964d032d575abf2be105a6",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b36b0d573aaf4bfb94964d032d575abf2be105a6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b36b0d573aaf4bfb94964d032d575abf2be105a6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b36b0d573aaf4bfb94964d032d575abf2be105a6/comments",
    "author": {
      "login": "zander",
      "id": 63063,
      "node_id": "MDQ6VXNlcjYzMDYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/63063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zander",
      "html_url": "https://github.com/zander",
      "followers_url": "https://api.github.com/users/zander/followers",
      "following_url": "https://api.github.com/users/zander/following{/other_user}",
      "gists_url": "https://api.github.com/users/zander/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zander/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zander/subscriptions",
      "organizations_url": "https://api.github.com/users/zander/orgs",
      "repos_url": "https://api.github.com/users/zander/repos",
      "events_url": "https://api.github.com/users/zander/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zander/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "zander",
      "id": 63063,
      "node_id": "MDQ6VXNlcjYzMDYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/63063?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zander",
      "html_url": "https://github.com/zander",
      "followers_url": "https://api.github.com/users/zander/followers",
      "following_url": "https://api.github.com/users/zander/following{/other_user}",
      "gists_url": "https://api.github.com/users/zander/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zander/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zander/subscriptions",
      "organizations_url": "https://api.github.com/users/zander/orgs",
      "repos_url": "https://api.github.com/users/zander/repos",
      "events_url": "https://api.github.com/users/zander/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zander/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "671b81950b4e5047bcc48a3ffac56be3f5539d75",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/671b81950b4e5047bcc48a3ffac56be3f5539d75",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/671b81950b4e5047bcc48a3ffac56be3f5539d75"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 4,
      "deletions": 2
    },
    "files": [
      {
        "sha": "00de8d21b37cdd2f0359543a2dcfaefc1c0b6adc",
        "filename": "src/alert.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 2,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b36b0d573aaf4bfb94964d032d575abf2be105a6/src/alert.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b36b0d573aaf4bfb94964d032d575abf2be105a6/src/alert.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/alert.cpp?ref=b36b0d573aaf4bfb94964d032d575abf2be105a6",
        "patch": "@@ -253,8 +253,10 @@ void CAlert::NotifyInternal(const std::string& strMessage)\n     static CAlert internalAlert;\n     internalAlert.vchMsg = std::vector<unsigned char>(strMessage.begin(), strMessage.end());\n     uint256 zero;\n-    LOCK(cs_mapAlerts);\n-    mapAlerts[zero] = internalAlert;\n+    {\n+        LOCK(cs_mapAlerts);\n+        mapAlerts[zero] = internalAlert;\n+    }\n     uiInterface.NotifyAlertChanged(zero, CT_NEW);\n \n     Notify(strMessage, true);"
      }
    ]
  }
]