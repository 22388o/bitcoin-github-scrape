BitcoinPullTester,2012-09-27T02:56:16Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/68e760d2656716cc9d538567c0735c77d8e5749e for binaries and test log.\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-8919945,8919945,
sipa,2012-09-28T14:07:46Z,"Surprising how little code changes are necessary for this. Ultraprune already has a CDiskBlockPos however, which is also used inside CTxBlockPos, so maybe you can use that instead? I think you can just copy it, and remove the IMPLEMENT_SERIALIZE.\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-8977378,8977378,
sipa,2012-10-01T22:05:53Z,"I also wonder about this: what if the current best chain happens to be known in the new/repained blockchain? There should be no need to rebuild the entire index in that case, only the block positions.\n\nEDIT: right, you can't, as in the current database structure, transactions also contain disk positions. It's something that can be done post-ultraprune though.\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9051844,9051844,
jgarzik,2012-10-03T19:41:09Z,Updated with the following changes:\n- uses CDiskBlockPos from sipa's ultraprune branch\n- calls our CDBEnv to perform database removal\n,https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9119322,9119322,
sipa,2012-10-07T13:50:07Z,Have you tested this?\n\n```\n$ ./bitcoind -reindex\nDB_ENV->dbremove: method not permitted before handle's open method\n```\n,https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9208147,9208147,
gavinandresen,2012-10-07T16:37:27Z,"I wrote up a 4-step test plan that I've been working through.\n\nI also have a branch (not published) to reconcile this with my corrupt wallet handling pull; @jgarzik see https://github.com/gavinandresen/bitcoin-git/commits/BDB_RECOVER\n\nThe testplan I was working through:\n1. Run new testnet3-in-a-box instance, let it IBD, shut it down.  Remove testnet3/database/ directory.\n   EXPECT: automatic",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9209689,9209689,
jgarzik,2012-10-09T05:02:47Z,"Doing the database remove in the environment definitely creates a super-large removal transactions, yet does not actually remove blkindex.dat.  blk0002.dat is growing here, which should not be the case.  Further debugging is needed.\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9249056,9249056,
gavinandresen,2012-10-09T15:20:18Z,"Instead of: `dbenv.dbremove(NULL, strFile.c_str(), ""main"", DB_AUTO_COMMIT);` you might try `dbenv.dbremove(NULL, strFile.c_str(), NULL, DB_AUTO_COMMIT);`\n... then re-create blkindex.dat using TxDb(""cr"")\n\nI think passing NULL as the third argument removes the file.\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9265164,9265164,
jgarzik,2012-10-10T03:45:44Z,"Fixed a few bugs, and rebased on top of @gavinandresen 's ::RemoveDb().  blkindex.dat is now properly removed, and reindex proceeds as expected.  Things appear to be working now.\n\nCaveat: a genesis block is newly stored to blkNNNN.dat, for each -reindex invocation.  LoadBlockIndex() adds a new one to the (it thinks) newly created block file.  All other blocks are properly read and processed in-p",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9289231,9289231,
sipa,2012-10-20T21:58:00Z,Needs rebase.\n,https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9637278,9637278,
BitcoinPullTester,2012-10-20T22:33:17Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/f49f2631856a4a233a957ce8361ffab3b08561cc for binaries and test log.\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9637578,9637578,
jgarzik,2012-10-21T22:28:56Z,"Superceded by #1943, closing\n",https://github.com/bitcoin/bitcoin/pull/1870#issuecomment-9648465,9648465,
sipa,2012-09-28T14:01:50Z,I really wouldn't delete bdb database files yourself. Use the dbenv methods to do so.\n,https://github.com/bitcoin/bitcoin/pull/1870#discussion_r1717534,1717534,src/main.cpp
gavinandresen,2012-10-01T21:21:49Z,"I agree with sipa, dbenv seemed to get very confused when I renamed database files behind its back for my corrupt wallet.dat handling code.\n",https://github.com/bitcoin/bitcoin/pull/1870#discussion_r1733161,1733161,src/main.cpp
