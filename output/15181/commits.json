[
  {
    "sha": "d87e40afd7f1e0b58f1420773ee6b198bbfdd01b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkODdlNDBhZmQ3ZjFlMGI1OGYxNDIwNzczZWU2YjE5OGJiZmRkMDFi",
    "commit": {
      "author": {
        "name": "Daniel Kraft",
        "email": "d@domob.eu",
        "date": "2019-01-16T17:05:41Z"
      },
      "committer": {
        "name": "Daniel Kraft",
        "email": "d@domob.eu",
        "date": "2019-01-18T07:01:27Z"
      },
      "message": "Use correct RPC port in help curl example.\n\nPut the correct RPC port (default for the selected chain or set explicitly\nwith -rpcport) into the RPC help text \"curl\" example.  Previously, the\nport there was always reported as 8332 (default mainnet port).  With this\nchange, it will be correct for testnet/regtest or with an explicit\n-rpcport, so that the example can be used as-is in these situations.",
      "tree": {
        "sha": "6f02542175b210f43be81517ac070f1d03c7a541",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6f02542175b210f43be81517ac070f1d03c7a541"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b/comments",
    "author": {
      "login": "domob1812",
      "id": 4943644,
      "node_id": "MDQ6VXNlcjQ5NDM2NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4943644?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/domob1812",
      "html_url": "https://github.com/domob1812",
      "followers_url": "https://api.github.com/users/domob1812/followers",
      "following_url": "https://api.github.com/users/domob1812/following{/other_user}",
      "gists_url": "https://api.github.com/users/domob1812/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/domob1812/subscriptions",
      "organizations_url": "https://api.github.com/users/domob1812/orgs",
      "repos_url": "https://api.github.com/users/domob1812/repos",
      "events_url": "https://api.github.com/users/domob1812/events{/privacy}",
      "received_events_url": "https://api.github.com/users/domob1812/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "domob1812",
      "id": 4943644,
      "node_id": "MDQ6VXNlcjQ5NDM2NDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4943644?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/domob1812",
      "html_url": "https://github.com/domob1812",
      "followers_url": "https://api.github.com/users/domob1812/followers",
      "following_url": "https://api.github.com/users/domob1812/following{/other_user}",
      "gists_url": "https://api.github.com/users/domob1812/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/domob1812/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/domob1812/subscriptions",
      "organizations_url": "https://api.github.com/users/domob1812/orgs",
      "repos_url": "https://api.github.com/users/domob1812/repos",
      "events_url": "https://api.github.com/users/domob1812/events{/privacy}",
      "received_events_url": "https://api.github.com/users/domob1812/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f71c2ea6620a262dd97ba01bdd3dfb3e619cb8cb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f71c2ea6620a262dd97ba01bdd3dfb3e619cb8cb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f71c2ea6620a262dd97ba01bdd3dfb3e619cb8cb"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 22,
      "deletions": 5
    },
    "files": [
      {
        "sha": "afd67f0d1dd5c5822683ce5a6c7dd8454bdae662",
        "filename": "src/rpc/server.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 3,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b/src/rpc/server.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b/src/rpc/server.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/server.cpp?ref=d87e40afd7f1e0b58f1420773ee6b198bbfdd01b",
        "patch": "@@ -1,10 +1,11 @@\n // Copyright (c) 2010 Satoshi Nakamoto\n-// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Copyright (c) 2009-2019 The Bitcoin Core developers\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <rpc/server.h>\n \n+#include <chainparamsbase.h>\n #include <fs.h>\n #include <key_io.h>\n #include <random.h>\n@@ -20,6 +21,7 @@\n #include <boost/algorithm/string/split.hpp>\n \n #include <memory> // for unique_ptr\n+#include <sstream>\n #include <unordered_map>\n \n static CCriticalSection cs_rpcWarmup;\n@@ -567,8 +569,17 @@ std::string HelpExampleCli(const std::string& methodname, const std::string& arg\n \n std::string HelpExampleRpc(const std::string& methodname, const std::string& args)\n {\n-    return \"> curl --user myusername --data-binary '{\\\"jsonrpc\\\": \\\"1.0\\\", \\\"id\\\":\\\"curltest\\\", \"\n-        \"\\\"method\\\": \\\"\" + methodname + \"\\\", \\\"params\\\": [\" + args + \"] }' -H 'content-type: text/plain;' http://127.0.0.1:8332/\\n\";\n+    const int rpcPort = gArgs.GetArg(\"-rpcport\", BaseParams().RPCPort());\n+\n+    std::ostringstream helpText;\n+    helpText << \"> curl --user myusername \"\n+             << \"--data-binary '{\\\"jsonrpc\\\": \\\"1.0\\\", \\\"id\\\":\\\"curltest\\\", \"\n+             << \"\\\"method\\\": \\\"\" << methodname << \"\\\", \"\n+             << \"\\\"params\\\": [\" << args << \"] }' \"\n+             << \"-H 'content-type: text/plain;' \"\n+             << \"http://127.0.0.1:\" << rpcPort << \"/\\n\";\n+\n+    return helpText.str();\n }\n \n void RPCSetTimerInterfaceIfUnset(RPCTimerInterface *iface)"
      },
      {
        "sha": "37d4829d30c15783225a1875a9af0ce154e5dbfe",
        "filename": "test/functional/rpc_help.py",
        "status": "modified",
        "additions": 8,
        "deletions": 2,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b/test/functional/rpc_help.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d87e40afd7f1e0b58f1420773ee6b198bbfdd01b/test/functional/rpc_help.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_help.py?ref=d87e40afd7f1e0b58f1420773ee6b198bbfdd01b",
        "patch": "@@ -1,13 +1,14 @@\n #!/usr/bin/env python3\n-# Copyright (c) 2018 The Bitcoin Core developers\n+# Copyright (c) 2018-2019 The Bitcoin Core developers\n # Distributed under the MIT software license, see the accompanying\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \"\"\"Test RPC help output.\"\"\"\n \n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal, assert_raises_rpc_error\n+from test_framework.util import assert_equal, assert_raises_rpc_error, rpc_port\n \n import os\n+import re\n \n \n class HelpRpcTest(BitcoinTestFramework):\n@@ -16,6 +17,7 @@ def set_test_params(self):\n \n     def run_test(self):\n         self.test_categories()\n+        self.test_rpc_port()\n         self.dump_help()\n \n     def test_categories(self):\n@@ -43,6 +45,10 @@ def test_categories(self):\n \n         assert_equal(titles, components)\n \n+    def test_rpc_port(self):\n+        help_text = self.nodes[0].help(\"getblockchaininfo\")\n+        assert re.search(\"curl.*http://127.0.0.1:%d\" % rpc_port(0), help_text) is not None\n+\n     def dump_help(self):\n         dump_dir = os.path.join(self.options.tmpdir, 'rpc_help_dump')\n         os.mkdir(dump_dir)"
      }
    ]
  }
]