[
  {
    "sha": "bd2e1405711f6ba81adadb6ea6206e916c29453b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZDJlMTQwNTcxMWY2YmE4MWFkYWRiNmVhNjIwNmU5MTZjMjk0NTNi",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-10-08T17:41:57Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@redhat.com",
        "date": "2012-10-08T17:41:57Z"
      },
      "message": "CAddrMan: verify pchMessageStart file marker, before reading address data\n\nThis avoids the case where you read the address data, before noticing it is\nthe wrong network.",
      "tree": {
        "sha": "08cbaac27f3f383c8a0fbd01988df12cd5df6355",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/08cbaac27f3f383c8a0fbd01988df12cd5df6355"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bd2e1405711f6ba81adadb6ea6206e916c29453b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd2e1405711f6ba81adadb6ea6206e916c29453b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bd2e1405711f6ba81adadb6ea6206e916c29453b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd2e1405711f6ba81adadb6ea6206e916c29453b/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "a6be58d536c46d2ee2328ed827cb26d35656fbee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a6be58d536c46d2ee2328ed827cb26d35656fbee",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a6be58d536c46d2ee2328ed827cb26d35656fbee"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 7,
      "deletions": 5
    },
    "files": [
      {
        "sha": "278c82078a13f89dba8dcc8428dd221499ec9d33",
        "filename": "src/db.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 5,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bd2e1405711f6ba81adadb6ea6206e916c29453b/src/db.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bd2e1405711f6ba81adadb6ea6206e916c29453b/src/db.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/db.cpp?ref=bd2e1405711f6ba81adadb6ea6206e916c29453b",
        "patch": "@@ -842,20 +842,22 @@ bool CAddrDB::Read(CAddrMan& addr)\n     if (hashIn != hashTmp)\n         return error(\"CAddrman::Read() : checksum mismatch; data corrupted\");\n \n-    // de-serialize address data\n     unsigned char pchMsgTmp[4];\n     try {\n+        // de-serialize file header (pchMessageStart magic number) and\n         ssPeers >> FLATDATA(pchMsgTmp);\n+\n+        // verify the network matches ours\n+        if (memcmp(pchMsgTmp, pchMessageStart, sizeof(pchMsgTmp)))\n+            return error(\"CAddrman::Read() : invalid network magic number\");\n+\n+        // de-serialize address data into one CAddrMan object\n         ssPeers >> addr;\n     }\n     catch (std::exception &e) {\n         return error(\"CAddrman::Read() : I/O error or stream data corrupted\");\n     }\n \n-    // finally, verify the network matches ours\n-    if (memcmp(pchMsgTmp, pchMessageStart, sizeof(pchMsgTmp)))\n-        return error(\"CAddrman::Read() : invalid network magic number\");\n-\n     return true;\n }\n "
      }
    ]
  }
]