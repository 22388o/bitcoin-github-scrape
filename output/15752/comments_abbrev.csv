Empact,2019-04-05T09:17:22Z,"NACK this is not redundant, e.g.\n\nhttps://github.com/bitcoin/bitcoin/blob/c83442e17412b96f00bc29d30763b28184c95f1e/src/wallet/test/coinselector_tests.cpp#L507-L517",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480207067,480207067,
madeken,2019-04-05T15:51:47Z,"@Empact the comment is wrong...\n\nThe reason it sometimes fails and sometimes succeeds is because of the randomization here:\nhttps://github.com/bitcoin/bitcoin/blob/e21129e78e38935eb3310207c5be7cf2b1f422e7/src/wallet/coinselection.cpp#L195\n\nbut note at that stage it's iterating over a _sorted_ list:\n\nhttps://github.com/bitcoin/bitcoin/blob/e21129e78e38935eb3310207c5be7cf2b1f422e7/src/",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480326953,480326953,
MarcoFalke,2019-04-05T15:58:38Z,"The tests are failing, so they need to be updated in the same commit",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480329346,480329346,
gmaxwell,2019-04-05T16:07:58Z,What happens if there are ties in the sort or multiple smallest elements >= N?,https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480332433,480332433,
madeken,2019-04-05T16:52:02Z,"@gmaxwell I doubt it matters, but fair enough point. That's easy enough to fix with:  856b0a7bd015551d166cb8001ac45460e659b28d  to just unconditionally shuffle  before all the calls to `SelectCoinsMinConf`",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480346341,480346341,
madeken,2019-04-05T17:55:13Z,"Rebased, updated original post (description) and removed the test of randomness in `SelectCoinsMinConf` as it's no longer applicable and `SelectCoins` doesn't make it easy to do the same test.",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480366800,480366800,
Empact,2019-04-05T20:08:58Z,"That looks better to me, but if deterministic output is significant to privacy, I'd rather have less efficient operation covered by a test than more efficient operation without one, particularly wrt coin selection.",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480406401,480406401,
madeken,2019-04-05T21:07:10Z,"@Empact even without the shuffle (which it has), the privacy implications are tiny. It only makes a difference in an extreme edge case:  if BnB fails (does its own sorting), and if the sum of < N  is  <N fails (has its own randomization) and if the smallest >= N input has ties.\n\nAnd even then, the privacy difference between ""This is the smallest >= N input (first tie-breaking)"" and ""This is a ",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480422368,480422368,
gmaxwell,2019-04-05T21:36:43Z,"Why bother with the change however?  I'm not really seeing the motivation for it, saving say 0.5ms in a 500ms operation isn't particularly interesting.  Actually figuring out if the privacy difference is material isn't free....",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-480429991,480429991,
laanwj,2019-04-10T10:44:33Z,"Agree with @gmaxwell here.\n\nI'd like to see significant performance numbers before considering this change. I'd suspect an extra shuffle is almost free, and the human work of reviewing this is considerable and likely better spent on other PRs.",https://github.com/bitcoin/bitcoin/pull/15752#issuecomment-481639465,481639465,
