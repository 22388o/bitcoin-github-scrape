DrahtBot,2020-04-15 03:00:01,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18638 (net: Use mockable time for ping/pong, add tests by MarcoFalke)\n\nIf you consider this pull request important, ple",https://github.com/bitcoin/bitcoin/pull/18644#issuecomment-613787316,613787316,
jonasschnelli,2020-04-15 08:06:20,"Thanks @dongcarl.\n\nI'm NACKish on this. Once we have the handshake implemented, the `CNode` instances should be capable to individually read and process messages.\n\nI'd suggest to keep the per-message-process-logic in the `CNode` instance to allow switching the deserializer between individual messages.\n\nLet me make an example:\n* Peer A sends BIP324 handshake to peer B (very first mess",https://github.com/bitcoin/bitcoin/pull/18644#issuecomment-613885385,613885385,
dongcarl,2020-04-15 16:43:42,"@jonasschnelli \n\n> Let me make an example:\n>   * Peer A sends BIP324 handshake to peer B (very first message, 32bytes)\n>   * Peer A sends encrypted `version` message after BIP324 **in the same buffer**\n>   * Peer B processes the buffer, needs to switch to encrypted traffic **(switch the `deserializer`)** between the two messages in the same buffer.\n> \n> Have a look at the following d",https://github.com/bitcoin/bitcoin/pull/18644#issuecomment-614150557,614150557,
jonasschnelli,2020-04-15 18:09:34,"> That's a good point! I think I have a way to do this cleanly, but I'm going to shut my mouth until I have the code for it...\n\nGreat! Let's see with what you come up.\n\n> Is the right way to rebase your master...jonasschnelli:2019/08/net_v2 branch to: rebase #14049 over #18242 then cherry-picking the last 3 commits from master...jonasschnelli:2019/08/net_v2?\n\nThe `jonasschnelli:2019/08",https://github.com/bitcoin/bitcoin/pull/18644#issuecomment-614195072,614195072,
dongcarl,2020-05-26 18:12:46,"Closing, will reopen or open a new PR once I have something!",https://github.com/bitcoin/bitcoin/pull/18644#issuecomment-634190545,634190545,
MarcoFalke,2020-04-15 01:52:36,Don't we use Optional<> for this?,https://github.com/bitcoin/bitcoin/pull/18644#discussion_r408534636,408534636,src/net.h
dongcarl,2020-04-15 02:02:00,See the `@note`,https://github.com/bitcoin/bitcoin/pull/18644#discussion_r408537361,408537361,src/net.h
sipa,2020-04-15 06:51:08,"This will copy the vector. Two options:\n\n* Add an `std::move()` around the `std::get` here\n* Change the declaration to `std::vector<CNetMessage>& msgs` (or `auto& msgs`).",https://github.com/bitcoin/bitcoin/pull/18644#discussion_r408617531,408617531,src/net.cpp
sipa,2020-04-15 06:52:11,Any reason to use an `std::tuple` with just two members here (instead of an `std::pair`)?,https://github.com/bitcoin/bitcoin/pull/18644#discussion_r408617955,408617955,src/net.h
sipa,2020-04-15 06:53:01,Add an `std::move` around `out_msgs` here to avoid a copy.,https://github.com/bitcoin/bitcoin/pull/18644#discussion_r408618382,408618382,src/net.h
sipa,2020-04-15 06:53:18,Same here.,https://github.com/bitcoin/bitcoin/pull/18644#discussion_r408618510,408618510,src/net.h
