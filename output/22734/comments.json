[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900923279",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-900923279",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 900923279,
    "node_id": "IC_kwDOABII5841sv-P",
    "user": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following{/other_user}",
      "gists_url": "https://api.github.com/users/mzumsande/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T08:27:26Z",
    "updated_at": "2021-08-18T08:27:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "I agree that corrupt data shouldn't assert.\r\n\r\n`Check()` used to be restricted to tests / use of the `checkaddrman` option, it was never run per default. This PR makes it run always for `Unserialize()`, so it introduces stricter rules for the level of inconsistencies we tolerate from peers.dat. \r\nI think this change of default behavior should be mentioned in the OP and maybe somewhere in the code, because it also introduces new possibilities of p2p addrman poisoning to make us drop our peers.dat - so we should be confident all checks in `Check()` are correct before enabling this.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900923279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900925089",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-900925089",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 900925089,
    "node_id": "IC_kwDOABII5841swah",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T08:30:03Z",
    "updated_at": "2021-08-18T08:30:03Z",
    "author_association": "MEMBER",
    "body": "Thanks, renamed PR title",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900925089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900932484",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-900932484",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 900932484,
    "node_id": "IC_kwDOABII5841syOE",
    "user": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following{/other_user}",
      "gists_url": "https://api.github.com/users/mzumsande/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T08:41:22Z",
    "updated_at": "2021-08-18T08:41:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks! I think there is a bug in the `addman_serdeser` fuzz test (see CI fail) that would need fixing, see https://github.com/mzumsande/bitcoin/commit/f4840614c0b945460a833ba8e9d0da2df3ce80c3",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900932484/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900959795",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-900959795",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 900959795,
    "node_id": "IC_kwDOABII5841s44z",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T09:22:20Z",
    "updated_at": "2021-08-18T09:22:20Z",
    "author_association": "MEMBER",
    "body": "With this change, if we have a bug that causes us to write a peers.dat file that's corrupt in any way, then it would mostly be undetected - the addrman would be cleared and startup would continue as normal. As @mzumsande points out, if it's possible to trigger such a bug over p2p, then an adversary could cause victims to lose their entire addrman on restart.\r\n\r\nIt might be safer to do the `ForceCheck`, but then catch the exception, rename peers.dat to peers.bak, and terminate with some error message like \"Corrupt peers.dat file found. addrman database has been wiped and peers.dat has been renamed to peers.bak. Please report this to the Bitcoin Core developers.\" That way, we'd get bug reports if there was a bug in our serialization code, and there may be a way to salvage the peers.bak file if needed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900959795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902874897",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-902874897",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 902874897,
    "node_id": "IC_kwDOABII58410McR",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-20T18:22:23Z",
    "updated_at": "2021-08-20T18:22:23Z",
    "author_association": "MEMBER",
    "body": ">With this change, if we have a bug that causes us to write a peers.dat file that's corrupt in any way, then it would mostly be undetected - the addrman would be cleared and startup would continue as normal. As @mzumsande points out, if it's possible to trigger such a bug over p2p, then an adversary could cause victims to lose their entire addrman on restart.\r\n\r\n> It might be safer to do the ForceCheck, but then catch the exception, rename peers.dat to peers.bak, and terminate with some error message like \"Corrupt peers.dat file found. addrman database has been wiped and peers.dat has been renamed to peers.bak. Please report this to the Bitcoin Core developers.\" That way, we'd get bug reports if there was a bug in our serialization code, and there may be a way to salvage the peers.bak file if needed.\r\n\r\nI agree with John.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902874897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903039535",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-903039535",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 903039535,
    "node_id": "IC_kwDOABII584100ov",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-21T02:22:30Z",
    "updated_at": "2021-09-17T04:27:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22974](https://github.com/bitcoin/bitcoin/pull/22974) (addrman: Improve performance of Good by mzumsande)\n* [#22950](https://github.com/bitcoin/bitcoin/pull/22950) ([p2p] Pimpl AddrMan to abstract implementation details by amitiuttarwar)\n* [#22910](https://github.com/bitcoin/bitcoin/pull/22910) ([RFC] Encapsulate asmap in NetGroupManager by jnewbery)\n* [#22872](https://github.com/bitcoin/bitcoin/pull/22872) (log: improve checkaddrman logging with duration in milliseconds by jonatack)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903039535/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903111513",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-903111513",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 903111513,
    "node_id": "IC_kwDOABII58411GNZ",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-21T12:45:28Z",
    "updated_at": "2021-08-21T12:45:28Z",
    "author_association": "MEMBER",
    "body": "I agree with @vasild that this is an unrelated bug that already exists. I've created a separate pull to fix that: #22762",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903111513/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919833506",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-919833506",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 919833506,
    "node_id": "IC_kwDOABII584204ui",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T09:00:09Z",
    "updated_at": "2021-09-15T09:00:09Z",
    "author_association": "MEMBER",
    "body": "> (the fuzzer is upset, probably needs some petting)\r\n\r\nThanks. Force pushed to pet the fuzzer and fixup the docs. (no other code changes)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919833506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919886043",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-919886043",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 919886043,
    "node_id": "IC_kwDOABII58421Fjb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T10:11:34Z",
    "updated_at": "2021-09-15T10:11:34Z",
    "author_association": "MEMBER",
    "body": "@mzumsande @naumenkogs @jnewbery Now that #22762 is merged, I rebased this pull. This should address your concerns.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919886043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919960395",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-919960395",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 919960395,
    "node_id": "IC_kwDOABII58421XtL",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T12:06:52Z",
    "updated_at": "2021-09-15T12:06:52Z",
    "author_association": "MEMBER",
    "body": "ACK fa6f5c9ea4dad2e15065001fef9ae6a9325c632b",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919960395/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/923859769",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-923859769",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 923859769,
    "node_id": "IC_kwDOABII5843EPs5",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T10:45:03Z",
    "updated_at": "2021-09-21T10:45:03Z",
    "author_association": "MEMBER",
    "body": "Rebased; Only trivial conflicts in the tests.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/923859769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/923869883",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-923869883",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 923869883,
    "node_id": "IC_kwDOABII5843ESK7",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T10:59:19Z",
    "updated_at": "2021-09-21T10:59:19Z",
    "author_association": "MEMBER",
    "body": "ACK fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/923869883/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924118039",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#issuecomment-924118039",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22734",
    "id": 924118039,
    "node_id": "IC_kwDOABII5843FOwX",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T15:48:03Z",
    "updated_at": "2021-09-21T15:48:03Z",
    "author_association": "MEMBER",
    "body": "Code review ACK fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924118039/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691065092",
    "pull_request_review_id": 732638490,
    "id": 691065092,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA2NTA5Mg==",
    "diff_hunk": "@@ -468,7 +468,12 @@ class CAddrMan\n             LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n         }\n \n-        Check();\n+        const int check_code{ForcedCheck()};\n+        if (check_code != 0) {\n+            throw std::ios_base::failure(strprintf(\n+                \"Corrupt data. Consistency check failed with code %s.\",\n+                check_code));",
    "path": "src/addrman.h",
    "position": null,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "fab42d7dab8ad674e9e37baca9af625bf2c465bb",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: maybe mention \"addrman\" somewhere in this message. The following looks too generic:\r\n```\r\n2021-08-18T07:12:57Z ERROR: DeserializeDB: Deserialize or I/O error - Corrupt data. Consistency check failed with code -16.: iostream error\r\n```\r\n\r\nnit: remove the dot after %s: `with code -16.: iostream error`",
    "created_at": "2021-08-18T09:27:32Z",
    "updated_at": "2021-08-18T09:37:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r691065092",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691065092"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r691065092"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691065092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 473,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 475,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706102358",
    "pull_request_review_id": 751307582,
    "id": 706102358,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjEwMjM1OA==",
    "diff_hunk": "@@ -468,7 +468,12 @@ class CAddrMan\n             LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n         }\n \n-        Check();\n+        const int check_code{ForcedCheck()};\n+        if (check_code != 0) {\n+            throw std::ios_base::failure(strprintf(\n+                \"Corrupt data. Consistency check failed with code %s.\",\n+                check_code));",
    "path": "src/addrman.h",
    "position": null,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "fab42d7dab8ad674e9e37baca9af625bf2c465bb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The new failure mentions the file name `peers.dat`. Is this enough?\r\n\r\n```\r\nError: Invalid or corrupt peers.dat (Corrupt data. Consistency check failed with code -16.: iostream error). If you believe this is a bug, please report it to https://github.com/bitcoin/bitcoin/issues. As a workaround, you can move the file (\"/tmp/bitcoin_func_test_ybw3djdd/node0/regtest/peers.dat\") out of the way (rename, move, or delete) to have a new one created on the next start.",
    "created_at": "2021-09-10T11:21:20Z",
    "updated_at": "2021-09-10T11:21:20Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r706102358",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706102358"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r706102358"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706102358/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 473,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 475,
    "side": "RIGHT",
    "in_reply_to_id": 691065092
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706104247",
    "pull_request_review_id": 751310137,
    "id": 706104247,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjEwNDI0Nw==",
    "diff_hunk": "@@ -468,7 +468,12 @@ class CAddrMan\n             LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n         }\n \n-        Check();\n+        const int check_code{ForcedCheck()};\n+        if (check_code != 0) {\n+            throw std::ios_base::failure(strprintf(\n+                \"Corrupt data. Consistency check failed with code %s.\",\n+                check_code));",
    "path": "src/addrman.h",
    "position": null,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "fab42d7dab8ad674e9e37baca9af625bf2c465bb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, removed dot.",
    "created_at": "2021-09-10T11:25:07Z",
    "updated_at": "2021-09-10T11:25:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r706104247",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706104247"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r706104247"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706104247/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 473,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 475,
    "side": "RIGHT",
    "in_reply_to_id": 691065092
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706110567",
    "pull_request_review_id": 751318193,
    "id": 706110567,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwNjExMDU2Nw==",
    "diff_hunk": "@@ -468,7 +468,12 @@ class CAddrMan\n             LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n         }\n \n-        Check();\n+        const int check_code{ForcedCheck()};\n+        if (check_code != 0) {\n+            throw std::ios_base::failure(strprintf(\n+                \"Corrupt data. Consistency check failed with code %s.\",\n+                check_code));",
    "path": "src/addrman.h",
    "position": null,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "fab42d7dab8ad674e9e37baca9af625bf2c465bb",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`peers.dat` looks even better than `addrman`.",
    "created_at": "2021-09-10T11:37:07Z",
    "updated_at": "2021-09-10T11:37:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r706110567",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706110567"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r706110567"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/706110567/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 473,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 475,
    "side": "RIGHT",
    "in_reply_to_id": 691065092
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708938715",
    "pull_request_review_id": 754790951,
    "id": 708938715,
    "node_id": "PRRC_kwDOABII584qQYvb",
    "diff_hunk": "@@ -385,7 +385,12 @@ void CAddrMan::Unserialize(Stream& s_)\n         LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n     }\n \n-    Check();\n+    const int check_code{ForceCheckAddrman()};\n+    if (check_code != 0) {\n+        throw std::ios_base::failure(strprintf(\n+            \"Corrupt data. Consistency check failed with code %s\",\n+            check_code));",
    "path": "src/addrman.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "4fd53056672c227d37bccff0d0d260febf590f8f",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It would be nice if this mentions \"addrman\" or \"peers.dat\". Without it the error message looks too generic, it is unclear where the problem is and the user may freak out that the \"corrupt data\" applies to the wallet:\r\n\r\n> terminate called after throwing an instance of 'std::ios_base::failure[abi:cxx11]'\r\n  what():  Corrupt data. Consistency check failed with code -1: iostream error",
    "created_at": "2021-09-15T08:01:30Z",
    "updated_at": "2021-09-15T08:05:20Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708938715",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708938715"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708938715"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708938715/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 391,
    "original_start_line": 390,
    "start_side": "RIGHT",
    "line": 393,
    "original_line": 393,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708962099",
    "pull_request_review_id": 754821765,
    "id": 708962099,
    "node_id": "PRRC_kwDOABII584qQecz",
    "diff_hunk": "@@ -385,7 +385,12 @@ void CAddrMan::Unserialize(Stream& s_)\n         LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n     }\n \n-    Check();\n+    const int check_code{ForceCheckAddrman()};\n+    if (check_code != 0) {\n+        throw std::ios_base::failure(strprintf(\n+            \"Corrupt data. Consistency check failed with code %s\",\n+            check_code));",
    "path": "src/addrman.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "4fd53056672c227d37bccff0d0d260febf590f8f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can you explain what code path didn't catch the exception? Raw exceptions shouldn't be displayed to the user at all. See also https://github.com/bitcoin/bitcoin/pull/22734#issue-714811417 on steps to test this pull request.\r\n\r\n(Or see the attached test to reproduce)",
    "created_at": "2021-09-15T08:30:55Z",
    "updated_at": "2021-09-15T08:31:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708962099",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708962099"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708962099"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708962099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 391,
    "original_start_line": 390,
    "start_side": "RIGHT",
    "line": 393,
    "original_line": 393,
    "side": "RIGHT",
    "in_reply_to_id": 708938715
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708987746",
    "pull_request_review_id": 754855017,
    "id": 708987746,
    "node_id": "PRRC_kwDOABII584qQkti",
    "diff_hunk": "@@ -385,7 +385,12 @@ void CAddrMan::Unserialize(Stream& s_)\n         LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n     }\n \n-    Check();\n+    const int check_code{ForceCheckAddrman()};\n+    if (check_code != 0) {\n+        throw std::ios_base::failure(strprintf(\n+            \"Corrupt data. Consistency check failed with code %s\",\n+            check_code));",
    "path": "src/addrman.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "4fd53056672c227d37bccff0d0d260febf590f8f",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Uff, sorry, I remember this was discussed before. I was misled somehow by the fuzzer output (quoted above).",
    "created_at": "2021-09-15T09:01:44Z",
    "updated_at": "2021-09-15T09:01:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708987746",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708987746"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708987746"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708987746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 391,
    "original_start_line": 390,
    "start_side": "RIGHT",
    "line": 393,
    "original_line": 393,
    "side": "RIGHT",
    "in_reply_to_id": 708938715
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708988496",
    "pull_request_review_id": 754855948,
    "id": 708988496,
    "node_id": "PRRC_kwDOABII584qQk5Q",
    "diff_hunk": "@@ -385,7 +385,12 @@ void CAddrMan::Unserialize(Stream& s_)\n         LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions or invalid addresses\\n\", nLostUnk, nLost);\n     }\n \n-    Check();\n+    const int check_code{ForceCheckAddrman()};\n+    if (check_code != 0) {\n+        throw std::ios_base::failure(strprintf(\n+            \"Corrupt data. Consistency check failed with code %s\",\n+            check_code));",
    "path": "src/addrman.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "fa3669f72f69662049b55ad1a482b4a0f9f7ae40",
    "original_commit_id": "4fd53056672c227d37bccff0d0d260febf590f8f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No worries. Resolving for now.",
    "created_at": "2021-09-15T09:02:38Z",
    "updated_at": "2021-09-15T09:02:38Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708988496",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708988496"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22734#discussion_r708988496"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22734"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/708988496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 391,
    "original_start_line": 390,
    "start_side": "RIGHT",
    "line": 393,
    "original_line": 393,
    "side": "RIGHT",
    "in_reply_to_id": 708938715
  }
]